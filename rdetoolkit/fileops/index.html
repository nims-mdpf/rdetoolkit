
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../../img/2585322.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.5.38" name="generator"/>
<title>File Operations Module - RDEToolKit Documentation</title>
<link href="../../assets/stylesheets/main.8c3ca2c6.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Noto+Sans+JP:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Noto Sans JP";--md-code-font:"Roboto Mono"}</style>
<link href="../../assets/_mkdocstrings.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#file-operations-module">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="RDEToolKit Documentation" class="md-header__button md-logo" data-md-component="logo" href="../.." title="RDEToolKit Documentation">
<img alt="logo" src="../../img/2585322.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            RDEToolKit Documentation
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              File Operations Module
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="" data-md-color-primary="indigo" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/nims-dpfc/rdetoolkit" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    nims-dpfc/rdetoolkit
  </div>
</a>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
          
  
  Getting started

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../install/">
          
  
  Installation

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../usage/quickstart/">
          
  
  User Guide

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../">
          
  
  API Documentation

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../contribute/home/">
          
  
  Development

        </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="RDEToolKit Documentation" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="RDEToolKit Documentation">
<img alt="logo" src="../../img/2585322.png"/>
</a>
    RDEToolKit Documentation
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/nims-dpfc/rdetoolkit" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    nims-dpfc/rdetoolkit
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
<span class="md-ellipsis">
    Getting started
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    RDEToolKit
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    Installation
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Installation
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../install/">
<span class="md-ellipsis">
    インストール方法
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    User Guide
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
<span class="md-ellipsis">
    Quick Start
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_1">
<span class="md-nav__icon md-icon"></span>
            Quick Start
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/quickstart/">
<span class="md-ellipsis">
    クイックスタート
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
<span class="md-ellipsis">
    構造化処理
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_2">
<span class="md-nav__icon md-icon"></span>
            構造化処理
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/structured_process/structured/">
<span class="md-ellipsis">
    構造化処理を構築する
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/structured_process/directory/">
<span class="md-ellipsis">
    サポートするディレクトリ
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/structured_process/rdepath/">
<span class="md-ellipsis">
    構造化ディレクトリパスの取得
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/structured_process/errorhandling/">
<span class="md-ellipsis">
    構造化処理のエラーハンドリング
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/structured_process/feature_description/">
<span class="md-ellipsis">
    データタイル説明欄への自動記述について
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
<span class="md-ellipsis">
    コマンドライン機能
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_3">
<span class="md-nav__icon md-icon"></span>
            コマンドライン機能
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/cli/">
<span class="md-ellipsis">
    コマンドライン機能について
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
<span class="md-ellipsis">
    設定ファイル
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_4">
<span class="md-nav__icon md-icon"></span>
            設定ファイル
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/config/config/">
<span class="md-ellipsis">
    RDEToolKit設定ファイル
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/config/mode/">
<span class="md-ellipsis">
    RDEToolKitのデータ登録モード
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/config/file_folder_mode/">
<span class="md-ellipsis">
    圧縮ファイルの形式について
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/config/magic_variable/">
<span class="md-ellipsis">
    Magic Variableによるデータ登録について
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
<span class="md-ellipsis">
    テンプレートファイル
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_5">
<span class="md-nav__icon md-icon"></span>
            テンプレートファイル
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/metadata_definition_file/">
<span class="md-ellipsis">
    テンプレートファイル
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
<span class="md-ellipsis">
    バリデーション
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_6">
<span class="md-nav__icon md-icon"></span>
            バリデーション
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/validation/">
<span class="md-ellipsis">
    バリデーション機能
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
<span class="md-ellipsis">
    オブジェクトストレージを使用する
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_7_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_7">
<span class="md-nav__icon md-icon"></span>
            オブジェクトストレージを使用する
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/object_storage/">
<span class="md-ellipsis">
    rdetolkitでオブジェクトストレージ(MinIO)を利用する方法
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_8" id="__nav_3_8_label" tabindex="0">
<span class="md-ellipsis">
    Docker
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_8_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_8">
<span class="md-nav__icon md-icon"></span>
            Docker
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/docker/">
<span class="md-ellipsis">
    Using RDEToolKit with Docker
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    API Documentation
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            API Documentation
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../">
<span class="md-ellipsis">
    RDE Toolkit API Documentation
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
<span class="md-ellipsis">
    impl
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_2">
<span class="md-nav__icon md-icon"></span>
            impl
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../impl/compressed_controller/">
<span class="md-ellipsis">
    Compressed Controller Module
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../impl/input_controller/">
<span class="md-ellipsis">
    Input Controller Module
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
<span class="md-ellipsis">
    interface
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_3">
<span class="md-nav__icon md-icon"></span>
            interface
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../interface/filechecker/">
<span class="md-ellipsis">
    File Checker Interfaces Module
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
<span class="md-ellipsis">
    models
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_4">
<span class="md-nav__icon md-icon"></span>
            models
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../models/invoice_schema/">
<span class="md-ellipsis">
    Invoice Schema Module
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../models/metadata/">
<span class="md-ellipsis">
    Metadata Module
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../models/rde2types/">
<span class="md-ellipsis">
    RDE2 Types Module
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
<span class="md-ellipsis">
    storage
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_5">
<span class="md-nav__icon md-icon"></span>
            storage
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../storage/minio/">
<span class="md-ellipsis">
    MinIO Storage
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
<span class="md-ellipsis">
    core module
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_6">
<span class="md-nav__icon md-icon"></span>
            core module
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../core/">
<span class="md-ellipsis">
    Core Module
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../config/">
<span class="md-ellipsis">
    Configuration Module
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../workflows/">
<span class="md-ellipsis">
    Workflows Module
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../rde2util/">
<span class="md-ellipsis">
    rde2util Module
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../invoicefile/">
<span class="md-ellipsis">
    Invoice File Module
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../modeproc/">
<span class="md-ellipsis">
    Mode Processing Module
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../validation/">
<span class="md-ellipsis">
    Validation Module
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../img2thumb/">
<span class="md-ellipsis">
    Image to Thumbnail Module
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../rdelogger/">
<span class="md-ellipsis">
    RDE Logger Module
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../exceptions/">
<span class="md-ellipsis">
    Exceptions Module
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    Development
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            Development
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../contribute/home/">
<span class="md-ellipsis">
    Top
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../contribute/documents_contributing/">
<span class="md-ellipsis">
    Documents
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../contribute/sourcecode_contributing/">
<span class="md-ellipsis">
    Source Code
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#overview">
<span class="md-ellipsis">
      Overview
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#functions">
<span class="md-ellipsis">
      Functions
    </span>
</a>
<nav aria-label="Functions" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#readf_json">
<span class="md-ellipsis">
      readf_json
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#writef_json">
<span class="md-ellipsis">
      writef_json
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#complete-usage-examples">
<span class="md-ellipsis">
      Complete Usage Examples
    </span>
</a>
<nav aria-label="Complete Usage Examples" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#json-configuration-manager">
<span class="md-ellipsis">
      JSON Configuration Manager
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#advanced-json-processing-pipeline">
<span class="md-ellipsis">
      Advanced JSON Processing Pipeline
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#error-handling">
<span class="md-ellipsis">
      Error Handling
    </span>
</a>
<nav aria-label="Error Handling" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#exception-types">
<span class="md-ellipsis">
      Exception Types
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#common-error-scenarios">
<span class="md-ellipsis">
      Common Error Scenarios
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#best-practices-for-error-handling">
<span class="md-ellipsis">
      Best Practices for Error Handling
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#performance-notes">
<span class="md-ellipsis">
      Performance Notes
    </span>
</a>
<nav aria-label="Performance Notes" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#optimization-features">
<span class="md-ellipsis">
      Optimization Features
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#performance-best-practices">
<span class="md-ellipsis">
      Performance Best Practices
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#integration-examples">
<span class="md-ellipsis">
      Integration Examples
    </span>
</a>
<nav aria-label="Integration Examples" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#integration-with-other-rde-modules">
<span class="md-ellipsis">
      Integration with Other RDE Modules
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#see-also">
<span class="md-ellipsis">
      See Also
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="file-operations-module">File Operations Module</h1>
<p>The <code>rdetoolkit.fileops</code> module provides essential file operation utilities for RDE (Research Data Exchange) processing workflows. This module focuses on robust JSON file handling with automatic encoding detection and comprehensive error management.</p>
<h2 id="overview">Overview</h2>
<p>The fileops module offers reliable file operations with built-in safety features:</p>
<ul>
<li><strong>Automatic Encoding Detection</strong>: Intelligent detection of file encodings for robust reading</li>
<li><strong>Error Handling</strong>: Comprehensive error management with structured exceptions</li>
<li><strong>JSON Processing</strong>: Specialized functions for JSON file reading and writing</li>
<li><strong>Encoding Normalization</strong>: Consistent encoding handling across different platforms</li>
<li><strong>Logging Integration</strong>: Built-in logging for debugging and monitoring</li>
<li><strong>Path Flexibility</strong>: Support for both string and Path object inputs</li>
</ul>
<h2 id="functions">Functions</h2>
<h3 id="readf_json">readf_json</h3>
<p>Read a JSON file and return the parsed JSON object with automatic encoding detection.</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">readf_json</span>(path: <span style="color: #007020">str</span> <span style="color: #333333">|</span> Path) <span style="color: #333333">-&gt;</span> <span style="color: #007020">dict</span>[<span style="color: #007020">str</span>, Any]
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>path</code> (str | Path): Path to the JSON file to read</p>
<p><strong>Returns:</strong>
- <code>dict[str, Any]</code>: The parsed JSON object as a dictionary</p>
<p><strong>Raises:</strong>
- <code>StructuredError</code>: If an error occurs while processing the file (file not found, invalid JSON, encoding issues, etc.)</p>
<p><strong>Features:</strong>
- Automatic encoding detection using the core module's <code>detect_encoding</code> function
- Encoding normalization for cross-platform compatibility
- Comprehensive error handling with detailed error messages
- Logging integration for debugging and monitoring
- Support for both string paths and Path objects</p>
<p><strong>Example:</strong></p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">14</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">15</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">16</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">17</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">18</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">19</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">20</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">21</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">22</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">23</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">24</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">25</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">26</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">27</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">28</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">29</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">30</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">31</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">32</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">33</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">34</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">35</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">36</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">37</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">38</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">39</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">40</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">41</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">42</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">43</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">44</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">45</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">46</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">47</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">48</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">49</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">50</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">51</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">52</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">53</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">54</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">55</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">56</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">57</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">58</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">59</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">60</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">61</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">62</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">rdetoolkit.fileops</span> <span style="color: #008800; font-weight: bold">import</span> readf_json
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">pathlib</span> <span style="color: #008800; font-weight: bold">import</span> Path
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">json</span>

<span style="color: #888888"># Basic usage with string path</span>
<span style="color: #008800; font-weight: bold">try</span>:
    data <span style="color: #333333">=</span> readf_json(<span style="background-color: #fff0f0">"data/config/settings.json"</span>)
    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Loaded settings: </span><span style="background-color: #eeeeee">{</span>data<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
<span style="color: #008800; font-weight: bold">except</span> StructuredError <span style="color: #008800; font-weight: bold">as</span> e:
    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Failed to load settings: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

<span style="color: #888888"># Usage with Path object</span>
config_path <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/invoice/invoice.json"</span>)
<span style="color: #008800; font-weight: bold">try</span>:
    invoice_data <span style="color: #333333">=</span> readf_json(config_path)
    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Invoice title: </span><span style="background-color: #eeeeee">{</span>invoice_data<span style="color: #333333">.</span>get(<span style="background-color: #fff0f0">'basic'</span>,<span style="color: #bbbbbb"> </span>{})<span style="color: #333333">.</span>get(<span style="background-color: #fff0f0">'title'</span>,<span style="color: #bbbbbb"> </span><span style="background-color: #fff0f0">'Unknown'</span>)<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Sample count: </span><span style="background-color: #eeeeee">{</span><span style="color: #007020">len</span>(invoice_data<span style="color: #333333">.</span>get(<span style="background-color: #fff0f0">'sample'</span>,<span style="color: #bbbbbb"> </span>{})<span style="color: #333333">.</span>get(<span style="background-color: #fff0f0">'names'</span>,<span style="color: #bbbbbb"> </span>[]))<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
<span style="color: #008800; font-weight: bold">except</span> StructuredError <span style="color: #008800; font-weight: bold">as</span> e:
    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Failed to load invoice: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

<span style="color: #888888"># Reading files with various encodings</span>
file_paths <span style="color: #333333">=</span> [
    <span style="background-color: #fff0f0">"data/utf8_file.json"</span>,
    <span style="background-color: #fff0f0">"data/shift_jis_file.json"</span>,
    <span style="background-color: #fff0f0">"data/utf16_file.json"</span>
]

<span style="color: #008800; font-weight: bold">for</span> file_path <span style="color: #000000; font-weight: bold">in</span> file_paths:
    <span style="color: #008800; font-weight: bold">try</span>:
        data <span style="color: #333333">=</span> readf_json(file_path)
        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Successfully read </span><span style="background-color: #eeeeee">{</span>file_path<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">: </span><span style="background-color: #eeeeee">{</span><span style="color: #007020">len</span>(data)<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0"> keys"</span>)
    <span style="color: #008800; font-weight: bold">except</span> StructuredError <span style="color: #008800; font-weight: bold">as</span> e:
        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Failed to read </span><span style="background-color: #eeeeee">{</span>file_path<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

<span style="color: #888888"># Error handling example</span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">safe_json_read</span>(file_path: <span style="color: #007020">str</span>) <span style="color: #333333">-&gt;</span> <span style="color: #007020">dict</span> <span style="color: #333333">|</span> <span style="color: #008800; font-weight: bold">None</span>:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Safely read JSON file with error handling."""</span>
    <span style="color: #008800; font-weight: bold">try</span>:
        <span style="color: #008800; font-weight: bold">return</span> readf_json(file_path)
    <span style="color: #008800; font-weight: bold">except</span> StructuredError <span style="color: #008800; font-weight: bold">as</span> e:
        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Error reading </span><span style="background-color: #eeeeee">{</span>file_path<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">None</span>

<span style="color: #888888"># Usage in batch processing</span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">load_multiple_configs</span>(config_dir: Path) <span style="color: #333333">-&gt;</span> <span style="color: #007020">dict</span>[<span style="color: #007020">str</span>, <span style="color: #007020">dict</span>]:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Load multiple JSON configuration files."""</span>
    configs <span style="color: #333333">=</span> {}

    <span style="color: #008800; font-weight: bold">for</span> json_file <span style="color: #000000; font-weight: bold">in</span> config_dir<span style="color: #333333">.</span>glob(<span style="background-color: #fff0f0">"*.json"</span>):
        <span style="color: #008800; font-weight: bold">try</span>:
            config_data <span style="color: #333333">=</span> readf_json(json_file)
            configs[json_file<span style="color: #333333">.</span>stem] <span style="color: #333333">=</span> config_data
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"✓ Loaded config: </span><span style="background-color: #eeeeee">{</span>json_file<span style="color: #333333">.</span>name<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
        <span style="color: #008800; font-weight: bold">except</span> StructuredError <span style="color: #008800; font-weight: bold">as</span> e:
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"✗ Failed to load </span><span style="background-color: #eeeeee">{</span>json_file<span style="color: #333333">.</span>name<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

    <span style="color: #008800; font-weight: bold">return</span> configs

<span style="color: #888888"># Example usage</span>
config_directory <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/configs"</span>)
all_configs <span style="color: #333333">=</span> load_multiple_configs(config_directory)
<span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Loaded </span><span style="background-color: #eeeeee">{</span><span style="color: #007020">len</span>(all_configs)<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0"> configuration files"</span>)
</code></pre></div></td></tr></table></div>
<h3 id="writef_json">writef_json</h3>
<p>Write a dictionary object to a JSON file with specified encoding.</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">writef_json</span>(path: <span style="color: #007020">str</span> <span style="color: #333333">|</span> Path, obj: <span style="color: #007020">dict</span>[<span style="color: #007020">str</span>, Any], <span style="color: #333333">*</span>, enc: <span style="color: #007020">str</span> <span style="color: #333333">=</span> <span style="background-color: #fff0f0">"utf_8"</span>) <span style="color: #333333">-&gt;</span> <span style="color: #007020">dict</span>[<span style="color: #007020">str</span>, Any]
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>path</code> (str | Path): Path to the destination JSON file
- <code>obj</code> (dict[str, Any]): Dictionary object to be serialized and written
- <code>enc</code> (str): Encoding to use when writing the file (default: "utf_8")</p>
<p><strong>Returns:</strong>
- <code>dict[str, Any]</code>: The same dictionary object that was written (for chaining operations)</p>
<p><strong>Features:</strong>
- Pretty-printed JSON output with 4-space indentation
- Unicode support with <code>ensure_ascii=False</code> for international characters
- Flexible encoding specification
- Support for both string paths and Path objects
- Returns the input object for method chaining</p>
<p><strong>Example:</strong></p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">14</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">15</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">16</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">17</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">18</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">19</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">20</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">21</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">22</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">23</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">24</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">25</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">26</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">27</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">28</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">29</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">30</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">31</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">32</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">33</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">34</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">35</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">36</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">37</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">38</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">39</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">40</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">41</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">42</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">43</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">44</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">45</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">46</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">47</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">48</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">49</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">50</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">51</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">52</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">53</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">54</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">55</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">56</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">57</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">58</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">59</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">60</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">61</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">62</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">63</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">64</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">65</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">66</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">67</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">68</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">69</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">70</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">71</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">72</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">73</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">74</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">75</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">76</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">77</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">78</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">79</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">80</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">81</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">82</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">83</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">84</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">rdetoolkit.fileops</span> <span style="color: #008800; font-weight: bold">import</span> writef_json
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">pathlib</span> <span style="color: #008800; font-weight: bold">import</span> Path
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">datetime</span>

<span style="color: #888888"># Basic usage</span>
data <span style="color: #333333">=</span> {
    <span style="background-color: #fff0f0">"title"</span>: <span style="background-color: #fff0f0">"Sample Dataset"</span>,
    <span style="background-color: #fff0f0">"description"</span>: <span style="background-color: #fff0f0">"This is a test dataset"</span>,
    <span style="background-color: #fff0f0">"created"</span>: datetime<span style="color: #333333">.</span>datetime<span style="color: #333333">.</span>now()<span style="color: #333333">.</span>isoformat(),
    <span style="background-color: #fff0f0">"version"</span>: <span style="background-color: #fff0f0">"1.0.0"</span>
}

output_path <span style="color: #333333">=</span> <span style="background-color: #fff0f0">"data/output/sample.json"</span>
written_data <span style="color: #333333">=</span> writef_json(output_path, data)
<span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Written data keys: </span><span style="background-color: #eeeeee">{</span><span style="color: #007020">list</span>(written_data<span style="color: #333333">.</span>keys())<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

<span style="color: #888888"># Usage with Path object and custom encoding</span>
metadata <span style="color: #333333">=</span> {
    <span style="background-color: #fff0f0">"experiment_id"</span>: <span style="background-color: #fff0f0">"EXP_2024_001"</span>,
    <span style="background-color: #fff0f0">"researcher"</span>: <span style="background-color: #fff0f0">"田中太郎"</span>,  <span style="color: #888888"># Japanese characters</span>
    <span style="background-color: #fff0f0">"location"</span>: <span style="background-color: #fff0f0">"東京大学"</span>,
    <span style="background-color: #fff0f0">"measurements"</span>: [
        {<span style="background-color: #fff0f0">"temperature"</span>: <span style="color: #6600EE; font-weight: bold">25.5</span>, <span style="background-color: #fff0f0">"unit"</span>: <span style="background-color: #fff0f0">"°C"</span>},
        {<span style="background-color: #fff0f0">"pressure"</span>: <span style="color: #6600EE; font-weight: bold">1013.25</span>, <span style="background-color: #fff0f0">"unit"</span>: <span style="background-color: #fff0f0">"hPa"</span>}
    ]
}

output_path <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/metadata/experiment_metadata.json"</span>)
writef_json(output_path, metadata, enc<span style="color: #333333">=</span><span style="background-color: #fff0f0">"utf_8"</span>)

<span style="color: #888888"># Method chaining example</span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">create_and_save_config</span>(name: <span style="color: #007020">str</span>, settings: <span style="color: #007020">dict</span>) <span style="color: #333333">-&gt;</span> <span style="color: #007020">dict</span>:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Create configuration and save to file."""</span>
    config <span style="color: #333333">=</span> {
        <span style="background-color: #fff0f0">"name"</span>: name,
        <span style="background-color: #fff0f0">"created_at"</span>: datetime<span style="color: #333333">.</span>datetime<span style="color: #333333">.</span>now()<span style="color: #333333">.</span>isoformat(),
        <span style="background-color: #fff0f0">"settings"</span>: settings,
        <span style="background-color: #fff0f0">"version"</span>: <span style="background-color: #fff0f0">"1.0"</span>
    }

    file_path <span style="color: #333333">=</span> <span style="background-color: #fff0f0">f"data/configs/</span><span style="background-color: #eeeeee">{</span>name<span style="color: #333333">.</span>lower()<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">.json"</span>
    <span style="color: #008800; font-weight: bold">return</span> writef_json(file_path, config)

<span style="color: #888888"># Usage</span>
app_config <span style="color: #333333">=</span> create_and_save_config(<span style="background-color: #fff0f0">"Application"</span>, {
    <span style="background-color: #fff0f0">"debug"</span>: <span style="color: #008800; font-weight: bold">True</span>,
    <span style="background-color: #fff0f0">"log_level"</span>: <span style="background-color: #fff0f0">"INFO"</span>,
    <span style="background-color: #fff0f0">"max_workers"</span>: <span style="color: #0000DD; font-weight: bold">4</span>
})

<span style="color: #888888"># Batch writing example</span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">save_multiple_files</span>(data_dict: <span style="color: #007020">dict</span>[<span style="color: #007020">str</span>, <span style="color: #007020">dict</span>], output_dir: Path) <span style="color: #333333">-&gt;</span> <span style="color: #007020">list</span>[Path]:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Save multiple dictionaries as separate JSON files."""</span>
    output_dir<span style="color: #333333">.</span>mkdir(parents<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">True</span>, exist_ok<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">True</span>)
    saved_files <span style="color: #333333">=</span> []

    <span style="color: #008800; font-weight: bold">for</span> filename, data <span style="color: #000000; font-weight: bold">in</span> data_dict<span style="color: #333333">.</span>items():
        file_path <span style="color: #333333">=</span> output_dir <span style="color: #333333">/</span> <span style="background-color: #fff0f0">f"</span><span style="background-color: #eeeeee">{</span>filename<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">.json"</span>
        <span style="color: #008800; font-weight: bold">try</span>:
            writef_json(file_path, data)
            saved_files<span style="color: #333333">.</span>append(file_path)
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"✓ Saved: </span><span style="background-color: #eeeeee">{</span>file_path<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
        <span style="color: #008800; font-weight: bold">except</span> <span style="color: #FF0000; font-weight: bold">Exception</span> <span style="color: #008800; font-weight: bold">as</span> e:
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"✗ Failed to save </span><span style="background-color: #eeeeee">{</span>file_path<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

    <span style="color: #008800; font-weight: bold">return</span> saved_files

<span style="color: #888888"># Example data</span>
datasets <span style="color: #333333">=</span> {
    <span style="background-color: #fff0f0">"dataset_a"</span>: {
        <span style="background-color: #fff0f0">"samples"</span>: <span style="color: #0000DD; font-weight: bold">100</span>,
        <span style="background-color: #fff0f0">"type"</span>: <span style="background-color: #fff0f0">"experimental"</span>,
        <span style="background-color: #fff0f0">"status"</span>: <span style="background-color: #fff0f0">"completed"</span>
    },
    <span style="background-color: #fff0f0">"dataset_b"</span>: {
        <span style="background-color: #fff0f0">"samples"</span>: <span style="color: #0000DD; font-weight: bold">250</span>,
        <span style="background-color: #fff0f0">"type"</span>: <span style="background-color: #fff0f0">"observational"</span>,
        <span style="background-color: #fff0f0">"status"</span>: <span style="background-color: #fff0f0">"in_progress"</span>
    }
}

output_directory <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/datasets"</span>)
saved_paths <span style="color: #333333">=</span> save_multiple_files(datasets, output_directory)
<span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Saved </span><span style="background-color: #eeeeee">{</span><span style="color: #007020">len</span>(saved_paths)<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0"> dataset files"</span>)
</code></pre></div></td></tr></table></div>
<h2 id="complete-usage-examples">Complete Usage Examples</h2>
<h3 id="json-configuration-manager">JSON Configuration Manager</h3>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 13</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 14</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 15</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 16</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 17</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 18</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 19</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 20</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 21</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 22</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 23</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 24</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 25</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 26</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 27</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 28</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 29</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 30</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 31</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 32</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 33</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 34</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 35</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 36</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 37</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 38</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 39</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 40</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 41</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 42</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 43</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 44</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 45</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 46</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 47</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 48</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 49</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 50</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 51</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 52</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 53</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 54</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 55</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 56</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 57</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 58</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 59</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 60</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 61</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 62</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 63</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 64</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 65</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 66</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 67</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 68</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 69</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 70</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 71</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 72</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 73</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 74</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 75</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 76</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 77</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 78</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 79</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 80</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 81</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 82</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 83</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 84</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 85</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 86</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 87</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 88</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 89</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 90</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 91</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 92</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 93</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 94</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 95</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 96</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 97</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 98</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 99</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">100</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">101</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">102</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">103</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">104</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">105</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">106</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">107</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">108</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">109</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">110</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">111</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">112</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">113</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">114</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">115</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">116</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">117</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">118</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">119</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">120</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">121</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">122</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">123</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">124</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">125</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">126</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">127</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">128</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">129</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">130</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">131</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">132</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">133</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">134</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">135</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">136</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">137</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">138</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">139</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">140</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">141</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">142</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">143</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">144</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">145</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">146</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">147</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">148</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">149</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">150</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">151</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">152</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">153</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">154</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">155</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">156</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">157</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">158</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">159</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">160</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">161</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">162</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">163</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">164</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">165</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">166</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">167</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">168</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">169</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">170</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">171</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">172</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">173</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">174</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">175</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">176</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">177</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">178</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">179</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">180</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">181</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">182</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">183</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">184</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">185</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">186</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">187</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">188</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">189</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">190</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">191</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">192</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">193</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">194</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">195</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">196</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">197</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">198</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">199</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">200</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">201</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">202</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">203</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">204</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">205</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">206</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">207</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">rdetoolkit.fileops</span> <span style="color: #008800; font-weight: bold">import</span> readf_json, writef_json
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">rdetoolkit.exceptions</span> <span style="color: #008800; font-weight: bold">import</span> StructuredError
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">pathlib</span> <span style="color: #008800; font-weight: bold">import</span> Path
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">datetime</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">json</span>
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">typing</span> <span style="color: #008800; font-weight: bold">import</span> Dict, Any, Optional, List

<span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">JSONConfigManager</span>:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""A comprehensive JSON configuration file manager."""</span>

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">__init__</span>(<span style="color: #007020">self</span>, config_dir: Path):
        <span style="color: #007020">self</span><span style="color: #333333">.</span>config_dir <span style="color: #333333">=</span> config_dir
        <span style="color: #007020">self</span><span style="color: #333333">.</span>config_dir<span style="color: #333333">.</span>mkdir(parents<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">True</span>, exist_ok<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">True</span>)
        <span style="color: #007020">self</span><span style="color: #333333">.</span>loaded_configs: Dict[<span style="color: #007020">str</span>, Dict[<span style="color: #007020">str</span>, Any]] <span style="color: #333333">=</span> {}

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">load_config</span>(<span style="color: #007020">self</span>, config_name: <span style="color: #007020">str</span>) <span style="color: #333333">-&gt;</span> Optional[Dict[<span style="color: #007020">str</span>, Any]]:
<span style="color: #bbbbbb">        </span><span style="color: #DD4422">"""Load a single configuration file."""</span>
        config_path <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>config_dir <span style="color: #333333">/</span> <span style="background-color: #fff0f0">f"</span><span style="background-color: #eeeeee">{</span>config_name<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">.json"</span>

        <span style="color: #008800; font-weight: bold">try</span>:
            config_data <span style="color: #333333">=</span> readf_json(config_path)
            <span style="color: #007020">self</span><span style="color: #333333">.</span>loaded_configs[config_name] <span style="color: #333333">=</span> config_data
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"✓ Loaded config: </span><span style="background-color: #eeeeee">{</span>config_name<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
            <span style="color: #008800; font-weight: bold">return</span> config_data
        <span style="color: #008800; font-weight: bold">except</span> StructuredError <span style="color: #008800; font-weight: bold">as</span> e:
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"✗ Failed to load config </span><span style="background-color: #eeeeee">{</span>config_name<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
            <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">None</span>

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">save_config</span>(<span style="color: #007020">self</span>, config_name: <span style="color: #007020">str</span>, config_data: Dict[<span style="color: #007020">str</span>, Any]) <span style="color: #333333">-&gt;</span> <span style="color: #007020">bool</span>:
<span style="color: #bbbbbb">        </span><span style="color: #DD4422">"""Save a configuration file."""</span>
        config_path <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>config_dir <span style="color: #333333">/</span> <span style="background-color: #fff0f0">f"</span><span style="background-color: #eeeeee">{</span>config_name<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">.json"</span>

        <span style="color: #008800; font-weight: bold">try</span>:
            <span style="color: #888888"># Add metadata</span>
            config_with_meta <span style="color: #333333">=</span> {
                <span style="background-color: #fff0f0">"_metadata"</span>: {
                    <span style="background-color: #fff0f0">"saved_at"</span>: datetime<span style="color: #333333">.</span>datetime<span style="color: #333333">.</span>now()<span style="color: #333333">.</span>isoformat(),
                    <span style="background-color: #fff0f0">"version"</span>: <span style="background-color: #fff0f0">"1.0"</span>,
                    <span style="background-color: #fff0f0">"config_name"</span>: config_name
                },
                <span style="color: #333333">**</span>config_data
            }

            writef_json(config_path, config_with_meta)
            <span style="color: #007020">self</span><span style="color: #333333">.</span>loaded_configs[config_name] <span style="color: #333333">=</span> config_with_meta
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"✓ Saved config: </span><span style="background-color: #eeeeee">{</span>config_name<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
            <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">True</span>
        <span style="color: #008800; font-weight: bold">except</span> <span style="color: #FF0000; font-weight: bold">Exception</span> <span style="color: #008800; font-weight: bold">as</span> e:
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"✗ Failed to save config </span><span style="background-color: #eeeeee">{</span>config_name<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
            <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">False</span>

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">load_all_configs</span>(<span style="color: #007020">self</span>) <span style="color: #333333">-&gt;</span> Dict[<span style="color: #007020">str</span>, Dict[<span style="color: #007020">str</span>, Any]]:
<span style="color: #bbbbbb">        </span><span style="color: #DD4422">"""Load all JSON configuration files in the directory."""</span>
        configs <span style="color: #333333">=</span> {}

        <span style="color: #008800; font-weight: bold">for</span> json_file <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>config_dir<span style="color: #333333">.</span>glob(<span style="background-color: #fff0f0">"*.json"</span>):
            config_name <span style="color: #333333">=</span> json_file<span style="color: #333333">.</span>stem
            config_data <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>load_config(config_name)
            <span style="color: #008800; font-weight: bold">if</span> config_data:
                configs[config_name] <span style="color: #333333">=</span> config_data

        <span style="color: #008800; font-weight: bold">return</span> configs

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">get_config</span>(<span style="color: #007020">self</span>, config_name: <span style="color: #007020">str</span>, key: <span style="color: #007020">str</span> <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">None</span>, default: Any <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">None</span>) <span style="color: #333333">-&gt;</span> Any:
<span style="color: #bbbbbb">        </span><span style="color: #DD4422">"""Get configuration value with optional key path."""</span>
        <span style="color: #008800; font-weight: bold">if</span> config_name <span style="color: #000000; font-weight: bold">not</span> <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>loaded_configs:
            config_data <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>load_config(config_name)
            <span style="color: #008800; font-weight: bold">if</span> <span style="color: #000000; font-weight: bold">not</span> config_data:
                <span style="color: #008800; font-weight: bold">return</span> default

        config <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>loaded_configs[config_name]

        <span style="color: #008800; font-weight: bold">if</span> key <span style="color: #000000; font-weight: bold">is</span> <span style="color: #008800; font-weight: bold">None</span>:
            <span style="color: #008800; font-weight: bold">return</span> config

        <span style="color: #888888"># Support nested key access like "database.host"</span>
        keys <span style="color: #333333">=</span> key<span style="color: #333333">.</span>split(<span style="background-color: #fff0f0">'.'</span>)
        value <span style="color: #333333">=</span> config

        <span style="color: #008800; font-weight: bold">try</span>:
            <span style="color: #008800; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> keys:
                value <span style="color: #333333">=</span> value[k]
            <span style="color: #008800; font-weight: bold">return</span> value
        <span style="color: #008800; font-weight: bold">except</span> (<span style="color: #FF0000; font-weight: bold">KeyError</span>, <span style="color: #FF0000; font-weight: bold">TypeError</span>):
            <span style="color: #008800; font-weight: bold">return</span> default

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">update_config</span>(<span style="color: #007020">self</span>, config_name: <span style="color: #007020">str</span>, updates: Dict[<span style="color: #007020">str</span>, Any]) <span style="color: #333333">-&gt;</span> <span style="color: #007020">bool</span>:
<span style="color: #bbbbbb">        </span><span style="color: #DD4422">"""Update an existing configuration."""</span>
        <span style="color: #008800; font-weight: bold">if</span> config_name <span style="color: #000000; font-weight: bold">not</span> <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>loaded_configs:
            <span style="color: #008800; font-weight: bold">if</span> <span style="color: #000000; font-weight: bold">not</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>load_config(config_name):
                <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">False</span>

        config <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>loaded_configs[config_name]<span style="color: #333333">.</span>copy()
        config<span style="color: #333333">.</span>update(updates)

        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>save_config(config_name, config)

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">backup_configs</span>(<span style="color: #007020">self</span>, backup_dir: Path) <span style="color: #333333">-&gt;</span> List[Path]:
<span style="color: #bbbbbb">        </span><span style="color: #DD4422">"""Create backup copies of all configuration files."""</span>
        backup_dir<span style="color: #333333">.</span>mkdir(parents<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">True</span>, exist_ok<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">True</span>)
        backed_up_files <span style="color: #333333">=</span> []

        timestamp <span style="color: #333333">=</span> datetime<span style="color: #333333">.</span>datetime<span style="color: #333333">.</span>now()<span style="color: #333333">.</span>strftime(<span style="background-color: #fff0f0">"%Y%m</span><span style="background-color: #eeeeee">%d</span><span style="background-color: #fff0f0">_%H%M%S"</span>)

        <span style="color: #008800; font-weight: bold">for</span> config_name, config_data <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>loaded_configs<span style="color: #333333">.</span>items():
            backup_filename <span style="color: #333333">=</span> <span style="background-color: #fff0f0">f"</span><span style="background-color: #eeeeee">{</span>config_name<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">_backup_</span><span style="background-color: #eeeeee">{</span>timestamp<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">.json"</span>
            backup_path <span style="color: #333333">=</span> backup_dir <span style="color: #333333">/</span> backup_filename

            <span style="color: #008800; font-weight: bold">try</span>:
                writef_json(backup_path, config_data)
                backed_up_files<span style="color: #333333">.</span>append(backup_path)
                <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"✓ Backed up: </span><span style="background-color: #eeeeee">{</span>backup_filename<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
            <span style="color: #008800; font-weight: bold">except</span> <span style="color: #FF0000; font-weight: bold">Exception</span> <span style="color: #008800; font-weight: bold">as</span> e:
                <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"✗ Failed to backup </span><span style="background-color: #eeeeee">{</span>config_name<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

        <span style="color: #008800; font-weight: bold">return</span> backed_up_files

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">validate_config_schema</span>(<span style="color: #007020">self</span>, config_name: <span style="color: #007020">str</span>, required_keys: List[<span style="color: #007020">str</span>]) <span style="color: #333333">-&gt;</span> <span style="color: #007020">bool</span>:
<span style="color: #bbbbbb">        </span><span style="color: #DD4422">"""Validate that a configuration contains required keys."""</span>
        config <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>get_config(config_name)
        <span style="color: #008800; font-weight: bold">if</span> <span style="color: #000000; font-weight: bold">not</span> config:
            <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">False</span>

        missing_keys <span style="color: #333333">=</span> [key <span style="color: #008800; font-weight: bold">for</span> key <span style="color: #000000; font-weight: bold">in</span> required_keys <span style="color: #008800; font-weight: bold">if</span> key <span style="color: #000000; font-weight: bold">not</span> <span style="color: #000000; font-weight: bold">in</span> config]
        <span style="color: #008800; font-weight: bold">if</span> missing_keys:
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Config </span><span style="background-color: #eeeeee">{</span>config_name<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0"> missing required keys: </span><span style="background-color: #eeeeee">{</span>missing_keys<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
            <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">False</span>

        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">True</span>

<span style="color: #888888"># Usage example</span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">demonstrate_config_manager</span>():
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Demonstrate the JSON configuration manager."""</span>

    <span style="color: #888888"># Setup manager</span>
    config_dir <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/configs"</span>)
    manager <span style="color: #333333">=</span> JSONConfigManager(config_dir)

    <span style="color: #888888"># Create sample configurations</span>
    database_config <span style="color: #333333">=</span> {
        <span style="background-color: #fff0f0">"host"</span>: <span style="background-color: #fff0f0">"localhost"</span>,
        <span style="background-color: #fff0f0">"port"</span>: <span style="color: #0000DD; font-weight: bold">5432</span>,
        <span style="background-color: #fff0f0">"database"</span>: <span style="background-color: #fff0f0">"research_db"</span>,
        <span style="background-color: #fff0f0">"username"</span>: <span style="background-color: #fff0f0">"researcher"</span>,
        <span style="background-color: #fff0f0">"pool_size"</span>: <span style="color: #0000DD; font-weight: bold">10</span>,
        <span style="background-color: #fff0f0">"ssl"</span>: <span style="color: #008800; font-weight: bold">True</span>
    }

    app_config <span style="color: #333333">=</span> {
        <span style="background-color: #fff0f0">"name"</span>: <span style="background-color: #fff0f0">"RDE Toolkit"</span>,
        <span style="background-color: #fff0f0">"debug"</span>: <span style="color: #008800; font-weight: bold">False</span>,
        <span style="background-color: #fff0f0">"log_level"</span>: <span style="background-color: #fff0f0">"INFO"</span>,
        <span style="background-color: #fff0f0">"features"</span>: {
            <span style="background-color: #fff0f0">"auto_backup"</span>: <span style="color: #008800; font-weight: bold">True</span>,
            <span style="background-color: #fff0f0">"compression"</span>: <span style="color: #008800; font-weight: bold">True</span>,
            <span style="background-color: #fff0f0">"validation"</span>: <span style="color: #008800; font-weight: bold">True</span>
        },
        <span style="background-color: #fff0f0">"limits"</span>: {
            <span style="background-color: #fff0f0">"max_file_size"</span>: <span style="background-color: #fff0f0">"100MB"</span>,
            <span style="background-color: #fff0f0">"max_concurrent_jobs"</span>: <span style="color: #0000DD; font-weight: bold">4</span>
        }
    }

    processing_config <span style="color: #333333">=</span> {
        <span style="background-color: #fff0f0">"batch_size"</span>: <span style="color: #0000DD; font-weight: bold">50</span>,
        <span style="background-color: #fff0f0">"timeout"</span>: <span style="color: #0000DD; font-weight: bold">300</span>,
        <span style="background-color: #fff0f0">"retry_attempts"</span>: <span style="color: #0000DD; font-weight: bold">3</span>,
        <span style="background-color: #fff0f0">"output_format"</span>: <span style="background-color: #fff0f0">"json"</span>,
        <span style="background-color: #fff0f0">"compression"</span>: <span style="background-color: #fff0f0">"gzip"</span>
    }

    <span style="color: #888888"># Save configurations</span>
    manager<span style="color: #333333">.</span>save_config(<span style="background-color: #fff0f0">"database"</span>, database_config)
    manager<span style="color: #333333">.</span>save_config(<span style="background-color: #fff0f0">"application"</span>, app_config)
    manager<span style="color: #333333">.</span>save_config(<span style="background-color: #fff0f0">"processing"</span>, processing_config)

    <span style="color: #888888"># Load and use configurations</span>
    db_host <span style="color: #333333">=</span> manager<span style="color: #333333">.</span>get_config(<span style="background-color: #fff0f0">"database"</span>, <span style="background-color: #fff0f0">"host"</span>)
    app_name <span style="color: #333333">=</span> manager<span style="color: #333333">.</span>get_config(<span style="background-color: #fff0f0">"application"</span>, <span style="background-color: #fff0f0">"name"</span>)
    debug_mode <span style="color: #333333">=</span> manager<span style="color: #333333">.</span>get_config(<span style="background-color: #fff0f0">"application"</span>, <span style="background-color: #fff0f0">"debug"</span>, <span style="color: #008800; font-weight: bold">False</span>)

    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Database host: </span><span style="background-color: #eeeeee">{</span>db_host<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Application name: </span><span style="background-color: #eeeeee">{</span>app_name<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Debug mode: </span><span style="background-color: #eeeeee">{</span>debug_mode<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

    <span style="color: #888888"># Update configuration</span>
    manager<span style="color: #333333">.</span>update_config(<span style="background-color: #fff0f0">"application"</span>, {
        <span style="background-color: #fff0f0">"debug"</span>: <span style="color: #008800; font-weight: bold">True</span>,
        <span style="background-color: #fff0f0">"log_level"</span>: <span style="background-color: #fff0f0">"DEBUG"</span>
    })

    <span style="color: #888888"># Validate configurations</span>
    required_db_keys <span style="color: #333333">=</span> [<span style="background-color: #fff0f0">"host"</span>, <span style="background-color: #fff0f0">"port"</span>, <span style="background-color: #fff0f0">"database"</span>, <span style="background-color: #fff0f0">"username"</span>]
    is_valid <span style="color: #333333">=</span> manager<span style="color: #333333">.</span>validate_config_schema(<span style="background-color: #fff0f0">"database"</span>, required_db_keys)
    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Database config valid: </span><span style="background-color: #eeeeee">{</span>is_valid<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

    <span style="color: #888888"># Load all configurations</span>
    all_configs <span style="color: #333333">=</span> manager<span style="color: #333333">.</span>load_all_configs()
    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Loaded </span><span style="background-color: #eeeeee">{</span><span style="color: #007020">len</span>(all_configs)<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0"> configurations"</span>)

    <span style="color: #888888"># Create backups</span>
    backup_dir <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/backups"</span>)
    backed_up_files <span style="color: #333333">=</span> manager<span style="color: #333333">.</span>backup_configs(backup_dir)
    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Created </span><span style="background-color: #eeeeee">{</span><span style="color: #007020">len</span>(backed_up_files)<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0"> backup files"</span>)

<span style="color: #008800; font-weight: bold">if</span> <span style="color: #996633">__name__</span> <span style="color: #333333">==</span> <span style="background-color: #fff0f0">"__main__"</span>:
    demonstrate_config_manager()
</code></pre></div></td></tr></table></div>
<h3 id="advanced-json-processing-pipeline">Advanced JSON Processing Pipeline</h3>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 13</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 14</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 15</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 16</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 17</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 18</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 19</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 20</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 21</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 22</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 23</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 24</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 25</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 26</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 27</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 28</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 29</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 30</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 31</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 32</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 33</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 34</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 35</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 36</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 37</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 38</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 39</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 40</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 41</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 42</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 43</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 44</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 45</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 46</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 47</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 48</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 49</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 50</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 51</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 52</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 53</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 54</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 55</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 56</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 57</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 58</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 59</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 60</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 61</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 62</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 63</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 64</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 65</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 66</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 67</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 68</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 69</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 70</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 71</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 72</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 73</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 74</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 75</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 76</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 77</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 78</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 79</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 80</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 81</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 82</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 83</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 84</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 85</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 86</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 87</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 88</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 89</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 90</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 91</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 92</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 93</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 94</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 95</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 96</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 97</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 98</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 99</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">100</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">101</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">102</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">103</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">104</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">105</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">106</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">107</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">108</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">109</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">110</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">111</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">112</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">113</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">114</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">115</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">116</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">117</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">118</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">119</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">120</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">121</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">122</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">123</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">124</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">125</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">126</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">127</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">128</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">129</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">130</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">131</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">132</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">133</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">134</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">135</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">136</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">137</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">138</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">139</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">140</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">141</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">142</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">143</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">144</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">145</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">146</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">147</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">148</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">149</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">150</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">151</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">152</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">153</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">154</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">155</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">156</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">157</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">158</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">159</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">160</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">161</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">162</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">163</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">164</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">165</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">166</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">167</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">168</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">169</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">170</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">171</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">172</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">173</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">174</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">175</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">176</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">177</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">178</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">179</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">180</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">181</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">182</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">183</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">184</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">185</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">186</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">187</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">188</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">189</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">190</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">191</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">192</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">193</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">194</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">195</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">196</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">197</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">198</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">199</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">200</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">201</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">202</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">203</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">204</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">205</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">206</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">207</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">208</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">209</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">210</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">211</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">212</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">213</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">214</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">215</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">216</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">217</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">218</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">219</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">220</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">221</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">222</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">223</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">224</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">225</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">226</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">227</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">228</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">229</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">230</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">231</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">232</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">233</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">234</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">235</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">236</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">237</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">238</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">239</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">240</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">241</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">242</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">243</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">244</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">245</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">246</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">247</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">248</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">249</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">250</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">251</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">252</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">253</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">254</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">255</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">256</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">257</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">258</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">259</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">260</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">261</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">262</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">263</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">264</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">265</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">266</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">rdetoolkit.fileops</span> <span style="color: #008800; font-weight: bold">import</span> readf_json, writef_json
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">rdetoolkit.exceptions</span> <span style="color: #008800; font-weight: bold">import</span> StructuredError
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">pathlib</span> <span style="color: #008800; font-weight: bold">import</span> Path
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">datetime</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">hashlib</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">shutil</span>
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">typing</span> <span style="color: #008800; font-weight: bold">import</span> Dict, Any, List, Optional, Callable
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">json</span>

<span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">JSONProcessingPipeline</span>:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Advanced JSON file processing pipeline with validation and transformation."""</span>

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">__init__</span>(<span style="color: #007020">self</span>, input_dir: Path, output_dir: Path, working_dir: Path):
        <span style="color: #007020">self</span><span style="color: #333333">.</span>input_dir <span style="color: #333333">=</span> input_dir
        <span style="color: #007020">self</span><span style="color: #333333">.</span>output_dir <span style="color: #333333">=</span> output_dir
        <span style="color: #007020">self</span><span style="color: #333333">.</span>working_dir <span style="color: #333333">=</span> working_dir
        <span style="color: #007020">self</span><span style="color: #333333">.</span>backup_dir <span style="color: #333333">=</span> working_dir <span style="color: #333333">/</span> <span style="background-color: #fff0f0">"backups"</span>

        <span style="color: #888888"># Create directories</span>
        <span style="color: #008800; font-weight: bold">for</span> directory <span style="color: #000000; font-weight: bold">in</span> [<span style="color: #007020">self</span><span style="color: #333333">.</span>output_dir, <span style="color: #007020">self</span><span style="color: #333333">.</span>working_dir, <span style="color: #007020">self</span><span style="color: #333333">.</span>backup_dir]:
            directory<span style="color: #333333">.</span>mkdir(parents<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">True</span>, exist_ok<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">True</span>)

        <span style="color: #007020">self</span><span style="color: #333333">.</span>processing_log <span style="color: #333333">=</span> []
        <span style="color: #007020">self</span><span style="color: #333333">.</span>transformations: List[Callable[[Dict[<span style="color: #007020">str</span>, Any]], Dict[<span style="color: #007020">str</span>, Any]]] <span style="color: #333333">=</span> []

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">add_transformation</span>(<span style="color: #007020">self</span>, transform_func: Callable[[Dict[<span style="color: #007020">str</span>, Any]], Dict[<span style="color: #007020">str</span>, Any]]) <span style="color: #333333">-&gt;</span> <span style="color: #008800; font-weight: bold">None</span>:
<span style="color: #bbbbbb">        </span><span style="color: #DD4422">"""Add a transformation function to the pipeline."""</span>
        <span style="color: #007020">self</span><span style="color: #333333">.</span>transformations<span style="color: #333333">.</span>append(transform_func)

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">process_file</span>(<span style="color: #007020">self</span>, input_path: Path) <span style="color: #333333">-&gt;</span> Optional[Dict[<span style="color: #007020">str</span>, Any]]:
<span style="color: #bbbbbb">        </span><span style="color: #DD4422">"""Process a single JSON file through the pipeline."""</span>

        start_time <span style="color: #333333">=</span> datetime<span style="color: #333333">.</span>datetime<span style="color: #333333">.</span>now()

        <span style="color: #008800; font-weight: bold">try</span>:
            <span style="color: #888888"># Read input file</span>
            original_data <span style="color: #333333">=</span> readf_json(input_path)

            <span style="color: #888888"># Create backup</span>
            backup_path <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>backup_dir <span style="color: #333333">/</span> <span style="background-color: #fff0f0">f"</span><span style="background-color: #eeeeee">{</span>input_path<span style="color: #333333">.</span>stem<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">_backup_</span><span style="background-color: #eeeeee">{</span>start_time<span style="color: #333333">.</span>strftime(<span style="background-color: #fff0f0">'%Y%m</span><span style="background-color: #eeeeee">%d</span><span style="background-color: #fff0f0">_%H%M%S'</span>)<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">.json"</span>
            writef_json(backup_path, original_data)

            <span style="color: #888888"># Apply transformations</span>
            processed_data <span style="color: #333333">=</span> original_data<span style="color: #333333">.</span>copy()

            <span style="color: #008800; font-weight: bold">for</span> i, transform_func <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">enumerate</span>(<span style="color: #007020">self</span><span style="color: #333333">.</span>transformations):
                <span style="color: #008800; font-weight: bold">try</span>:
                    processed_data <span style="color: #333333">=</span> transform_func(processed_data)
                    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"  ✓ Applied transformation </span><span style="background-color: #eeeeee">{</span>i<span style="color: #333333">+</span><span style="color: #0000DD; font-weight: bold">1</span><span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
                <span style="color: #008800; font-weight: bold">except</span> <span style="color: #FF0000; font-weight: bold">Exception</span> <span style="color: #008800; font-weight: bold">as</span> e:
                    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"  ✗ Transformation </span><span style="background-color: #eeeeee">{</span>i<span style="color: #333333">+</span><span style="color: #0000DD; font-weight: bold">1</span><span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0"> failed: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
                    <span style="color: #888888"># Continue with previous data</span>

            <span style="color: #888888"># Add processing metadata</span>
            processed_data[<span style="background-color: #fff0f0">"_processing_info"</span>] <span style="color: #333333">=</span> {
                <span style="background-color: #fff0f0">"original_file"</span>: <span style="color: #007020">str</span>(input_path),
                <span style="background-color: #fff0f0">"processed_at"</span>: datetime<span style="color: #333333">.</span>datetime<span style="color: #333333">.</span>now()<span style="color: #333333">.</span>isoformat(),
                <span style="background-color: #fff0f0">"transformations_applied"</span>: <span style="color: #007020">len</span>(<span style="color: #007020">self</span><span style="color: #333333">.</span>transformations),
                <span style="background-color: #fff0f0">"backup_file"</span>: <span style="color: #007020">str</span>(backup_path),
                <span style="background-color: #fff0f0">"file_hash"</span>: <span style="color: #007020">self</span><span style="color: #333333">.</span>_calculate_file_hash(input_path)
            }

            <span style="color: #888888"># Save processed file</span>
            output_path <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>output_dir <span style="color: #333333">/</span> <span style="background-color: #fff0f0">f"processed_</span><span style="background-color: #eeeeee">{</span>input_path<span style="color: #333333">.</span>name<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>
            writef_json(output_path, processed_data)

            <span style="color: #888888"># Log processing</span>
            processing_time <span style="color: #333333">=</span> (datetime<span style="color: #333333">.</span>datetime<span style="color: #333333">.</span>now() <span style="color: #333333">-</span> start_time)<span style="color: #333333">.</span>total_seconds()
            log_entry <span style="color: #333333">=</span> {
                <span style="background-color: #fff0f0">"input_file"</span>: <span style="color: #007020">str</span>(input_path),
                <span style="background-color: #fff0f0">"output_file"</span>: <span style="color: #007020">str</span>(output_path),
                <span style="background-color: #fff0f0">"backup_file"</span>: <span style="color: #007020">str</span>(backup_path),
                <span style="background-color: #fff0f0">"processing_time"</span>: processing_time,
                <span style="background-color: #fff0f0">"status"</span>: <span style="background-color: #fff0f0">"success"</span>,
                <span style="background-color: #fff0f0">"transformations_count"</span>: <span style="color: #007020">len</span>(<span style="color: #007020">self</span><span style="color: #333333">.</span>transformations)
            }
            <span style="color: #007020">self</span><span style="color: #333333">.</span>processing_log<span style="color: #333333">.</span>append(log_entry)

            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"✓ Processed: </span><span style="background-color: #eeeeee">{</span>input_path<span style="color: #333333">.</span>name<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0"> -&gt; </span><span style="background-color: #eeeeee">{</span>output_path<span style="color: #333333">.</span>name<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0"> (</span><span style="background-color: #eeeeee">{</span>processing_time<span style="background-color: #eeeeee">:</span><span style="background-color: #fff0f0">.2f</span><span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">s)"</span>)
            <span style="color: #008800; font-weight: bold">return</span> processed_data

        <span style="color: #008800; font-weight: bold">except</span> StructuredError <span style="color: #008800; font-weight: bold">as</span> e:
            error_entry <span style="color: #333333">=</span> {
                <span style="background-color: #fff0f0">"input_file"</span>: <span style="color: #007020">str</span>(input_path),
                <span style="background-color: #fff0f0">"status"</span>: <span style="background-color: #fff0f0">"failed"</span>,
                <span style="background-color: #fff0f0">"error"</span>: <span style="color: #007020">str</span>(e),
                <span style="background-color: #fff0f0">"processing_time"</span>: (datetime<span style="color: #333333">.</span>datetime<span style="color: #333333">.</span>now() <span style="color: #333333">-</span> start_time)<span style="color: #333333">.</span>total_seconds()
            }
            <span style="color: #007020">self</span><span style="color: #333333">.</span>processing_log<span style="color: #333333">.</span>append(error_entry)
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"✗ Failed to process: </span><span style="background-color: #eeeeee">{</span>input_path<span style="color: #333333">.</span>name<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0"> - </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
            <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">None</span>

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">process_batch</span>(<span style="color: #007020">self</span>, pattern: <span style="color: #007020">str</span> <span style="color: #333333">=</span> <span style="background-color: #fff0f0">"*.json"</span>) <span style="color: #333333">-&gt;</span> Dict[<span style="color: #007020">str</span>, Any]:
<span style="color: #bbbbbb">        </span><span style="color: #DD4422">"""Process all JSON files matching the pattern."""</span>

        input_files <span style="color: #333333">=</span> <span style="color: #007020">list</span>(<span style="color: #007020">self</span><span style="color: #333333">.</span>input_dir<span style="color: #333333">.</span>glob(pattern))
        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Found </span><span style="background-color: #eeeeee">{</span><span style="color: #007020">len</span>(input_files)<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0"> files to process"</span>)

        results <span style="color: #333333">=</span> {
            <span style="background-color: #fff0f0">"total_files"</span>: <span style="color: #007020">len</span>(input_files),
            <span style="background-color: #fff0f0">"successful"</span>: <span style="color: #0000DD; font-weight: bold">0</span>,
            <span style="background-color: #fff0f0">"failed"</span>: <span style="color: #0000DD; font-weight: bold">0</span>,
            <span style="background-color: #fff0f0">"processed_files"</span>: []
        }

        <span style="color: #008800; font-weight: bold">for</span> input_file <span style="color: #000000; font-weight: bold">in</span> input_files:
            processed_data <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>process_file(input_file)
            <span style="color: #008800; font-weight: bold">if</span> processed_data:
                results[<span style="background-color: #fff0f0">"successful"</span>] <span style="color: #333333">+=</span> <span style="color: #0000DD; font-weight: bold">1</span>
                results[<span style="background-color: #fff0f0">"processed_files"</span>]<span style="color: #333333">.</span>append(<span style="color: #007020">str</span>(input_file))
            <span style="color: #008800; font-weight: bold">else</span>:
                results[<span style="background-color: #fff0f0">"failed"</span>] <span style="color: #333333">+=</span> <span style="color: #0000DD; font-weight: bold">1</span>

        <span style="color: #888888"># Save processing log</span>
        log_path <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>working_dir <span style="color: #333333">/</span> <span style="background-color: #fff0f0">f"processing_log_</span><span style="background-color: #eeeeee">{</span>datetime<span style="color: #333333">.</span>datetime<span style="color: #333333">.</span>now()<span style="color: #333333">.</span>strftime(<span style="background-color: #fff0f0">'%Y%m</span><span style="background-color: #eeeeee">%d</span><span style="background-color: #fff0f0">_%H%M%S'</span>)<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">.json"</span>
        writef_json(log_path, {
            <span style="background-color: #fff0f0">"batch_summary"</span>: results,
            <span style="background-color: #fff0f0">"processing_log"</span>: <span style="color: #007020">self</span><span style="color: #333333">.</span>processing_log
        })

        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"</span><span style="color: #666666; font-weight: bold; background-color: #fff0f0">\n</span><span style="background-color: #fff0f0">Batch processing completed:"</span>)
        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"  Successful: </span><span style="background-color: #eeeeee">{</span>results[<span style="background-color: #fff0f0">'successful'</span>]<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"  Failed: </span><span style="background-color: #eeeeee">{</span>results[<span style="background-color: #fff0f0">'failed'</span>]<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"  Log saved: </span><span style="background-color: #eeeeee">{</span>log_path<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

        <span style="color: #008800; font-weight: bold">return</span> results

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">_calculate_file_hash</span>(<span style="color: #007020">self</span>, file_path: Path) <span style="color: #333333">-&gt;</span> <span style="color: #007020">str</span>:
<span style="color: #bbbbbb">        </span><span style="color: #DD4422">"""Calculate SHA256 hash of a file."""</span>
        hash_sha256 <span style="color: #333333">=</span> hashlib<span style="color: #333333">.</span>sha256()
        <span style="color: #008800; font-weight: bold">with</span> <span style="color: #007020">open</span>(file_path, <span style="background-color: #fff0f0">"rb"</span>) <span style="color: #008800; font-weight: bold">as</span> f:
            <span style="color: #008800; font-weight: bold">for</span> chunk <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">iter</span>(<span style="color: #008800; font-weight: bold">lambda</span>: f<span style="color: #333333">.</span>read(<span style="color: #0000DD; font-weight: bold">4096</span>), <span style="background-color: #fff0f0">b""</span>):
                hash_sha256<span style="color: #333333">.</span>update(chunk)
        <span style="color: #008800; font-weight: bold">return</span> hash_sha256<span style="color: #333333">.</span>hexdigest()

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">validate_output</span>(<span style="color: #007020">self</span>, schema_validator: Optional[Callable[[Dict[<span style="color: #007020">str</span>, Any]], <span style="color: #007020">bool</span>]] <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">None</span>) <span style="color: #333333">-&gt;</span> Dict[<span style="color: #007020">str</span>, Any]:
<span style="color: #bbbbbb">        </span><span style="color: #DD4422">"""Validate all output files."""</span>

        validation_results <span style="color: #333333">=</span> {
            <span style="background-color: #fff0f0">"total_files"</span>: <span style="color: #0000DD; font-weight: bold">0</span>,
            <span style="background-color: #fff0f0">"valid_files"</span>: <span style="color: #0000DD; font-weight: bold">0</span>,
            <span style="background-color: #fff0f0">"invalid_files"</span>: <span style="color: #0000DD; font-weight: bold">0</span>,
            <span style="background-color: #fff0f0">"validation_errors"</span>: []
        }

        <span style="color: #008800; font-weight: bold">for</span> output_file <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>output_dir<span style="color: #333333">.</span>glob(<span style="background-color: #fff0f0">"processed_*.json"</span>):
            validation_results[<span style="background-color: #fff0f0">"total_files"</span>] <span style="color: #333333">+=</span> <span style="color: #0000DD; font-weight: bold">1</span>

            <span style="color: #008800; font-weight: bold">try</span>:
                data <span style="color: #333333">=</span> readf_json(output_file)

                <span style="color: #888888"># Basic validation</span>
                is_valid <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">True</span>
                <span style="color: #008800; font-weight: bold">if</span> <span style="background-color: #fff0f0">"_processing_info"</span> <span style="color: #000000; font-weight: bold">not</span> <span style="color: #000000; font-weight: bold">in</span> data:
                    is_valid <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">False</span>
                    validation_results[<span style="background-color: #fff0f0">"validation_errors"</span>]<span style="color: #333333">.</span>append({
                        <span style="background-color: #fff0f0">"file"</span>: <span style="color: #007020">str</span>(output_file),
                        <span style="background-color: #fff0f0">"error"</span>: <span style="background-color: #fff0f0">"Missing processing info"</span>
                    })

                <span style="color: #888888"># Custom validation</span>
                <span style="color: #008800; font-weight: bold">if</span> schema_validator <span style="color: #000000; font-weight: bold">and</span> is_valid:
                    <span style="color: #008800; font-weight: bold">if</span> <span style="color: #000000; font-weight: bold">not</span> schema_validator(data):
                        is_valid <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">False</span>
                        validation_results[<span style="background-color: #fff0f0">"validation_errors"</span>]<span style="color: #333333">.</span>append({
                            <span style="background-color: #fff0f0">"file"</span>: <span style="color: #007020">str</span>(output_file),
                            <span style="background-color: #fff0f0">"error"</span>: <span style="background-color: #fff0f0">"Schema validation failed"</span>
                        })

                <span style="color: #008800; font-weight: bold">if</span> is_valid:
                    validation_results[<span style="background-color: #fff0f0">"valid_files"</span>] <span style="color: #333333">+=</span> <span style="color: #0000DD; font-weight: bold">1</span>
                <span style="color: #008800; font-weight: bold">else</span>:
                    validation_results[<span style="background-color: #fff0f0">"invalid_files"</span>] <span style="color: #333333">+=</span> <span style="color: #0000DD; font-weight: bold">1</span>

            <span style="color: #008800; font-weight: bold">except</span> StructuredError <span style="color: #008800; font-weight: bold">as</span> e:
                validation_results[<span style="background-color: #fff0f0">"invalid_files"</span>] <span style="color: #333333">+=</span> <span style="color: #0000DD; font-weight: bold">1</span>
                validation_results[<span style="background-color: #fff0f0">"validation_errors"</span>]<span style="color: #333333">.</span>append({
                    <span style="background-color: #fff0f0">"file"</span>: <span style="color: #007020">str</span>(output_file),
                    <span style="background-color: #fff0f0">"error"</span>: <span style="background-color: #fff0f0">f"Read error: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>
                })

        <span style="color: #888888"># Save validation report</span>
        report_path <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>working_dir <span style="color: #333333">/</span> <span style="background-color: #fff0f0">f"validation_report_</span><span style="background-color: #eeeeee">{</span>datetime<span style="color: #333333">.</span>datetime<span style="color: #333333">.</span>now()<span style="color: #333333">.</span>strftime(<span style="background-color: #fff0f0">'%Y%m</span><span style="background-color: #eeeeee">%d</span><span style="background-color: #fff0f0">_%H%M%S'</span>)<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">.json"</span>
        writef_json(report_path, validation_results)

        <span style="color: #008800; font-weight: bold">return</span> validation_results

<span style="color: #888888"># Example transformations</span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">add_timestamp_transformation</span>(data: Dict[<span style="color: #007020">str</span>, Any]) <span style="color: #333333">-&gt;</span> Dict[<span style="color: #007020">str</span>, Any]:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Add timestamp to data."""</span>
    data[<span style="background-color: #fff0f0">"timestamp"</span>] <span style="color: #333333">=</span> datetime<span style="color: #333333">.</span>datetime<span style="color: #333333">.</span>now()<span style="color: #333333">.</span>isoformat()
    <span style="color: #008800; font-weight: bold">return</span> data

<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">normalize_keys_transformation</span>(data: Dict[<span style="color: #007020">str</span>, Any]) <span style="color: #333333">-&gt;</span> Dict[<span style="color: #007020">str</span>, Any]:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Normalize all keys to lowercase."""</span>
    <span style="color: #008800; font-weight: bold">if</span> <span style="color: #007020">isinstance</span>(data, <span style="color: #007020">dict</span>):
        <span style="color: #008800; font-weight: bold">return</span> {k<span style="color: #333333">.</span>lower(): normalize_keys_transformation(v) <span style="color: #008800; font-weight: bold">if</span> <span style="color: #007020">isinstance</span>(v, <span style="color: #007020">dict</span>) <span style="color: #008800; font-weight: bold">else</span> v
                <span style="color: #008800; font-weight: bold">for</span> k, v <span style="color: #000000; font-weight: bold">in</span> data<span style="color: #333333">.</span>items()}
    <span style="color: #008800; font-weight: bold">return</span> data

<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">add_version_transformation</span>(data: Dict[<span style="color: #007020">str</span>, Any]) <span style="color: #333333">-&gt;</span> Dict[<span style="color: #007020">str</span>, Any]:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Add version information."""</span>
    data[<span style="background-color: #fff0f0">"version"</span>] <span style="color: #333333">=</span> <span style="background-color: #fff0f0">"1.0.0"</span>
    data[<span style="background-color: #fff0f0">"format_version"</span>] <span style="color: #333333">=</span> <span style="background-color: #fff0f0">"rde_2024"</span>
    <span style="color: #008800; font-weight: bold">return</span> data

<span style="color: #888888"># Usage example</span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">demonstrate_json_pipeline</span>():
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Demonstrate the JSON processing pipeline."""</span>

    <span style="color: #888888"># Setup pipeline</span>
    input_dir <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/input_json"</span>)
    output_dir <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/processed_json"</span>)
    working_dir <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/working"</span>)

    pipeline <span style="color: #333333">=</span> JSONProcessingPipeline(input_dir, output_dir, working_dir)

    <span style="color: #888888"># Add transformations</span>
    pipeline<span style="color: #333333">.</span>add_transformation(add_timestamp_transformation)
    pipeline<span style="color: #333333">.</span>add_transformation(normalize_keys_transformation)
    pipeline<span style="color: #333333">.</span>add_transformation(add_version_transformation)

    <span style="color: #888888"># Create sample input files</span>
    input_dir<span style="color: #333333">.</span>mkdir(parents<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">True</span>, exist_ok<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">True</span>)

    sample_data <span style="color: #333333">=</span> [
        {
            <span style="background-color: #fff0f0">"Name"</span>: <span style="background-color: #fff0f0">"Dataset A"</span>,
            <span style="background-color: #fff0f0">"Description"</span>: <span style="background-color: #fff0f0">"Sample dataset for testing"</span>,
            <span style="background-color: #fff0f0">"Type"</span>: <span style="background-color: #fff0f0">"experimental"</span>,
            <span style="background-color: #fff0f0">"Samples"</span>: <span style="color: #0000DD; font-weight: bold">100</span>
        },
        {
            <span style="background-color: #fff0f0">"Title"</span>: <span style="background-color: #fff0f0">"Research Data B"</span>,
            <span style="background-color: #fff0f0">"Author"</span>: <span style="background-color: #fff0f0">"Research Team"</span>,
            <span style="background-color: #fff0f0">"Status"</span>: <span style="background-color: #fff0f0">"completed"</span>,
            <span style="background-color: #fff0f0">"Results"</span>: {<span style="background-color: #fff0f0">"accuracy"</span>: <span style="color: #6600EE; font-weight: bold">0.95</span>, <span style="background-color: #fff0f0">"precision"</span>: <span style="color: #6600EE; font-weight: bold">0.92</span>}
        }
    ]

    <span style="color: #008800; font-weight: bold">for</span> i, data <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">enumerate</span>(sample_data):
        sample_path <span style="color: #333333">=</span> input_dir <span style="color: #333333">/</span> <span style="background-color: #fff0f0">f"sample_</span><span style="background-color: #eeeeee">{</span>i<span style="color: #333333">+</span><span style="color: #0000DD; font-weight: bold">1</span><span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">.json"</span>
        writef_json(sample_path, data)

    <span style="color: #888888"># Process batch</span>
    results <span style="color: #333333">=</span> pipeline<span style="color: #333333">.</span>process_batch()

    <span style="color: #888888"># Validate output</span>
    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">custom_validator</span>(data: Dict[<span style="color: #007020">str</span>, Any]) <span style="color: #333333">-&gt;</span> <span style="color: #007020">bool</span>:
<span style="color: #bbbbbb">        </span><span style="color: #DD4422">"""Custom validation function."""</span>
        required_fields <span style="color: #333333">=</span> [<span style="background-color: #fff0f0">"timestamp"</span>, <span style="background-color: #fff0f0">"version"</span>, <span style="background-color: #fff0f0">"_processing_info"</span>]
        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #007020">all</span>(field <span style="color: #000000; font-weight: bold">in</span> data <span style="color: #008800; font-weight: bold">for</span> field <span style="color: #000000; font-weight: bold">in</span> required_fields)

    validation_results <span style="color: #333333">=</span> pipeline<span style="color: #333333">.</span>validate_output(custom_validator)

    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"</span><span style="color: #666666; font-weight: bold; background-color: #fff0f0">\n</span><span style="background-color: #fff0f0">Validation Results:"</span>)
    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"  Valid files: </span><span style="background-color: #eeeeee">{</span>validation_results[<span style="background-color: #fff0f0">'valid_files'</span>]<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"  Invalid files: </span><span style="background-color: #eeeeee">{</span>validation_results[<span style="background-color: #fff0f0">'invalid_files'</span>]<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

    <span style="color: #008800; font-weight: bold">if</span> validation_results[<span style="background-color: #fff0f0">"validation_errors"</span>]:
        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">"  Validation errors:"</span>)
        <span style="color: #008800; font-weight: bold">for</span> error <span style="color: #000000; font-weight: bold">in</span> validation_results[<span style="background-color: #fff0f0">"validation_errors"</span>]:
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"    </span><span style="background-color: #eeeeee">{</span>error[<span style="background-color: #fff0f0">'file'</span>]<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">: </span><span style="background-color: #eeeeee">{</span>error[<span style="background-color: #fff0f0">'error'</span>]<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

<span style="color: #008800; font-weight: bold">if</span> <span style="color: #996633">__name__</span> <span style="color: #333333">==</span> <span style="background-color: #fff0f0">"__main__"</span>:
    demonstrate_json_pipeline()
</code></pre></div></td></tr></table></div>
<h2 id="error-handling">Error Handling</h2>
<h3 id="exception-types">Exception Types</h3>
<p>The fileops module raises <code>StructuredError</code> for various error conditions:</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">14</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">15</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">rdetoolkit.exceptions</span> <span style="color: #008800; font-weight: bold">import</span> StructuredError
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">rdetoolkit.fileops</span> <span style="color: #008800; font-weight: bold">import</span> readf_json, writef_json

<span style="color: #888888"># Handle file reading errors</span>
<span style="color: #008800; font-weight: bold">try</span>:
    data <span style="color: #333333">=</span> readf_json(<span style="background-color: #fff0f0">"nonexistent.json"</span>)
<span style="color: #008800; font-weight: bold">except</span> StructuredError <span style="color: #008800; font-weight: bold">as</span> e:
    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Read error: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

<span style="color: #888888"># Handle file writing errors</span>
<span style="color: #008800; font-weight: bold">try</span>:
    <span style="color: #888888"># This might fail due to permissions, disk space, etc.</span>
    writef_json(<span style="background-color: #fff0f0">"/readonly/path/file.json"</span>, {<span style="background-color: #fff0f0">"test"</span>: <span style="background-color: #fff0f0">"data"</span>})
<span style="color: #008800; font-weight: bold">except</span> <span style="color: #FF0000; font-weight: bold">Exception</span> <span style="color: #008800; font-weight: bold">as</span> e:
    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Write error: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
</code></pre></div></td></tr></table></div>
<h3 id="common-error-scenarios">Common Error Scenarios</h3>
<ol>
<li>
<p><strong>File Not Found</strong>:
   <div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">safe_json_read</span>(path: <span style="color: #007020">str</span>) <span style="color: #333333">-&gt;</span> <span style="color: #007020">dict</span> <span style="color: #333333">|</span> <span style="color: #008800; font-weight: bold">None</span>:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Safely read JSON with file existence check."""</span>
    <span style="color: #008800; font-weight: bold">if</span> <span style="color: #000000; font-weight: bold">not</span> Path(path)<span style="color: #333333">.</span>exists():
        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"File not found: </span><span style="background-color: #eeeeee">{</span>path<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">None</span>

    <span style="color: #008800; font-weight: bold">try</span>:
        <span style="color: #008800; font-weight: bold">return</span> readf_json(path)
    <span style="color: #008800; font-weight: bold">except</span> StructuredError <span style="color: #008800; font-weight: bold">as</span> e:
        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Error reading </span><span style="background-color: #eeeeee">{</span>path<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">None</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Invalid JSON Format</strong>:
   <div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">9</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">validate_json_file</span>(path: <span style="color: #007020">str</span>) <span style="color: #333333">-&gt;</span> <span style="color: #007020">bool</span>:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Validate JSON file format."""</span>
    <span style="color: #008800; font-weight: bold">try</span>:
        readf_json(path)
        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">True</span>
    <span style="color: #008800; font-weight: bold">except</span> StructuredError <span style="color: #008800; font-weight: bold">as</span> e:
        <span style="color: #008800; font-weight: bold">if</span> <span style="background-color: #fff0f0">"JSON"</span> <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">str</span>(e)<span style="color: #333333">.</span>upper():
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Invalid JSON format in </span><span style="background-color: #eeeeee">{</span>path<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">False</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Encoding Issues</strong>:
   <div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">9</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">handle_encoding_issues</span>(path: <span style="color: #007020">str</span>) <span style="color: #333333">-&gt;</span> <span style="color: #007020">dict</span> <span style="color: #333333">|</span> <span style="color: #008800; font-weight: bold">None</span>:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Handle files with encoding issues."""</span>
    <span style="color: #008800; font-weight: bold">try</span>:
        <span style="color: #008800; font-weight: bold">return</span> readf_json(path)
    <span style="color: #008800; font-weight: bold">except</span> StructuredError <span style="color: #008800; font-weight: bold">as</span> e:
        <span style="color: #008800; font-weight: bold">if</span> <span style="background-color: #fff0f0">"encoding"</span> <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">str</span>(e)<span style="color: #333333">.</span>lower():
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Encoding issue in </span><span style="background-color: #eeeeee">{</span>path<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
            <span style="color: #888888"># Could implement fallback encoding detection</span>
        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">None</span>
</code></pre></div></td></tr></table></div></p>
</li>
</ol>
<h3 id="best-practices-for-error-handling">Best Practices for Error Handling</h3>
<ol>
<li>
<p><strong>Graceful Degradation</strong>:
   <div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">robust_config_loader</span>(config_paths: <span style="color: #007020">list</span>[<span style="color: #007020">str</span>]) <span style="color: #333333">-&gt;</span> <span style="color: #007020">dict</span>:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Load configuration with fallback options."""</span>
    <span style="color: #008800; font-weight: bold">for</span> path <span style="color: #000000; font-weight: bold">in</span> config_paths:
        <span style="color: #008800; font-weight: bold">try</span>:
            <span style="color: #008800; font-weight: bold">return</span> readf_json(path)
        <span style="color: #008800; font-weight: bold">except</span> StructuredError:
            <span style="color: #008800; font-weight: bold">continue</span>

    <span style="color: #888888"># Return default configuration</span>
    <span style="color: #008800; font-weight: bold">return</span> {<span style="background-color: #fff0f0">"default"</span>: <span style="color: #008800; font-weight: bold">True</span>}
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Batch Processing with Error Recovery</strong>:
   <div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">process_json_files_safely</span>(file_paths: <span style="color: #007020">list</span>[<span style="color: #007020">str</span>]) <span style="color: #333333">-&gt;</span> <span style="color: #007020">dict</span>:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Process multiple files with error recovery."""</span>
    results <span style="color: #333333">=</span> {<span style="background-color: #fff0f0">"successful"</span>: [], <span style="background-color: #fff0f0">"failed"</span>: []}

    <span style="color: #008800; font-weight: bold">for</span> path <span style="color: #000000; font-weight: bold">in</span> file_paths:
        <span style="color: #008800; font-weight: bold">try</span>:
            data <span style="color: #333333">=</span> readf_json(path)
            <span style="color: #888888"># Process data...</span>
            results[<span style="background-color: #fff0f0">"successful"</span>]<span style="color: #333333">.</span>append(path)
        <span style="color: #008800; font-weight: bold">except</span> StructuredError <span style="color: #008800; font-weight: bold">as</span> e:
            results[<span style="background-color: #fff0f0">"failed"</span>]<span style="color: #333333">.</span>append({<span style="background-color: #fff0f0">"path"</span>: path, <span style="background-color: #fff0f0">"error"</span>: <span style="color: #007020">str</span>(e)})

    <span style="color: #008800; font-weight: bold">return</span> results
</code></pre></div></td></tr></table></div></p>
</li>
</ol>
<h2 id="performance-notes">Performance Notes</h2>
<h3 id="optimization-features">Optimization Features</h3>
<ol>
<li><strong>Automatic Encoding Detection</strong>: Efficient encoding detection reduces read errors</li>
<li><strong>Streaming JSON</strong>: Uses standard library JSON for memory-efficient processing</li>
<li><strong>Error Caching</strong>: Logging integration helps identify recurring issues</li>
<li><strong>Path Object Support</strong>: Flexible input types reduce conversion overhead</li>
</ol>
<h3 id="performance-best-practices">Performance Best Practices</h3>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">14</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">15</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">16</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">17</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">18</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">19</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">20</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">21</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">22</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">23</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">24</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">25</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">26</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">27</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">28</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">29</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">30</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">31</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">32</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">33</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">34</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">35</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">36</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">37</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">38</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">39</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">40</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">41</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">42</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #888888"># Efficient batch processing</span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">process_large_json_files</span>(file_paths: <span style="color: #007020">list</span>[Path]) <span style="color: #333333">-&gt;</span> <span style="color: #008800; font-weight: bold">None</span>:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Process large JSON files efficiently."""</span>

    <span style="color: #008800; font-weight: bold">for</span> file_path <span style="color: #000000; font-weight: bold">in</span> file_paths:
        <span style="color: #008800; font-weight: bold">try</span>:
            <span style="color: #888888"># Read once</span>
            data <span style="color: #333333">=</span> readf_json(file_path)

            <span style="color: #888888"># Process in memory</span>
            processed <span style="color: #333333">=</span> transform_data(data)

            <span style="color: #888888"># Write once</span>
            output_path <span style="color: #333333">=</span> file_path<span style="color: #333333">.</span>parent <span style="color: #333333">/</span> <span style="background-color: #fff0f0">f"processed_</span><span style="background-color: #eeeeee">{</span>file_path<span style="color: #333333">.</span>name<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>
            writef_json(output_path, processed)

        <span style="color: #008800; font-weight: bold">except</span> StructuredError <span style="color: #008800; font-weight: bold">as</span> e:
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Skipping </span><span style="background-color: #eeeeee">{</span>file_path<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

<span style="color: #888888"># Memory-conscious processing for large files</span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">process_large_dataset</span>(input_path: Path, output_path: Path) <span style="color: #333333">-&gt;</span> <span style="color: #008800; font-weight: bold">None</span>:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Process large JSON datasets with memory management."""</span>

    <span style="color: #008800; font-weight: bold">try</span>:
        <span style="color: #888888"># For very large files, consider streaming JSON parsers</span>
        data <span style="color: #333333">=</span> readf_json(input_path)

        <span style="color: #888888"># Process in chunks if data is very large</span>
        <span style="color: #008800; font-weight: bold">if</span> <span style="color: #007020">isinstance</span>(data, <span style="color: #007020">dict</span>) <span style="color: #000000; font-weight: bold">and</span> <span style="color: #007020">len</span>(data) <span style="color: #333333">&gt;</span> <span style="color: #0000DD; font-weight: bold">10000</span>:
            <span style="color: #888888"># Process in smaller chunks</span>
            chunk_size <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1000</span>
            keys <span style="color: #333333">=</span> <span style="color: #007020">list</span>(data<span style="color: #333333">.</span>keys())

            <span style="color: #008800; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">range</span>(<span style="color: #0000DD; font-weight: bold">0</span>, <span style="color: #007020">len</span>(keys), chunk_size):
                chunk_keys <span style="color: #333333">=</span> keys[i:i <span style="color: #333333">+</span> chunk_size]
                chunk_data <span style="color: #333333">=</span> {k: data[k] <span style="color: #008800; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> chunk_keys}
                <span style="color: #888888"># Process chunk...</span>

        writef_json(output_path, data)

    <span style="color: #008800; font-weight: bold">except</span> StructuredError <span style="color: #008800; font-weight: bold">as</span> e:
        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Processing failed: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
</code></pre></div></td></tr></table></div>
<h2 id="integration-examples">Integration Examples</h2>
<h3 id="integration-with-other-rde-modules">Integration with Other RDE Modules</h3>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">14</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">15</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">16</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">17</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">18</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">19</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">20</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">21</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">22</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">23</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">24</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">25</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">26</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">27</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">28</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">29</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">30</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">31</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">32</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">33</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">34</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">35</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">36</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">37</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">38</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">39</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">rdetoolkit.fileops</span> <span style="color: #008800; font-weight: bold">import</span> readf_json, writef_json
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">rdetoolkit.validation</span> <span style="color: #008800; font-weight: bold">import</span> invoice_validate
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">rdetoolkit.rde2util</span> <span style="color: #008800; font-weight: bold">import</span> Meta
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">pathlib</span> <span style="color: #008800; font-weight: bold">import</span> Path

<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">integrated_processing_example</span>():
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Example of integrating fileops with other RDE modules."""</span>

    <span style="color: #888888"># Read invoice using fileops</span>
    invoice_path <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/invoice/invoice.json"</span>)
    invoice_data <span style="color: #333333">=</span> readf_json(invoice_path)

    <span style="color: #888888"># Validate using validation module</span>
    schema_path <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/tasksupport/invoice.schema.json"</span>)
    <span style="color: #008800; font-weight: bold">try</span>:
        invoice_validate(invoice_path, schema_path)
        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">"Invoice validation passed"</span>)
    <span style="color: #008800; font-weight: bold">except</span> <span style="color: #FF0000; font-weight: bold">Exception</span> <span style="color: #008800; font-weight: bold">as</span> e:
        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Invoice validation failed: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

    <span style="color: #888888"># Process metadata using rde2util</span>
    metadef_path <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/tasksupport/metadata-def.json"</span>)
    meta_output_path <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/meta/metadata.json"</span>)

    <span style="color: #008800; font-weight: bold">if</span> metadef_path<span style="color: #333333">.</span>exists():
        meta <span style="color: #333333">=</span> Meta(metadef_path)
        <span style="color: #888888"># Use fileops for reading additional data</span>
        metadata_input <span style="color: #333333">=</span> readf_json(<span style="background-color: #fff0f0">"data/input/metadata_input.json"</span>)
        meta<span style="color: #333333">.</span>assign_vals(metadata_input)
        meta<span style="color: #333333">.</span>writefile(<span style="color: #007020">str</span>(meta_output_path))

    <span style="color: #888888"># Save processed results using fileops</span>
    results <span style="color: #333333">=</span> {
        <span style="background-color: #fff0f0">"invoice_valid"</span>: <span style="color: #008800; font-weight: bold">True</span>,
        <span style="background-color: #fff0f0">"metadata_processed"</span>: <span style="color: #008800; font-weight: bold">True</span>,
        <span style="background-color: #fff0f0">"processing_timestamp"</span>: <span style="background-color: #fff0f0">"2024-01-01T00:00:00Z"</span>
    }

    writef_json(<span style="background-color: #fff0f0">"data/output/processing_results.json"</span>, results)
</code></pre></div></td></tr></table></div>
<h2 id="see-also">See Also</h2>
<ul>
<li><a href="../core/">Core Module</a> - For encoding detection and file handling utilities</li>
<li><a href="../validation/">Validation</a> - For JSON schema validation functionality</li>
<li><a href="../rde2util/">RDE2 Utilities</a> - For metadata processing utilities</li>
<li><a href="../invoicefile/">Invoice File</a> - For invoice-specific file operations</li>
<li><a href="../exceptions/">Exceptions</a> - For StructuredError and other exception types</li>
<li><a href="../rdelogger/">RDE Logger</a> - For logging functionality used in fileops</li>
<li><a href="../../usage/structured_process/structured/">Usage - Structured Process</a> - For file operations in workflows</li>
<li><a href="../../usage/config/config/">Usage - Configuration</a> - For configuration file handling</li>
</ul>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://github.com/nims-dpfc/rdetoolkit" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<div class="md-consent" data-md-component="consent" hidden="" id="__consent">
<div class="md-consent__overlay"></div>
<aside class="md-consent__inner">
<form class="md-consent__form md-grid md-typeset" name="consent">
<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" id="__settings" type="checkbox"/>
<div class="md-consent__settings">
<ul class="task-list">
<li class="task-list-item">
<label class="task-list-control">
<input checked="" name="github" type="checkbox"/>
<span class="task-list-indicator"></span>
          GitHub
        </label>
</li>
</ul>
</div>
<div class="md-consent__controls">
<button class="md-button md-button--primary">Accept</button>
<label class="md-button" for="__settings">Manage settings</label>
</div>
</form>
</aside>
</div>
<script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
<script id="__config" type="application/json">{"base": "../..", "features": ["navigation.top", "navigation.tabs", "navigation.tabs.sticky"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../assets/javascripts/bundle.d6f25eb3.min.js"></script>
<script src="https://unpkg.com/mermaid@10.9.0/dist/mermaid.min.js"></script>
</body>
</html>