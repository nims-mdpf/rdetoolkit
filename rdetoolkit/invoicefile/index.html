
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../rde2util/" rel="prev"/>
<link href="../modeproc/" rel="next"/>
<link href="../../img/2585322.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.5.38" name="generator"/>
<title>Invoice File Module - RDEToolKit Documentation</title>
<link href="../../assets/stylesheets/main.8c3ca2c6.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Noto+Sans+JP:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Noto Sans JP";--md-code-font:"Roboto Mono"}</style>
<link href="../../assets/_mkdocstrings.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#invoice-file-module">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="RDEToolKit Documentation" class="md-header__button md-logo" data-md-component="logo" href="../.." title="RDEToolKit Documentation">
<img alt="logo" src="../../img/2585322.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            RDEToolKit Documentation
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Invoice File Module
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="" data-md-color-primary="indigo" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/nims-dpfc/rdetoolkit" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    nims-dpfc/rdetoolkit
  </div>
</a>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
          
  
  Getting started

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../install/">
          
  
  Installation

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../usage/quickstart/">
          
  
  User Guide

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../">
          
  
  API Documentation

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../contribute/home/">
          
  
  Development

        </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="RDEToolKit Documentation" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="RDEToolKit Documentation">
<img alt="logo" src="../../img/2585322.png"/>
</a>
    RDEToolKit Documentation
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/nims-dpfc/rdetoolkit" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    nims-dpfc/rdetoolkit
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
<span class="md-ellipsis">
    Getting started
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    RDEToolKit
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    Installation
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Installation
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../install/">
<span class="md-ellipsis">
    インストール方法
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    User Guide
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
<span class="md-ellipsis">
    Quick Start
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_1">
<span class="md-nav__icon md-icon"></span>
            Quick Start
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/quickstart/">
<span class="md-ellipsis">
    クイックスタート
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
<span class="md-ellipsis">
    構造化処理
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_2">
<span class="md-nav__icon md-icon"></span>
            構造化処理
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/structured_process/structured/">
<span class="md-ellipsis">
    構造化処理を構築する
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/structured_process/directory/">
<span class="md-ellipsis">
    サポートするディレクトリ
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/structured_process/rdepath/">
<span class="md-ellipsis">
    構造化ディレクトリパスの取得
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/structured_process/errorhandling/">
<span class="md-ellipsis">
    構造化処理のエラーハンドリング
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/structured_process/feature_description/">
<span class="md-ellipsis">
    データタイル説明欄への自動記述について
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
<span class="md-ellipsis">
    コマンドライン機能
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_3">
<span class="md-nav__icon md-icon"></span>
            コマンドライン機能
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/cli/">
<span class="md-ellipsis">
    コマンドライン機能について
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
<span class="md-ellipsis">
    設定ファイル
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_4">
<span class="md-nav__icon md-icon"></span>
            設定ファイル
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/config/config/">
<span class="md-ellipsis">
    RDEToolKit設定ファイル
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/config/mode/">
<span class="md-ellipsis">
    RDEToolKitのデータ登録モード
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/config/file_folder_mode/">
<span class="md-ellipsis">
    圧縮ファイルの形式について
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/config/magic_variable/">
<span class="md-ellipsis">
    Magic Variableによるデータ登録について
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
<span class="md-ellipsis">
    テンプレートファイル
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_5">
<span class="md-nav__icon md-icon"></span>
            テンプレートファイル
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/metadata_definition_file/">
<span class="md-ellipsis">
    テンプレートファイル
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
<span class="md-ellipsis">
    バリデーション
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_6">
<span class="md-nav__icon md-icon"></span>
            バリデーション
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/validation/">
<span class="md-ellipsis">
    バリデーション機能
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
<span class="md-ellipsis">
    オブジェクトストレージを使用する
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_7_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_7">
<span class="md-nav__icon md-icon"></span>
            オブジェクトストレージを使用する
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/object_storage/">
<span class="md-ellipsis">
    rdetolkitでオブジェクトストレージ(MinIO)を利用する方法
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_8" id="__nav_3_8_label" tabindex="0">
<span class="md-ellipsis">
    Docker
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_8_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_8">
<span class="md-nav__icon md-icon"></span>
            Docker
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/docker/">
<span class="md-ellipsis">
    Using RDEToolKit with Docker
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
<span class="md-ellipsis">
    API Documentation
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            API Documentation
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../">
<span class="md-ellipsis">
    RDE Toolkit API Documentation
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
<span class="md-ellipsis">
    impl
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_2">
<span class="md-nav__icon md-icon"></span>
            impl
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../impl/compressed_controller/">
<span class="md-ellipsis">
    Compressed Controller Module
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../impl/input_controller/">
<span class="md-ellipsis">
    Input Controller Module
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
<span class="md-ellipsis">
    interface
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_3">
<span class="md-nav__icon md-icon"></span>
            interface
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../interface/filechecker/">
<span class="md-ellipsis">
    File Checker Interfaces Module
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
<span class="md-ellipsis">
    models
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_4">
<span class="md-nav__icon md-icon"></span>
            models
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../models/invoice_schema/">
<span class="md-ellipsis">
    Invoice Schema Module
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../models/metadata/">
<span class="md-ellipsis">
    Metadata Module
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../models/rde2types/">
<span class="md-ellipsis">
    RDE2 Types Module
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
<span class="md-ellipsis">
    storage
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_5">
<span class="md-nav__icon md-icon"></span>
            storage
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../storage/minio/">
<span class="md-ellipsis">
    MinIO Storage
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
<span class="md-ellipsis">
    core module
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_6">
<span class="md-nav__icon md-icon"></span>
            core module
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../core/">
<span class="md-ellipsis">
    Core Module
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../config/">
<span class="md-ellipsis">
    Configuration Module
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../workflows/">
<span class="md-ellipsis">
    Workflows Module
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../rde2util/">
<span class="md-ellipsis">
    rde2util Module
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Invoice File Module
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Invoice File Module
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#overview">
<span class="md-ellipsis">
      Overview
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#classes">
<span class="md-ellipsis">
      Classes
    </span>
</a>
<nav aria-label="Classes" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#invoicefile">
<span class="md-ellipsis">
      InvoiceFile
    </span>
</a>
<nav aria-label="InvoiceFile" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#constructor">
<span class="md-ellipsis">
      Constructor
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#methods">
<span class="md-ellipsis">
      Methods
    </span>
</a>
<nav aria-label="Methods" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#read">
<span class="md-ellipsis">
      read
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#overwrite">
<span class="md-ellipsis">
      overwrite
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#copy_original_invoice">
<span class="md-ellipsis">
      copy_original_invoice
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#excelinvoicefile">
<span class="md-ellipsis">
      ExcelInvoiceFile
    </span>
</a>
<nav aria-label="ExcelInvoiceFile" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#constructor_1">
<span class="md-ellipsis">
      Constructor
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#methods_1">
<span class="md-ellipsis">
      Methods
    </span>
</a>
<nav aria-label="Methods" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#read_1">
<span class="md-ellipsis">
      read
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#generate_template">
<span class="md-ellipsis">
      generate_template
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#overwrite_1">
<span class="md-ellipsis">
      overwrite
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#save">
<span class="md-ellipsis">
      save
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#check_intermittent_empty_rows">
<span class="md-ellipsis">
      check_intermittent_empty_rows
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#excelinvoicetemplategenerator">
<span class="md-ellipsis">
      ExcelInvoiceTemplateGenerator
    </span>
</a>
<nav aria-label="ExcelInvoiceTemplateGenerator" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#constructor_2">
<span class="md-ellipsis">
      Constructor
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#methods_2">
<span class="md-ellipsis">
      Methods
    </span>
</a>
<nav aria-label="Methods" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#generate">
<span class="md-ellipsis">
      generate
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#save_1">
<span class="md-ellipsis">
      save
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#rulebasedreplacer">
<span class="md-ellipsis">
      RuleBasedReplacer
    </span>
</a>
<nav aria-label="RuleBasedReplacer" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#constructor_3">
<span class="md-ellipsis">
      Constructor
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#methods_3">
<span class="md-ellipsis">
      Methods
    </span>
</a>
<nav aria-label="Methods" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#load_rules">
<span class="md-ellipsis">
      load_rules
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#set_rule">
<span class="md-ellipsis">
      set_rule
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#get_apply_rules_obj">
<span class="md-ellipsis">
      get_apply_rules_obj
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#write_rule">
<span class="md-ellipsis">
      write_rule
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#smarttablefile">
<span class="md-ellipsis">
      SmartTableFile
    </span>
</a>
<nav aria-label="SmartTableFile" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#constructor_4">
<span class="md-ellipsis">
      Constructor
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#methods_4">
<span class="md-ellipsis">
      Methods
    </span>
</a>
<nav aria-label="Methods" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#read_table">
<span class="md-ellipsis">
      read_table
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#generate_row_csvs_with_file_mapping">
<span class="md-ellipsis">
      generate_row_csvs_with_file_mapping
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#functions">
<span class="md-ellipsis">
      Functions
    </span>
</a>
<nav aria-label="Functions" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#read_excelinvoice">
<span class="md-ellipsis">
      read_excelinvoice
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#check_exist_rawfiles">
<span class="md-ellipsis">
      check_exist_rawfiles
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#backup_invoice_json_files">
<span class="md-ellipsis">
      backup_invoice_json_files
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#update_description_with_features">
<span class="md-ellipsis">
      update_description_with_features
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#apply_magic_variable">
<span class="md-ellipsis">
      apply_magic_variable
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#apply_default_filename_mapping_rule">
<span class="md-ellipsis">
      apply_default_filename_mapping_rule
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#complete-usage-examples">
<span class="md-ellipsis">
      Complete Usage Examples
    </span>
</a>
<nav aria-label="Complete Usage Examples" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#comprehensive-excel-invoice-processing-pipeline">
<span class="md-ellipsis">
      Comprehensive Excel Invoice Processing Pipeline
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#smarttable-processing-with-file-mapping">
<span class="md-ellipsis">
      SmartTable Processing with File Mapping
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#error-handling">
<span class="md-ellipsis">
      Error Handling
    </span>
</a>
<nav aria-label="Error Handling" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#exception-types">
<span class="md-ellipsis">
      Exception Types
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#best-practices-for-error-handling">
<span class="md-ellipsis">
      Best Practices for Error Handling
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#performance-notes">
<span class="md-ellipsis">
      Performance Notes
    </span>
</a>
<nav aria-label="Performance Notes" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#optimization-strategies">
<span class="md-ellipsis">
      Optimization Strategies
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#performance-best-practices">
<span class="md-ellipsis">
      Performance Best Practices
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#see-also">
<span class="md-ellipsis">
      See Also
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../modeproc/">
<span class="md-ellipsis">
    Mode Processing Module
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../validation/">
<span class="md-ellipsis">
    Validation Module
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../img2thumb/">
<span class="md-ellipsis">
    Image to Thumbnail Module
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../rdelogger/">
<span class="md-ellipsis">
    RDE Logger Module
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../exceptions/">
<span class="md-ellipsis">
    Exceptions Module
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    Development
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            Development
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../contribute/home/">
<span class="md-ellipsis">
    Top
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../contribute/documents_contributing/">
<span class="md-ellipsis">
    Documents
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../contribute/sourcecode_contributing/">
<span class="md-ellipsis">
    Source Code
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#overview">
<span class="md-ellipsis">
      Overview
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#classes">
<span class="md-ellipsis">
      Classes
    </span>
</a>
<nav aria-label="Classes" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#invoicefile">
<span class="md-ellipsis">
      InvoiceFile
    </span>
</a>
<nav aria-label="InvoiceFile" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#constructor">
<span class="md-ellipsis">
      Constructor
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#methods">
<span class="md-ellipsis">
      Methods
    </span>
</a>
<nav aria-label="Methods" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#read">
<span class="md-ellipsis">
      read
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#overwrite">
<span class="md-ellipsis">
      overwrite
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#copy_original_invoice">
<span class="md-ellipsis">
      copy_original_invoice
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#excelinvoicefile">
<span class="md-ellipsis">
      ExcelInvoiceFile
    </span>
</a>
<nav aria-label="ExcelInvoiceFile" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#constructor_1">
<span class="md-ellipsis">
      Constructor
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#methods_1">
<span class="md-ellipsis">
      Methods
    </span>
</a>
<nav aria-label="Methods" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#read_1">
<span class="md-ellipsis">
      read
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#generate_template">
<span class="md-ellipsis">
      generate_template
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#overwrite_1">
<span class="md-ellipsis">
      overwrite
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#save">
<span class="md-ellipsis">
      save
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#check_intermittent_empty_rows">
<span class="md-ellipsis">
      check_intermittent_empty_rows
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#excelinvoicetemplategenerator">
<span class="md-ellipsis">
      ExcelInvoiceTemplateGenerator
    </span>
</a>
<nav aria-label="ExcelInvoiceTemplateGenerator" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#constructor_2">
<span class="md-ellipsis">
      Constructor
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#methods_2">
<span class="md-ellipsis">
      Methods
    </span>
</a>
<nav aria-label="Methods" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#generate">
<span class="md-ellipsis">
      generate
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#save_1">
<span class="md-ellipsis">
      save
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#rulebasedreplacer">
<span class="md-ellipsis">
      RuleBasedReplacer
    </span>
</a>
<nav aria-label="RuleBasedReplacer" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#constructor_3">
<span class="md-ellipsis">
      Constructor
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#methods_3">
<span class="md-ellipsis">
      Methods
    </span>
</a>
<nav aria-label="Methods" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#load_rules">
<span class="md-ellipsis">
      load_rules
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#set_rule">
<span class="md-ellipsis">
      set_rule
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#get_apply_rules_obj">
<span class="md-ellipsis">
      get_apply_rules_obj
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#write_rule">
<span class="md-ellipsis">
      write_rule
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#smarttablefile">
<span class="md-ellipsis">
      SmartTableFile
    </span>
</a>
<nav aria-label="SmartTableFile" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#constructor_4">
<span class="md-ellipsis">
      Constructor
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#methods_4">
<span class="md-ellipsis">
      Methods
    </span>
</a>
<nav aria-label="Methods" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#read_table">
<span class="md-ellipsis">
      read_table
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#generate_row_csvs_with_file_mapping">
<span class="md-ellipsis">
      generate_row_csvs_with_file_mapping
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#functions">
<span class="md-ellipsis">
      Functions
    </span>
</a>
<nav aria-label="Functions" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#read_excelinvoice">
<span class="md-ellipsis">
      read_excelinvoice
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#check_exist_rawfiles">
<span class="md-ellipsis">
      check_exist_rawfiles
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#backup_invoice_json_files">
<span class="md-ellipsis">
      backup_invoice_json_files
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#update_description_with_features">
<span class="md-ellipsis">
      update_description_with_features
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#apply_magic_variable">
<span class="md-ellipsis">
      apply_magic_variable
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#apply_default_filename_mapping_rule">
<span class="md-ellipsis">
      apply_default_filename_mapping_rule
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#complete-usage-examples">
<span class="md-ellipsis">
      Complete Usage Examples
    </span>
</a>
<nav aria-label="Complete Usage Examples" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#comprehensive-excel-invoice-processing-pipeline">
<span class="md-ellipsis">
      Comprehensive Excel Invoice Processing Pipeline
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#smarttable-processing-with-file-mapping">
<span class="md-ellipsis">
      SmartTable Processing with File Mapping
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#error-handling">
<span class="md-ellipsis">
      Error Handling
    </span>
</a>
<nav aria-label="Error Handling" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#exception-types">
<span class="md-ellipsis">
      Exception Types
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#best-practices-for-error-handling">
<span class="md-ellipsis">
      Best Practices for Error Handling
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#performance-notes">
<span class="md-ellipsis">
      Performance Notes
    </span>
</a>
<nav aria-label="Performance Notes" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#optimization-strategies">
<span class="md-ellipsis">
      Optimization Strategies
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#performance-best-practices">
<span class="md-ellipsis">
      Performance Best Practices
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#see-also">
<span class="md-ellipsis">
      See Also
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="invoice-file-module">Invoice File Module</h1>
<p>The <code>rdetoolkit.invoicefile</code> module provides comprehensive functionality for handling various types of invoice files in RDE (Research Data Exchange) processing workflows. This module supports standard JSON invoices, Excel-based invoices, template generation, and advanced file processing with rule-based transformations.</p>
<h2 id="overview">Overview</h2>
<p>The invoicefile module offers extensive capabilities for invoice processing:</p>
<ul>
<li><strong>Invoice File Management</strong>: Reading, writing, and manipulation of JSON-based invoice files</li>
<li><strong>Excel Invoice Processing</strong>: Specialized handling of Excel-based invoice files with multiple sheets</li>
<li><strong>Template Generation</strong>: Automated creation of Excel invoice templates based on schemas</li>
<li><strong>SmartTable Integration</strong>: Processing of SmartTable files for automated invoice generation</li>
<li><strong>Rule-Based Replacement</strong>: Flexible file naming and content transformation rules</li>
<li><strong>Magic Variable Processing</strong>: Dynamic variable substitution in invoice content</li>
<li><strong>Backup and Recovery</strong>: Automated backup of invoice files during processing</li>
<li><strong>Validation and Error Handling</strong>: Comprehensive validation with detailed error reporting</li>
</ul>
<h2 id="classes">Classes</h2>
<h3 id="invoicefile">InvoiceFile</h3>
<p>A class representing standard JSON invoice files with utilities for reading and writing.</p>
<h4 id="constructor">Constructor</h4>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code>InvoiceFile(invoice_path: Path)
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>invoice_path</code> (Path): Path to the invoice JSON file</p>
<p><strong>Attributes:</strong>
- <code>invoice_path</code> (Path): Path to the invoice file
- <code>invoice_obj</code> (dict[str, Any]): Dictionary representation of the invoice JSON</p>
<h4 id="methods">Methods</h4>
<h5 id="read">read</h5>
<p>Read the content of the invoice file and return as a dictionary.</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">read</span>(<span style="color: #007020">self</span>, <span style="color: #333333">*</span>, target_path: Path <span style="color: #333333">|</span> <span style="color: #008800; font-weight: bold">None</span> <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">None</span>) <span style="color: #333333">-&gt;</span> <span style="color: #007020">dict</span>
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>target_path</code> (Path | None): Alternative path to read from (optional)</p>
<p><strong>Returns:</strong>
- <code>dict</code>: Dictionary representation of the invoice JSON file</p>
<h5 id="overwrite">overwrite</h5>
<p>Overwrite the contents of the destination file with invoice JSON data.</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">overwrite</span>(<span style="color: #007020">self</span>, dst_file_path: Path, <span style="color: #333333">*</span>, src_obj: Path <span style="color: #333333">|</span> <span style="color: #008800; font-weight: bold">None</span> <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">None</span>) <span style="color: #333333">-&gt;</span> <span style="color: #008800; font-weight: bold">None</span>
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>dst_file_path</code> (Path): Destination file path
- <code>src_obj</code> (Path | None): Source object path (optional)</p>
<p><strong>Returns:</strong>
- <code>None</code></p>
<p><strong>Raises:</strong>
- <code>StructuredError</code>: If the destination file cannot be created</p>
<h5 id="copy_original_invoice">copy_original_invoice</h5>
<p>Copy the original invoice file from source to destination.</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #555555; font-weight: bold">@classmethod</span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">copy_original_invoice</span>(<span style="color: #007020">cls</span>, src_file_path: Path, dst_file_path: Path) <span style="color: #333333">-&gt;</span> <span style="color: #008800; font-weight: bold">None</span>
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>src_file_path</code> (Path): Source file path
- <code>dst_file_path</code> (Path): Destination file path</p>
<p><strong>Raises:</strong>
- <code>StructuredError</code>: If the source file does not exist</p>
<p><strong>Example:</strong></p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">14</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">15</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">16</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">17</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">18</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">19</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">20</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">21</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">22</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">23</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">rdetoolkit.invoicefile</span> <span style="color: #008800; font-weight: bold">import</span> InvoiceFile
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">pathlib</span> <span style="color: #008800; font-weight: bold">import</span> Path

<span style="color: #888888"># Create and manipulate invoice file</span>
invoice_path <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/invoice/invoice.json"</span>)
invoice <span style="color: #333333">=</span> InvoiceFile(invoice_path)

<span style="color: #888888"># Access and modify invoice data</span>
<span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Original data name: </span><span style="background-color: #eeeeee">{</span>invoice<span style="color: #333333">.</span>invoice_obj[<span style="background-color: #fff0f0">'basic'</span>][<span style="background-color: #fff0f0">'dataName'</span>]<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
invoice<span style="color: #333333">.</span>invoice_obj[<span style="background-color: #fff0f0">"basic"</span>][<span style="background-color: #fff0f0">"dataName"</span>] <span style="color: #333333">=</span> <span style="background-color: #fff0f0">"Updated Dataset Name"</span>
invoice<span style="color: #333333">.</span>invoice_obj[<span style="background-color: #fff0f0">"basic"</span>][<span style="background-color: #fff0f0">"description"</span>] <span style="color: #333333">=</span> <span style="background-color: #fff0f0">"Updated description"</span>

<span style="color: #888888"># Save changes</span>
output_path <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/invoice/invoice_updated.json"</span>)
invoice<span style="color: #333333">.</span>overwrite(output_path)

<span style="color: #888888"># Copy original invoice</span>
backup_path <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/backup/invoice_backup.json"</span>)
InvoiceFile<span style="color: #333333">.</span>copy_original_invoice(invoice_path, backup_path)

<span style="color: #888888"># Read from different file</span>
invoice<span style="color: #333333">.</span>read(target_path<span style="color: #333333">=</span>backup_path)
<span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Backup data name: </span><span style="background-color: #eeeeee">{</span>invoice<span style="color: #333333">.</span>invoice_obj[<span style="background-color: #fff0f0">'basic'</span>][<span style="background-color: #fff0f0">'dataName'</span>]<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
</code></pre></div></td></tr></table></div>
<h3 id="excelinvoicefile">ExcelInvoiceFile</h3>
<p>A comprehensive class for handling Excel-based invoice files with multiple sheets.</p>
<h4 id="constructor_1">Constructor</h4>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code>ExcelInvoiceFile(invoice_path: Path)
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>invoice_path</code> (Path): Path to the Excel invoice file (.xlsx)</p>
<p><strong>Attributes:</strong>
- <code>invoice_path</code> (Path): Path to the Excel invoice file
- <code>dfexcelinvoice</code> (pd.DataFrame): DataFrame of the invoice data
- <code>df_general</code> (pd.DataFrame): DataFrame of general terms
- <code>df_specific</code> (pd.DataFrame): DataFrame of specific terms
- <code>template_generator</code> (ExcelInvoiceTemplateGenerator): Template generator instance</p>
<h4 id="methods_1">Methods</h4>
<h5 id="read_1">read</h5>
<p>Read the Excel invoice file and return three DataFrames.</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">read</span>(<span style="color: #007020">self</span>, <span style="color: #333333">*</span>, target_path: Path <span style="color: #333333">|</span> <span style="color: #008800; font-weight: bold">None</span> <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">None</span>) <span style="color: #333333">-&gt;</span> <span style="color: #007020">tuple</span>[pd<span style="color: #333333">.</span>DataFrame, pd<span style="color: #333333">.</span>DataFrame, pd<span style="color: #333333">.</span>DataFrame]
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>target_path</code> (Path | None): Path to the Excel invoice file (optional)</p>
<p><strong>Returns:</strong>
- <code>tuple[pd.DataFrame, pd.DataFrame, pd.DataFrame]</code>: Invoice, general terms, and specific terms DataFrames</p>
<p><strong>Raises:</strong>
- <code>StructuredError</code>: If file not found or multiple/no invoice sheets exist</p>
<h5 id="generate_template">generate_template</h5>
<p>Generate Excel invoice template based on schema.</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">7</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #555555; font-weight: bold">@classmethod</span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">generate_template</span>(
    <span style="color: #007020">cls</span>,
    invoice_schema_path: <span style="color: #007020">str</span> <span style="color: #333333">|</span> Path,
    save_path: <span style="color: #007020">str</span> <span style="color: #333333">|</span> Path,
    file_mode: Literal[<span style="background-color: #fff0f0">"file"</span>, <span style="background-color: #fff0f0">"folder"</span>] <span style="color: #333333">=</span> <span style="background-color: #fff0f0">"file"</span>
) <span style="color: #333333">-&gt;</span> <span style="color: #007020">tuple</span>[pd<span style="color: #333333">.</span>DataFrame, pd<span style="color: #333333">.</span>DataFrame, pd<span style="color: #333333">.</span>DataFrame]
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>invoice_schema_path</code> (str | Path): Path to invoice schema file
- <code>save_path</code> (str | Path): Path to save the generated template
- <code>file_mode</code> (Literal["file", "folder"]): Input mode specification</p>
<p><strong>Returns:</strong>
- <code>tuple[pd.DataFrame, pd.DataFrame, pd.DataFrame]</code>: Template, general terms, and specific terms DataFrames</p>
<h5 id="overwrite_1">overwrite</h5>
<p>Overwrite original invoice file based on Excel invoice data.</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">overwrite</span>(<span style="color: #007020">self</span>, invoice_org: Path, dist_path: Path, invoice_schema_path: Path, idx: <span style="color: #007020">int</span>) <span style="color: #333333">-&gt;</span> <span style="color: #008800; font-weight: bold">None</span>
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>invoice_org</code> (Path): Path to original invoice file
- <code>dist_path</code> (Path): Path for output invoice file
- <code>invoice_schema_path</code> (Path): Path to invoice schema
- <code>idx</code> (int): Row index in the invoice DataFrame</p>
<h5 id="save">save</h5>
<p>Save the invoice DataFrame to an Excel file.</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">9</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">save</span>(
    <span style="color: #007020">self</span>,
    save_path: <span style="color: #007020">str</span> <span style="color: #333333">|</span> Path,
    <span style="color: #333333">*</span>,
    invoice: pd<span style="color: #333333">.</span>DataFrame <span style="color: #333333">|</span> <span style="color: #008800; font-weight: bold">None</span> <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">None</span>,
    sheet_name: <span style="color: #007020">str</span> <span style="color: #333333">=</span> <span style="background-color: #fff0f0">"invoice_form"</span>,
    index: <span style="color: #007020">list</span>[<span style="color: #007020">str</span>] <span style="color: #333333">|</span> <span style="color: #008800; font-weight: bold">None</span> <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">None</span>,
    header: <span style="color: #007020">list</span>[<span style="color: #007020">str</span>] <span style="color: #333333">|</span> <span style="color: #008800; font-weight: bold">None</span> <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">None</span>
) <span style="color: #333333">-&gt;</span> <span style="color: #008800; font-weight: bold">None</span>
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>save_path</code> (str | Path): Path to save the Excel file
- <code>invoice</code> (pd.DataFrame | None): DataFrame to save (optional)
- <code>sheet_name</code> (str): Sheet name in Excel file
- <code>index</code> (list[str] | None): Index labels (optional)
- <code>header</code> (list[str] | None): Column headers (optional)</p>
<h5 id="check_intermittent_empty_rows">check_intermittent_empty_rows</h5>
<p>Detect empty rows between data rows in Excel invoice.</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #555555; font-weight: bold">@staticmethod</span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">check_intermittent_empty_rows</span>(df: pd<span style="color: #333333">.</span>DataFrame) <span style="color: #333333">-&gt;</span> <span style="color: #008800; font-weight: bold">None</span>
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>df</code> (pd.DataFrame): DataFrame to check</p>
<p><strong>Raises:</strong>
- <code>StructuredError</code>: If empty rows exist between data rows</p>
<p><strong>Example:</strong></p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">14</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">15</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">16</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">17</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">18</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">19</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">20</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">21</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">22</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">23</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">24</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">25</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">26</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">27</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">28</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">29</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">30</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">31</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">32</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">33</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">34</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">35</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">36</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">37</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">38</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">39</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">40</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">41</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">42</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">43</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">44</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">45</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">rdetoolkit.invoicefile</span> <span style="color: #008800; font-weight: bold">import</span> ExcelInvoiceFile
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">pathlib</span> <span style="color: #008800; font-weight: bold">import</span> Path
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">pandas</span> <span style="color: #008800; font-weight: bold">as</span> <span style="color: #0e84b5; font-weight: bold">pd</span>

<span style="color: #888888"># Read Excel invoice</span>
excel_path <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/input/sample_excel_invoice.xlsx"</span>)
excel_invoice <span style="color: #333333">=</span> ExcelInvoiceFile(excel_path)

<span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Invoice data shape: </span><span style="background-color: #eeeeee">{</span>excel_invoice<span style="color: #333333">.</span>dfexcelinvoice<span style="color: #333333">.</span>shape<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
<span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"General terms: </span><span style="background-color: #eeeeee">{</span><span style="color: #007020">len</span>(excel_invoice<span style="color: #333333">.</span>df_general)<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
<span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Specific terms: </span><span style="background-color: #eeeeee">{</span><span style="color: #007020">len</span>(excel_invoice<span style="color: #333333">.</span>df_specific)<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

<span style="color: #888888"># Generate template</span>
schema_path <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/tasksupport/invoice.schema.json"</span>)
template_path <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/templates/new_template.xlsx"</span>)

template_df, general_df, specific_df <span style="color: #333333">=</span> ExcelInvoiceFile<span style="color: #333333">.</span>generate_template(
    invoice_schema_path<span style="color: #333333">=</span>schema_path,
    save_path<span style="color: #333333">=</span>template_path,
    file_mode<span style="color: #333333">=</span><span style="background-color: #fff0f0">"file"</span>
)

<span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Generated template with </span><span style="background-color: #eeeeee">{</span>template_df<span style="color: #333333">.</span>shape[<span style="color: #0000DD; font-weight: bold">1</span>]<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0"> columns"</span>)

<span style="color: #888888"># Process Excel invoice data</span>
original_invoice <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/invoice/invoice.json"</span>)
output_invoice <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/processed/invoice_processed.json"</span>)

<span style="color: #888888"># Process each row in the Excel invoice</span>
<span style="color: #008800; font-weight: bold">for</span> idx <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">range</span>(<span style="color: #007020">len</span>(excel_invoice<span style="color: #333333">.</span>dfexcelinvoice)):
    row_output <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">f"data/processed/invoice_</span><span style="background-color: #eeeeee">{</span>idx<span style="background-color: #eeeeee">:</span><span style="background-color: #fff0f0">04d</span><span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">.json"</span>)
    excel_invoice<span style="color: #333333">.</span>overwrite(
        invoice_org<span style="color: #333333">=</span>original_invoice,
        dist_path<span style="color: #333333">=</span>row_output,
        invoice_schema_path<span style="color: #333333">=</span>schema_path,
        idx<span style="color: #333333">=</span>idx
    )
    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Processed row </span><span style="background-color: #eeeeee">{</span>idx<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0"> -&gt; </span><span style="background-color: #eeeeee">{</span>row_output<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

<span style="color: #888888"># Save modified invoice data</span>
modified_path <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/output/modified_invoice.xlsx"</span>)
excel_invoice<span style="color: #333333">.</span>save(
    save_path<span style="color: #333333">=</span>modified_path,
    sheet_name<span style="color: #333333">=</span><span style="background-color: #fff0f0">"processed_invoice"</span>
)
</code></pre></div></td></tr></table></div>
<h3 id="excelinvoicetemplategenerator">ExcelInvoiceTemplateGenerator</h3>
<p>A specialized class for generating Excel invoice templates with proper formatting.</p>
<h4 id="constructor_2">Constructor</h4>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code>ExcelInvoiceTemplateGenerator(fixed_header: FixedHeaders)
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>fixed_header</code> (FixedHeaders): Fixed header configuration</p>
<h4 id="methods_2">Methods</h4>
<h5 id="generate">generate</h5>
<p>Generate template based on configuration.</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">generate</span>(<span style="color: #007020">self</span>, config: TemplateConfig) <span style="color: #333333">-&gt;</span> <span style="color: #007020">tuple</span>[pd<span style="color: #333333">.</span>DataFrame, pd<span style="color: #333333">.</span>DataFrame, pd<span style="color: #333333">.</span>DataFrame, pd<span style="color: #333333">.</span>DataFrame]
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>config</code> (TemplateConfig): Template configuration</p>
<p><strong>Returns:</strong>
- <code>tuple[pd.DataFrame, pd.DataFrame, pd.DataFrame, pd.DataFrame]</code>: Template, general terms, specific terms, and version DataFrames</p>
<h5 id="save_1">save</h5>
<p>Save DataFrames to Excel file with formatting.</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">save</span>(<span style="color: #007020">self</span>, dataframes: <span style="color: #007020">dict</span>[<span style="color: #007020">str</span>, pd<span style="color: #333333">.</span>DataFrame], save_path: <span style="color: #007020">str</span>) <span style="color: #333333">-&gt;</span> <span style="color: #008800; font-weight: bold">None</span>
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>dataframes</code> (dict[str, pd.DataFrame]): DataFrames to save
- <code>save_path</code> (str): Output file path</p>
<p><strong>Example:</strong></p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">14</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">15</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">16</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">17</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">18</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">19</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">20</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">21</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">22</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">23</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">24</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">25</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">26</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">27</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">28</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">29</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">30</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">31</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">32</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">33</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">rdetoolkit.invoicefile</span> <span style="color: #008800; font-weight: bold">import</span> ExcelInvoiceTemplateGenerator, FixedHeaders
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">rdetoolkit.models.invoice</span> <span style="color: #008800; font-weight: bold">import</span> TemplateConfig
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">pathlib</span> <span style="color: #008800; font-weight: bold">import</span> Path

<span style="color: #888888"># Create template generator</span>
fixed_headers <span style="color: #333333">=</span> FixedHeaders()
generator <span style="color: #333333">=</span> ExcelInvoiceTemplateGenerator(fixed_headers)

<span style="color: #888888"># Setup configuration</span>
config <span style="color: #333333">=</span> TemplateConfig(
    schema_path<span style="color: #333333">=</span>Path(<span style="background-color: #fff0f0">"data/tasksupport/invoice.schema.json"</span>),
    general_term_path<span style="color: #333333">=</span>Path(<span style="background-color: #fff0f0">"data/terms/general_terms.csv"</span>),
    specific_term_path<span style="color: #333333">=</span>Path(<span style="background-color: #fff0f0">"data/terms/specific_terms.csv"</span>),
    inputfile_mode<span style="color: #333333">=</span><span style="background-color: #fff0f0">"file"</span>
)

<span style="color: #888888"># Generate template</span>
template_df, general_df, specific_df, version_df <span style="color: #333333">=</span> generator<span style="color: #333333">.</span>generate(config)

<span style="color: #888888"># Prepare DataFrames for saving</span>
dataframes <span style="color: #333333">=</span> {
    <span style="background-color: #fff0f0">"invoice_form"</span>: template_df,
    <span style="background-color: #fff0f0">"generalTerm"</span>: general_df,
    <span style="background-color: #fff0f0">"specificTerm"</span>: specific_df,
    <span style="background-color: #fff0f0">"_version"</span>: version_df
}

<span style="color: #888888"># Save with formatting</span>
output_path <span style="color: #333333">=</span> <span style="background-color: #fff0f0">"data/templates/formatted_template.xlsx"</span>
generator<span style="color: #333333">.</span>save(dataframes, output_path)

<span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Template saved to: </span><span style="background-color: #eeeeee">{</span>output_path<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
<span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Template dimensions: </span><span style="background-color: #eeeeee">{</span>template_df<span style="color: #333333">.</span>shape<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
</code></pre></div></td></tr></table></div>
<h3 id="rulebasedreplacer">RuleBasedReplacer</h3>
<p>A flexible class for managing file name mapping and content transformation rules.</p>
<h4 id="constructor_3">Constructor</h4>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code>RuleBasedReplacer(<span style="color: #333333">*</span>, rule_file_path: <span style="color: #007020">str</span> <span style="color: #333333">|</span> Path <span style="color: #333333">|</span> <span style="color: #008800; font-weight: bold">None</span> <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">None</span>)
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>rule_file_path</code> (str | Path | None): Path to rule file (optional)</p>
<p><strong>Attributes:</strong>
- <code>rules</code> (dict[str, str]): Dictionary holding mapping rules
- <code>last_apply_result</code> (dict[str, Any]): Result of last applied rules</p>
<h4 id="methods_3">Methods</h4>
<h5 id="load_rules">load_rules</h5>
<p>Load file mapping rules from JSON file.</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">load_rules</span>(<span style="color: #007020">self</span>, filepath: <span style="color: #007020">str</span> <span style="color: #333333">|</span> Path) <span style="color: #333333">-&gt;</span> <span style="color: #008800; font-weight: bold">None</span>
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>filepath</code> (str | Path): Path to JSON file containing mapping rules</p>
<p><strong>Raises:</strong>
- <code>StructuredError</code>: If file extension is not .json</p>
<h5 id="set_rule">set_rule</h5>
<p>Set a new mapping rule.</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">set_rule</span>(<span style="color: #007020">self</span>, path: <span style="color: #007020">str</span>, variable: <span style="color: #007020">str</span>) <span style="color: #333333">-&gt;</span> <span style="color: #008800; font-weight: bold">None</span>
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>path</code> (str): Target path for replacement
- <code>variable</code> (str): Replacement variable</p>
<h5 id="get_apply_rules_obj">get_apply_rules_obj</h5>
<p>Convert file mapping rules into JSON format.</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">7</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">get_apply_rules_obj</span>(
    <span style="color: #007020">self</span>,
    replacements: <span style="color: #007020">dict</span>[<span style="color: #007020">str</span>, Any],
    source_json_obj: <span style="color: #007020">dict</span>[<span style="color: #007020">str</span>, Any] <span style="color: #333333">|</span> <span style="color: #008800; font-weight: bold">None</span>,
    <span style="color: #333333">*</span>,
    mapping_rules: <span style="color: #007020">dict</span>[<span style="color: #007020">str</span>, <span style="color: #007020">str</span>] <span style="color: #333333">|</span> <span style="color: #008800; font-weight: bold">None</span> <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">None</span>,
) <span style="color: #333333">-&gt;</span> <span style="color: #007020">dict</span>[<span style="color: #007020">str</span>, Any]
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>replacements</code> (dict[str, Any]): Object containing mapping rules
- <code>source_json_obj</code> (dict[str, Any] | None): Source JSON object for rule application
- <code>mapping_rules</code> (dict[str, str] | None): Rules for mapping (optional)</p>
<p><strong>Returns:</strong>
- <code>dict[str, Any]</code>: Dictionary after rule conversion</p>
<h5 id="write_rule">write_rule</h5>
<p>Write file mapping rules to target JSON file.</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">write_rule</span>(<span style="color: #007020">self</span>, replacements_rule: <span style="color: #007020">dict</span>[<span style="color: #007020">str</span>, Any], save_file_path: <span style="color: #007020">str</span> <span style="color: #333333">|</span> Path) <span style="color: #333333">-&gt;</span> <span style="color: #007020">str</span>
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>replacements_rule</code> (dict[str, Any]): Object containing mapping rules
- <code>save_file_path</code> (str | Path): File path for saving</p>
<p><strong>Returns:</strong>
- <code>str</code>: Result of writing to target JSON</p>
<p><strong>Raises:</strong>
- <code>StructuredError</code>: If file extension is not .json or writing fails</p>
<p><strong>Example:</strong></p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">14</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">15</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">16</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">17</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">18</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">19</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">20</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">21</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">22</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">23</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">24</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">25</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">26</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">27</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">28</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">29</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">30</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">31</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">32</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">33</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">34</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">35</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">36</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">37</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">38</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">39</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">40</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">rdetoolkit.invoicefile</span> <span style="color: #008800; font-weight: bold">import</span> RuleBasedReplacer
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">pathlib</span> <span style="color: #008800; font-weight: bold">import</span> Path
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">json</span>

<span style="color: #888888"># Create replacer with rules file</span>
rules_path <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/config/mapping_rules.json"</span>)
replacer <span style="color: #333333">=</span> RuleBasedReplacer(rule_file_path<span style="color: #333333">=</span>rules_path)

<span style="color: #888888"># Set custom rules</span>
replacer<span style="color: #333333">.</span>set_rule(<span style="background-color: #fff0f0">"basic.dataName"</span>, <span style="background-color: #fff0f0">"$</span><span style="background-color: #eeeeee">{filename}</span><span style="background-color: #fff0f0">"</span>)
replacer<span style="color: #333333">.</span>set_rule(<span style="background-color: #fff0f0">"basic.description"</span>, <span style="background-color: #fff0f0">"$</span><span style="background-color: #eeeeee">{description}</span><span style="background-color: #fff0f0">"</span>)
replacer<span style="color: #333333">.</span>set_rule(<span style="background-color: #fff0f0">"sample.names"</span>, [<span style="background-color: #fff0f0">"$</span><span style="background-color: #eeeeee">{sample_name}</span><span style="background-color: #fff0f0">"</span>])

<span style="color: #888888"># Prepare replacement values</span>
replacements <span style="color: #333333">=</span> {
    <span style="background-color: #fff0f0">"$</span><span style="background-color: #eeeeee">{filename}</span><span style="background-color: #fff0f0">"</span>: <span style="background-color: #fff0f0">"experiment_data.csv"</span>,
    <span style="background-color: #fff0f0">"$</span><span style="background-color: #eeeeee">{description}</span><span style="background-color: #fff0f0">"</span>: <span style="background-color: #fff0f0">"Experimental measurement data"</span>,
    <span style="background-color: #fff0f0">"$</span><span style="background-color: #eeeeee">{sample_name}</span><span style="background-color: #fff0f0">"</span>: <span style="background-color: #fff0f0">"Sample A"</span>
}

<span style="color: #888888"># Apply rules to create new JSON structure</span>
source_obj <span style="color: #333333">=</span> {
    <span style="background-color: #fff0f0">"basic"</span>: {
        <span style="background-color: #fff0f0">"title"</span>: <span style="background-color: #fff0f0">"Original Title"</span>
    }
}

result <span style="color: #333333">=</span> replacer<span style="color: #333333">.</span>get_apply_rules_obj(replacements, source_obj)
<span style="color: #007020">print</span>(<span style="background-color: #fff0f0">"Applied rules result:"</span>)
<span style="color: #007020">print</span>(json<span style="color: #333333">.</span>dumps(result, indent<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">2</span>))

<span style="color: #888888"># Write rules to file</span>
output_path <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/output/processed_data.json"</span>)
written_content <span style="color: #333333">=</span> replacer<span style="color: #333333">.</span>write_rule(replacements, output_path)
<span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Rules written to: </span><span style="background-color: #eeeeee">{</span>output_path<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

<span style="color: #888888"># Load existing rules</span>
<span style="color: #008800; font-weight: bold">if</span> rules_path<span style="color: #333333">.</span>exists():
    replacer<span style="color: #333333">.</span>load_rules(rules_path)
    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Loaded </span><span style="background-color: #eeeeee">{</span><span style="color: #007020">len</span>(replacer<span style="color: #333333">.</span>rules)<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0"> rules from file"</span>)
</code></pre></div></td></tr></table></div>
<h3 id="smarttablefile">SmartTableFile</h3>
<p>A class for handling SmartTable files (Excel/CSV/TSV) for automated invoice generation.</p>
<h4 id="constructor_4">Constructor</h4>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code>SmartTableFile(smarttable_path: Path)
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>smarttable_path</code> (Path): Path to SmartTable file (.xlsx, .csv, .tsv)</p>
<p><strong>Raises:</strong>
- <code>StructuredError</code>: If file format unsupported or file doesn't exist</p>
<h4 id="methods_4">Methods</h4>
<h5 id="read_table">read_table</h5>
<p>Read the SmartTable file and return as DataFrame.</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">read_table</span>(<span style="color: #007020">self</span>) <span style="color: #333333">-&gt;</span> pd<span style="color: #333333">.</span>DataFrame
</code></pre></div></td></tr></table></div>
<p><strong>Returns:</strong>
- <code>pd.DataFrame</code>: Table data with mapping key headers</p>
<p><strong>Raises:</strong>
- <code>StructuredError</code>: If file reading fails or format is invalid</p>
<h5 id="generate_row_csvs_with_file_mapping">generate_row_csvs_with_file_mapping</h5>
<p>Generate individual CSV files for each row with file mapping.</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">5</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">generate_row_csvs_with_file_mapping</span>(
    <span style="color: #007020">self</span>,
    output_dir: Path,
    extracted_files: <span style="color: #007020">list</span>[Path] <span style="color: #333333">|</span> <span style="color: #008800; font-weight: bold">None</span> <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">None</span>,
) <span style="color: #333333">-&gt;</span> <span style="color: #007020">list</span>[<span style="color: #007020">tuple</span>[Path, <span style="color: #007020">tuple</span>[Path, <span style="color: #333333">...</span>]]]
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>output_dir</code> (Path): Directory to save individual CSV files
- <code>extracted_files</code> (list[Path] | None): List of extracted files from zip (optional)</p>
<p><strong>Returns:</strong>
- <code>list[tuple[Path, tuple[Path, ...]]]</code>: List of tuples with CSV paths and related file paths</p>
<p><strong>Raises:</strong>
- <code>StructuredError</code>: If CSV generation or file mapping fails</p>
<p><strong>Example:</strong></p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">14</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">15</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">16</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">17</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">18</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">19</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">20</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">21</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">22</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">23</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">24</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">25</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">26</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">27</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">28</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">29</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">30</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">31</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">32</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">33</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">34</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">35</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">36</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">rdetoolkit.invoicefile</span> <span style="color: #008800; font-weight: bold">import</span> SmartTableFile
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">pathlib</span> <span style="color: #008800; font-weight: bold">import</span> Path
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">pandas</span> <span style="color: #008800; font-weight: bold">as</span> <span style="color: #0e84b5; font-weight: bold">pd</span>

<span style="color: #888888"># Create SmartTable file</span>
smarttable_path <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/input/smarttable_metadata.xlsx"</span>)
smarttable <span style="color: #333333">=</span> SmartTableFile(smarttable_path)

<span style="color: #888888"># Read table data</span>
table_data <span style="color: #333333">=</span> smarttable<span style="color: #333333">.</span>read_table()
<span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"SmartTable data shape: </span><span style="background-color: #eeeeee">{</span>table_data<span style="color: #333333">.</span>shape<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
<span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Columns: </span><span style="background-color: #eeeeee">{</span><span style="color: #007020">list</span>(table_data<span style="color: #333333">.</span>columns)<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

<span style="color: #888888"># Display mapping columns</span>
mapping_columns <span style="color: #333333">=</span> [col <span style="color: #008800; font-weight: bold">for</span> col <span style="color: #000000; font-weight: bold">in</span> table_data<span style="color: #333333">.</span>columns
                  <span style="color: #008800; font-weight: bold">if</span> <span style="color: #007020">any</span>(col<span style="color: #333333">.</span>startswith(prefix) <span style="color: #008800; font-weight: bold">for</span> prefix <span style="color: #000000; font-weight: bold">in</span> [<span style="background-color: #fff0f0">"basic/"</span>, <span style="background-color: #fff0f0">"custom/"</span>, <span style="background-color: #fff0f0">"sample/"</span>, <span style="background-color: #fff0f0">"meta/"</span>])]
<span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Mapping columns: </span><span style="background-color: #eeeeee">{</span>mapping_columns<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

<span style="color: #888888"># Generate individual CSV files with file mapping</span>
output_dir <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/processed/smarttable_rows"</span>)
extracted_files <span style="color: #333333">=</span> [
    Path(<span style="background-color: #fff0f0">"data/temp/file1.csv"</span>),
    Path(<span style="background-color: #fff0f0">"data/temp/file2.txt"</span>),
    Path(<span style="background-color: #fff0f0">"data/temp/subdir/file3.json"</span>)
]

csv_mappings <span style="color: #333333">=</span> smarttable<span style="color: #333333">.</span>generate_row_csvs_with_file_mapping(
    output_dir<span style="color: #333333">=</span>output_dir,
    extracted_files<span style="color: #333333">=</span>extracted_files
)

<span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Generated </span><span style="background-color: #eeeeee">{</span><span style="color: #007020">len</span>(csv_mappings)<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0"> CSV files:"</span>)
<span style="color: #008800; font-weight: bold">for</span> csv_path, related_files <span style="color: #000000; font-weight: bold">in</span> csv_mappings:
    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"  </span><span style="background-color: #eeeeee">{</span>csv_path<span style="color: #333333">.</span>name<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0"> -&gt; </span><span style="background-color: #eeeeee">{</span><span style="color: #007020">len</span>(related_files)<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0"> related files"</span>)
    <span style="color: #008800; font-weight: bold">for</span> file_path <span style="color: #000000; font-weight: bold">in</span> related_files:
        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"    - </span><span style="background-color: #eeeeee">{</span>file_path<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
</code></pre></div></td></tr></table></div>
<h2 id="functions">Functions</h2>
<h3 id="read_excelinvoice">read_excelinvoice</h3>
<p>Read an Excel invoice and process each sheet into DataFrames.</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">read_excelinvoice</span>(excelinvoice_filepath: RdeFsPath) <span style="color: #333333">-&gt;</span> <span style="color: #007020">tuple</span>[pd<span style="color: #333333">.</span>DataFrame, pd<span style="color: #333333">.</span>DataFrame, pd<span style="color: #333333">.</span>DataFrame]
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>excelinvoice_filepath</code> (RdeFsPath): Path to Excel invoice file</p>
<p><strong>Returns:</strong>
- <code>tuple[pd.DataFrame, pd.DataFrame, pd.DataFrame]</code>: Invoice list, general terms, and specific terms DataFrames</p>
<p><strong>Raises:</strong>
- <code>StructuredError</code>: If multiple invoice sheets exist or no sheets are present</p>
<p><strong>Sheet Requirements:</strong>
- One sheet with 'invoiceList_format_id' in cell A1
- One sheet named 'generalTerm'
- One sheet named 'specificTerm'</p>
<h3 id="check_exist_rawfiles">check_exist_rawfiles</h3>
<p>Check existence of raw file paths listed in DataFrame against file list.</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">check_exist_rawfiles</span>(dfexcelinvoice: pd<span style="color: #333333">.</span>DataFrame, excel_rawfiles: <span style="color: #007020">list</span>[Path]) <span style="color: #333333">-&gt;</span> <span style="color: #007020">list</span>[Path]
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>dfexcelinvoice</code> (pd.DataFrame): DataFrame with file names in 'data_file_names/name' column
- <code>excel_rawfiles</code> (list[Path]): List of file paths</p>
<p><strong>Returns:</strong>
- <code>list[Path]</code>: List of Path objects ordered as they appear in DataFrame</p>
<p><strong>Raises:</strong>
- <code>StructuredError</code>: If any file name in DataFrame is not found in file list</p>
<h3 id="backup_invoice_json_files">backup_invoice_json_files</h3>
<p>Backup invoice files and retrieve paths based on processing mode.</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">backup_invoice_json_files</span>(excel_invoice_file: Path <span style="color: #333333">|</span> <span style="color: #008800; font-weight: bold">None</span>, mode: <span style="color: #007020">str</span> <span style="color: #333333">|</span> <span style="color: #008800; font-weight: bold">None</span>) <span style="color: #333333">-&gt;</span> Path
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>excel_invoice_file</code> (Path | None): Excel invoice file path (optional)
- <code>mode</code> (str | None): Processing mode flags</p>
<p><strong>Returns:</strong>
- <code>Path</code>: Path to backed up invoice_org.json file</p>
<h3 id="update_description_with_features">update_description_with_features</h3>
<p>Write metadata features to the description field in invoice.json.</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">5</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">update_description_with_features</span>(
    rde_resource: RdeOutputResourcePath,
    dst_invoice_json: Path,
    metadata_def_json: Path,
) <span style="color: #333333">-&gt;</span> <span style="color: #008800; font-weight: bold">None</span>
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>rde_resource</code> (RdeOutputResourcePath): Resource paths for RDE processing
- <code>dst_invoice_json</code> (Path): Path to target invoice.json file
- <code>metadata_def_json</code> (Path): Path to metadata definition JSON file</p>
<p><strong>Returns:</strong>
- <code>None</code></p>
<h3 id="apply_magic_variable">apply_magic_variable</h3>
<p>Convert magic variables like ${filename} in invoice content.</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">6</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">apply_magic_variable</span>(
    invoice_path: <span style="color: #007020">str</span> <span style="color: #333333">|</span> Path,
    rawfile_path: <span style="color: #007020">str</span> <span style="color: #333333">|</span> Path,
    <span style="color: #333333">*</span>,
    save_filepath: <span style="color: #007020">str</span> <span style="color: #333333">|</span> Path <span style="color: #333333">|</span> <span style="color: #008800; font-weight: bold">None</span> <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">None</span>
) <span style="color: #333333">-&gt;</span> <span style="color: #007020">dict</span>[<span style="color: #007020">str</span>, Any]
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>invoice_path</code> (str | Path): Path to invoice.json file
- <code>rawfile_path</code> (str | Path): Path to input data file
- <code>save_filepath</code> (str | Path | None): Path to save processed file (optional)</p>
<p><strong>Returns:</strong>
- <code>dict[str, Any]</code>: Invoice content after variable replacement</p>
<h3 id="apply_default_filename_mapping_rule">apply_default_filename_mapping_rule</h3>
<p>Apply default filename mapping rule based on save file path.</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">4</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">apply_default_filename_mapping_rule</span>(
    replacement_rule: <span style="color: #007020">dict</span>[<span style="color: #007020">str</span>, Any],
    save_file_path: <span style="color: #007020">str</span> <span style="color: #333333">|</span> Path
) <span style="color: #333333">-&gt;</span> <span style="color: #007020">dict</span>[<span style="color: #007020">str</span>, Any]
</code></pre></div></td></tr></table></div>
<p><strong>Parameters:</strong>
- <code>replacement_rule</code> (dict[str, Any]): Replacement rules to apply
- <code>save_file_path</code> (str | Path): File path for saving rules</p>
<p><strong>Returns:</strong>
- <code>dict[str, Any]</code>: Result of applied replacement rules</p>
<h2 id="complete-usage-examples">Complete Usage Examples</h2>
<h3 id="comprehensive-excel-invoice-processing-pipeline">Comprehensive Excel Invoice Processing Pipeline</h3>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 13</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 14</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 15</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 16</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 17</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 18</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 19</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 20</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 21</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 22</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 23</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 24</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 25</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 26</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 27</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 28</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 29</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 30</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 31</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 32</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 33</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 34</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 35</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 36</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 37</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 38</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 39</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 40</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 41</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 42</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 43</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 44</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 45</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 46</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 47</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 48</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 49</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 50</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 51</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 52</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 53</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 54</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 55</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 56</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 57</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 58</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 59</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 60</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 61</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 62</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 63</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 64</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 65</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 66</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 67</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 68</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 69</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 70</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 71</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 72</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 73</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 74</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 75</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 76</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 77</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 78</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 79</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 80</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 81</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 82</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 83</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 84</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 85</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 86</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 87</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 88</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 89</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 90</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 91</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 92</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 93</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 94</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 95</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 96</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 97</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 98</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 99</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">100</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">101</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">102</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">103</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">104</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">105</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">106</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">107</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">108</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">109</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">110</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">111</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">112</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">113</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">114</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">115</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">116</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">117</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">118</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">119</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">120</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">121</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">122</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">123</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">124</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">125</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">126</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">127</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">128</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">129</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">130</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">131</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">132</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">133</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">134</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">135</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">136</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">137</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">138</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">139</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">140</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">141</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">142</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">143</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">144</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">145</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">146</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">147</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">148</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">149</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">150</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">151</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">152</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">153</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">154</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">155</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">156</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">157</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">158</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">159</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">160</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">161</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">162</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">163</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">164</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">165</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">166</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">167</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">168</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">169</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">170</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">171</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">172</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">173</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">174</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">175</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">176</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">177</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">178</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">179</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">180</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">181</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">182</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">183</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">184</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">185</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">186</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">187</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">188</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">189</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">190</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">191</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">192</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">193</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">194</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">195</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">196</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">197</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">198</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">199</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">200</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">201</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">202</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">203</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">204</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">205</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">206</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">207</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">208</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">209</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">210</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">211</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">212</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">213</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">214</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">215</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">216</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">217</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">218</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">219</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">220</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">221</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">222</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">223</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">224</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">225</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">226</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">227</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">228</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">229</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">230</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">231</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">232</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">233</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">234</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">235</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">236</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">237</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">238</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">239</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">240</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">241</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">242</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">243</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">244</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">245</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">246</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">247</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">248</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">249</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">250</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">251</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">252</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">253</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">254</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">255</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">256</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">257</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">258</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">259</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">260</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">261</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">262</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">263</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">264</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">265</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">266</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">267</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">268</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">269</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">270</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">271</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">272</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">273</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">274</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">275</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">276</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">rdetoolkit.invoicefile</span> <span style="color: #008800; font-weight: bold">import</span> ExcelInvoiceFile, RuleBasedReplacer, apply_magic_variable
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">pathlib</span> <span style="color: #008800; font-weight: bold">import</span> Path
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">pandas</span> <span style="color: #008800; font-weight: bold">as</span> <span style="color: #0e84b5; font-weight: bold">pd</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">json</span>
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">typing</span> <span style="color: #008800; font-weight: bold">import</span> List, Dict, Any

<span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">ExcelInvoiceProcessor</span>:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Comprehensive Excel invoice processing pipeline."""</span>

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">__init__</span>(<span style="color: #007020">self</span>, base_dir: Path):
        <span style="color: #007020">self</span><span style="color: #333333">.</span>base_dir <span style="color: #333333">=</span> base_dir
        <span style="color: #007020">self</span><span style="color: #333333">.</span>input_dir <span style="color: #333333">=</span> base_dir <span style="color: #333333">/</span> <span style="background-color: #fff0f0">"input"</span>
        <span style="color: #007020">self</span><span style="color: #333333">.</span>output_dir <span style="color: #333333">=</span> base_dir <span style="color: #333333">/</span> <span style="background-color: #fff0f0">"output"</span>
        <span style="color: #007020">self</span><span style="color: #333333">.</span>config_dir <span style="color: #333333">=</span> base_dir <span style="color: #333333">/</span> <span style="background-color: #fff0f0">"config"</span>
        <span style="color: #007020">self</span><span style="color: #333333">.</span>templates_dir <span style="color: #333333">=</span> base_dir <span style="color: #333333">/</span> <span style="background-color: #fff0f0">"templates"</span>

        <span style="color: #888888"># Ensure directories exist</span>
        <span style="color: #008800; font-weight: bold">for</span> directory <span style="color: #000000; font-weight: bold">in</span> [<span style="color: #007020">self</span><span style="color: #333333">.</span>output_dir, <span style="color: #007020">self</span><span style="color: #333333">.</span>config_dir, <span style="color: #007020">self</span><span style="color: #333333">.</span>templates_dir]:
            directory<span style="color: #333333">.</span>mkdir(parents<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">True</span>, exist_ok<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">True</span>)

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">generate_template_from_schema</span>(
        <span style="color: #007020">self</span>,
        schema_path: Path,
        template_path: Path,
        mode: <span style="color: #007020">str</span> <span style="color: #333333">=</span> <span style="background-color: #fff0f0">"file"</span>
    ) <span style="color: #333333">-&gt;</span> <span style="color: #007020">tuple</span>[pd<span style="color: #333333">.</span>DataFrame, pd<span style="color: #333333">.</span>DataFrame, pd<span style="color: #333333">.</span>DataFrame]:
<span style="color: #bbbbbb">        </span><span style="color: #DD4422">"""Generate Excel invoice template from schema."""</span>

        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Generating template from schema: </span><span style="background-color: #eeeeee">{</span>schema_path<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

        <span style="color: #008800; font-weight: bold">try</span>:
            template_df, general_df, specific_df <span style="color: #333333">=</span> ExcelInvoiceFile<span style="color: #333333">.</span>generate_template(
                invoice_schema_path<span style="color: #333333">=</span>schema_path,
                save_path<span style="color: #333333">=</span>template_path,
                file_mode<span style="color: #333333">=</span>mode
            )

            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Template generated successfully:"</span>)
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"  Template columns: </span><span style="background-color: #eeeeee">{</span>template_df<span style="color: #333333">.</span>shape[<span style="color: #0000DD; font-weight: bold">1</span>]<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"  General terms: </span><span style="background-color: #eeeeee">{</span><span style="color: #007020">len</span>(general_df)<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"  Specific terms: </span><span style="background-color: #eeeeee">{</span><span style="color: #007020">len</span>(specific_df)<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"  Saved to: </span><span style="background-color: #eeeeee">{</span>template_path<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

            <span style="color: #008800; font-weight: bold">return</span> template_df, general_df, specific_df

        <span style="color: #008800; font-weight: bold">except</span> <span style="color: #FF0000; font-weight: bold">Exception</span> <span style="color: #008800; font-weight: bold">as</span> e:
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Template generation failed: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
            <span style="color: #008800; font-weight: bold">raise</span>

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">process_excel_invoice_batch</span>(
        <span style="color: #007020">self</span>,
        excel_invoice_path: Path,
        original_invoice_path: Path,
        schema_path: Path,
        raw_files_dir: Path
    ) <span style="color: #333333">-&gt;</span> List[Dict[<span style="color: #007020">str</span>, Any]]:
<span style="color: #bbbbbb">        </span><span style="color: #DD4422">"""Process Excel invoice in batch mode."""</span>

        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Processing Excel invoice: </span><span style="background-color: #eeeeee">{</span>excel_invoice_path<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

        <span style="color: #008800; font-weight: bold">try</span>:
            <span style="color: #888888"># Read Excel invoice</span>
            excel_invoice <span style="color: #333333">=</span> ExcelInvoiceFile(excel_invoice_path)

            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Excel invoice loaded:"</span>)
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"  Rows: </span><span style="background-color: #eeeeee">{</span><span style="color: #007020">len</span>(excel_invoice<span style="color: #333333">.</span>dfexcelinvoice)<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"  Columns: </span><span style="background-color: #eeeeee">{</span>excel_invoice<span style="color: #333333">.</span>dfexcelinvoice<span style="color: #333333">.</span>shape[<span style="color: #0000DD; font-weight: bold">1</span>]<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

            <span style="color: #888888"># Process each row</span>
            results <span style="color: #333333">=</span> []

            <span style="color: #008800; font-weight: bold">for</span> idx, row <span style="color: #000000; font-weight: bold">in</span> excel_invoice<span style="color: #333333">.</span>dfexcelinvoice<span style="color: #333333">.</span>iterrows():
                <span style="color: #008800; font-weight: bold">try</span>:
                    result <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>_process_single_row(
                        excel_invoice<span style="color: #333333">=</span>excel_invoice,
                        row_index<span style="color: #333333">=</span>idx,
                        original_invoice_path<span style="color: #333333">=</span>original_invoice_path,
                        schema_path<span style="color: #333333">=</span>schema_path,
                        raw_files_dir<span style="color: #333333">=</span>raw_files_dir
                    )
                    results<span style="color: #333333">.</span>append(result)
                    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"✓ Processed row </span><span style="background-color: #eeeeee">{</span>idx<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">: </span><span style="background-color: #eeeeee">{</span>result[<span style="background-color: #fff0f0">'output_file'</span>]<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

                <span style="color: #008800; font-weight: bold">except</span> <span style="color: #FF0000; font-weight: bold">Exception</span> <span style="color: #008800; font-weight: bold">as</span> e:
                    error_result <span style="color: #333333">=</span> {
                        <span style="background-color: #fff0f0">"row_index"</span>: idx,
                        <span style="background-color: #fff0f0">"status"</span>: <span style="background-color: #fff0f0">"failed"</span>,
                        <span style="background-color: #fff0f0">"error"</span>: <span style="color: #007020">str</span>(e),
                        <span style="background-color: #fff0f0">"output_file"</span>: <span style="color: #008800; font-weight: bold">None</span>
                    }
                    results<span style="color: #333333">.</span>append(error_result)
                    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"✗ Failed to process row </span><span style="background-color: #eeeeee">{</span>idx<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

            <span style="color: #888888"># Summary</span>
            successful <span style="color: #333333">=</span> <span style="color: #007020">sum</span>(<span style="color: #0000DD; font-weight: bold">1</span> <span style="color: #008800; font-weight: bold">for</span> r <span style="color: #000000; font-weight: bold">in</span> results <span style="color: #008800; font-weight: bold">if</span> r[<span style="background-color: #fff0f0">"status"</span>] <span style="color: #333333">==</span> <span style="background-color: #fff0f0">"success"</span>)
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"</span><span style="color: #666666; font-weight: bold; background-color: #fff0f0">\n</span><span style="background-color: #fff0f0">Batch processing summary:"</span>)
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"  Total rows: </span><span style="background-color: #eeeeee">{</span><span style="color: #007020">len</span>(results)<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"  Successful: </span><span style="background-color: #eeeeee">{</span>successful<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"  Failed: </span><span style="background-color: #eeeeee">{</span><span style="color: #007020">len</span>(results)<span style="color: #bbbbbb"> </span><span style="color: #333333">-</span><span style="color: #bbbbbb"> </span>successful<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

            <span style="color: #008800; font-weight: bold">return</span> results

        <span style="color: #008800; font-weight: bold">except</span> <span style="color: #FF0000; font-weight: bold">Exception</span> <span style="color: #008800; font-weight: bold">as</span> e:
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Batch processing failed: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
            <span style="color: #008800; font-weight: bold">raise</span>

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">_process_single_row</span>(
        <span style="color: #007020">self</span>,
        excel_invoice: ExcelInvoiceFile,
        row_index: <span style="color: #007020">int</span>,
        original_invoice_path: Path,
        schema_path: Path,
        raw_files_dir: Path
    ) <span style="color: #333333">-&gt;</span> Dict[<span style="color: #007020">str</span>, Any]:
<span style="color: #bbbbbb">        </span><span style="color: #DD4422">"""Process a single row from Excel invoice."""</span>

        <span style="color: #888888"># Generate output filename</span>
        output_filename <span style="color: #333333">=</span> <span style="background-color: #fff0f0">f"invoice_</span><span style="background-color: #eeeeee">{</span>row_index<span style="background-color: #eeeeee">:</span><span style="background-color: #fff0f0">04d</span><span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">.json"</span>
        output_path <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>output_dir <span style="color: #333333">/</span> output_filename

        <span style="color: #888888"># Get data filename for this row</span>
        row_data <span style="color: #333333">=</span> excel_invoice<span style="color: #333333">.</span>dfexcelinvoice<span style="color: #333333">.</span>iloc[row_index]
        data_filename <span style="color: #333333">=</span> row_data<span style="color: #333333">.</span>get(<span style="background-color: #fff0f0">"data_file_names/name"</span>, <span style="background-color: #fff0f0">f"data_</span><span style="background-color: #eeeeee">{</span>row_index<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

        <span style="color: #888888"># Process invoice</span>
        excel_invoice<span style="color: #333333">.</span>overwrite(
            invoice_org<span style="color: #333333">=</span>original_invoice_path,
            dist_path<span style="color: #333333">=</span>output_path,
            invoice_schema_path<span style="color: #333333">=</span>schema_path,
            idx<span style="color: #333333">=</span>row_index
        )

        <span style="color: #888888"># Apply magic variables if needed</span>
        raw_file_path <span style="color: #333333">=</span> raw_files_dir <span style="color: #333333">/</span> data_filename
        <span style="color: #008800; font-weight: bold">if</span> raw_file_path<span style="color: #333333">.</span>exists():
            apply_magic_variable(
                invoice_path<span style="color: #333333">=</span>output_path,
                rawfile_path<span style="color: #333333">=</span>raw_file_path,
                save_filepath<span style="color: #333333">=</span>output_path
            )

        <span style="color: #008800; font-weight: bold">return</span> {
            <span style="background-color: #fff0f0">"row_index"</span>: row_index,
            <span style="background-color: #fff0f0">"status"</span>: <span style="background-color: #fff0f0">"success"</span>,
            <span style="background-color: #fff0f0">"output_file"</span>: output_path,
            <span style="background-color: #fff0f0">"data_file"</span>: data_filename,
            <span style="background-color: #fff0f0">"processed_at"</span>: pd<span style="color: #333333">.</span>Timestamp<span style="color: #333333">.</span>now()<span style="color: #333333">.</span>isoformat()
        }

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">setup_custom_rules</span>(<span style="color: #007020">self</span>, rules_config: Dict[<span style="color: #007020">str</span>, <span style="color: #007020">str</span>]) <span style="color: #333333">-&gt;</span> RuleBasedReplacer:
<span style="color: #bbbbbb">        </span><span style="color: #DD4422">"""Setup custom replacement rules."""</span>

        rules_file <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>config_dir <span style="color: #333333">/</span> <span style="background-color: #fff0f0">"custom_rules.json"</span>
        replacer <span style="color: #333333">=</span> RuleBasedReplacer()

        <span style="color: #888888"># Set custom rules</span>
        <span style="color: #008800; font-weight: bold">for</span> path, variable <span style="color: #000000; font-weight: bold">in</span> rules_config<span style="color: #333333">.</span>items():
            replacer<span style="color: #333333">.</span>set_rule(path, variable)

        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Setup </span><span style="background-color: #eeeeee">{</span><span style="color: #007020">len</span>(rules_config)<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0"> custom rules:"</span>)
        <span style="color: #008800; font-weight: bold">for</span> path, variable <span style="color: #000000; font-weight: bold">in</span> rules_config<span style="color: #333333">.</span>items():
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"  </span><span style="background-color: #eeeeee">{</span>path<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0"> -&gt; </span><span style="background-color: #eeeeee">{</span>variable<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

        <span style="color: #008800; font-weight: bold">return</span> replacer

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">apply_bulk_transformations</span>(
        <span style="color: #007020">self</span>,
        invoice_files: List[Path],
        transformation_rules: Dict[<span style="color: #007020">str</span>, Any]
    ) <span style="color: #333333">-&gt;</span> List[Dict[<span style="color: #007020">str</span>, Any]]:
<span style="color: #bbbbbb">        </span><span style="color: #DD4422">"""Apply transformations to multiple invoice files."""</span>

        replacer <span style="color: #333333">=</span> RuleBasedReplacer()
        results <span style="color: #333333">=</span> []

        <span style="color: #008800; font-weight: bold">for</span> invoice_path <span style="color: #000000; font-weight: bold">in</span> invoice_files:
            <span style="color: #008800; font-weight: bold">try</span>:
                <span style="color: #888888"># Load invoice</span>
                <span style="color: #008800; font-weight: bold">with</span> <span style="color: #007020">open</span>(invoice_path, <span style="background-color: #fff0f0">'r'</span>, encoding<span style="color: #333333">=</span><span style="background-color: #fff0f0">'utf-8'</span>) <span style="color: #008800; font-weight: bold">as</span> f:
                    invoice_data <span style="color: #333333">=</span> json<span style="color: #333333">.</span>load(f)

                <span style="color: #888888"># Apply rules</span>
                transformed_data <span style="color: #333333">=</span> replacer<span style="color: #333333">.</span>get_apply_rules_obj(
                    replacements<span style="color: #333333">=</span>transformation_rules,
                    source_json_obj<span style="color: #333333">=</span>invoice_data
                )

                <span style="color: #888888"># Save transformed invoice</span>
                output_path <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>output_dir <span style="color: #333333">/</span> <span style="background-color: #fff0f0">f"transformed_</span><span style="background-color: #eeeeee">{</span>invoice_path<span style="color: #333333">.</span>name<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>
                <span style="color: #008800; font-weight: bold">with</span> <span style="color: #007020">open</span>(output_path, <span style="background-color: #fff0f0">'w'</span>, encoding<span style="color: #333333">=</span><span style="background-color: #fff0f0">'utf-8'</span>) <span style="color: #008800; font-weight: bold">as</span> f:
                    json<span style="color: #333333">.</span>dump(transformed_data, f, indent<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">2</span>, ensure_ascii<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">False</span>)

                results<span style="color: #333333">.</span>append({
                    <span style="background-color: #fff0f0">"input_file"</span>: invoice_path,
                    <span style="background-color: #fff0f0">"output_file"</span>: output_path,
                    <span style="background-color: #fff0f0">"status"</span>: <span style="background-color: #fff0f0">"success"</span>
                })

            <span style="color: #008800; font-weight: bold">except</span> <span style="color: #FF0000; font-weight: bold">Exception</span> <span style="color: #008800; font-weight: bold">as</span> e:
                results<span style="color: #333333">.</span>append({
                    <span style="background-color: #fff0f0">"input_file"</span>: invoice_path,
                    <span style="background-color: #fff0f0">"output_file"</span>: <span style="color: #008800; font-weight: bold">None</span>,
                    <span style="background-color: #fff0f0">"status"</span>: <span style="background-color: #fff0f0">"failed"</span>,
                    <span style="background-color: #fff0f0">"error"</span>: <span style="color: #007020">str</span>(e)
                })

        <span style="color: #008800; font-weight: bold">return</span> results

<span style="color: #888888"># Usage example</span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">main</span>():
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Main processing example."""</span>

    <span style="color: #888888"># Setup processor</span>
    base_dir <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/invoice_processing"</span>)
    processor <span style="color: #333333">=</span> ExcelInvoiceProcessor(base_dir)

    <span style="color: #888888"># File paths</span>
    schema_path <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/tasksupport/invoice.schema.json"</span>)
    excel_invoice_path <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/input/batch_invoice.xlsx"</span>)
    original_invoice_path <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/invoice/invoice.json"</span>)
    raw_files_dir <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/raw_files"</span>)

    <span style="color: #008800; font-weight: bold">try</span>:
        <span style="color: #888888"># Step 1: Generate template from schema</span>
        template_path <span style="color: #333333">=</span> processor<span style="color: #333333">.</span>templates_dir <span style="color: #333333">/</span> <span style="background-color: #fff0f0">"generated_template.xlsx"</span>
        template_df, general_df, specific_df <span style="color: #333333">=</span> processor<span style="color: #333333">.</span>generate_template_from_schema(
            schema_path<span style="color: #333333">=</span>schema_path,
            template_path<span style="color: #333333">=</span>template_path,
            mode<span style="color: #333333">=</span><span style="background-color: #fff0f0">"file"</span>
        )

        <span style="color: #888888"># Step 2: Process Excel invoice batch</span>
        <span style="color: #008800; font-weight: bold">if</span> excel_invoice_path<span style="color: #333333">.</span>exists():
            batch_results <span style="color: #333333">=</span> processor<span style="color: #333333">.</span>process_excel_invoice_batch(
                excel_invoice_path<span style="color: #333333">=</span>excel_invoice_path,
                original_invoice_path<span style="color: #333333">=</span>original_invoice_path,
                schema_path<span style="color: #333333">=</span>schema_path,
                raw_files_dir<span style="color: #333333">=</span>raw_files_dir
            )

            <span style="color: #888888"># Step 3: Setup and apply custom rules</span>
            custom_rules <span style="color: #333333">=</span> {
                <span style="background-color: #fff0f0">"basic.creator"</span>: <span style="background-color: #fff0f0">"$</span><span style="background-color: #eeeeee">{creator_name}</span><span style="background-color: #fff0f0">"</span>,
                <span style="background-color: #fff0f0">"basic.organization"</span>: <span style="background-color: #fff0f0">"$</span><span style="background-color: #eeeeee">{organization}</span><span style="background-color: #fff0f0">"</span>,
                <span style="background-color: #fff0f0">"sample.location"</span>: <span style="background-color: #fff0f0">"$</span><span style="background-color: #eeeeee">{sample_location}</span><span style="background-color: #fff0f0">"</span>
            }

            replacer <span style="color: #333333">=</span> processor<span style="color: #333333">.</span>setup_custom_rules(custom_rules)

            <span style="color: #888888"># Step 4: Apply bulk transformations</span>
            processed_invoices <span style="color: #333333">=</span> [r[<span style="background-color: #fff0f0">"output_file"</span>] <span style="color: #008800; font-weight: bold">for</span> r <span style="color: #000000; font-weight: bold">in</span> batch_results
                                <span style="color: #008800; font-weight: bold">if</span> r[<span style="background-color: #fff0f0">"status"</span>] <span style="color: #333333">==</span> <span style="background-color: #fff0f0">"success"</span> <span style="color: #000000; font-weight: bold">and</span> r[<span style="background-color: #fff0f0">"output_file"</span>]]

            transformation_rules <span style="color: #333333">=</span> {
                <span style="background-color: #fff0f0">"$</span><span style="background-color: #eeeeee">{creator_name}</span><span style="background-color: #fff0f0">"</span>: <span style="background-color: #fff0f0">"Research Team Alpha"</span>,
                <span style="background-color: #fff0f0">"$</span><span style="background-color: #eeeeee">{organization}</span><span style="background-color: #fff0f0">"</span>: <span style="background-color: #fff0f0">"Advanced Research Institute"</span>,
                <span style="background-color: #fff0f0">"$</span><span style="background-color: #eeeeee">{sample_location}</span><span style="background-color: #fff0f0">"</span>: <span style="background-color: #fff0f0">"Laboratory Building A"</span>
            }

            transformation_results <span style="color: #333333">=</span> processor<span style="color: #333333">.</span>apply_bulk_transformations(
                invoice_files<span style="color: #333333">=</span>processed_invoices,
                transformation_rules<span style="color: #333333">=</span>transformation_rules
            )

            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"</span><span style="color: #666666; font-weight: bold; background-color: #fff0f0">\n</span><span style="background-color: #fff0f0">Transformation results:"</span>)
            successful_transforms <span style="color: #333333">=</span> <span style="color: #007020">sum</span>(<span style="color: #0000DD; font-weight: bold">1</span> <span style="color: #008800; font-weight: bold">for</span> r <span style="color: #000000; font-weight: bold">in</span> transformation_results <span style="color: #008800; font-weight: bold">if</span> r[<span style="background-color: #fff0f0">"status"</span>] <span style="color: #333333">==</span> <span style="background-color: #fff0f0">"success"</span>)
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"  Successful transformations: </span><span style="background-color: #eeeeee">{</span>successful_transforms<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">/</span><span style="background-color: #eeeeee">{</span><span style="color: #007020">len</span>(transformation_results)<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">"</span><span style="color: #666666; font-weight: bold; background-color: #fff0f0">\n</span><span style="background-color: #fff0f0">✅ Invoice processing pipeline completed successfully"</span>)

    <span style="color: #008800; font-weight: bold">except</span> <span style="color: #FF0000; font-weight: bold">Exception</span> <span style="color: #008800; font-weight: bold">as</span> e:
        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"</span><span style="color: #666666; font-weight: bold; background-color: #fff0f0">\n</span><span style="background-color: #fff0f0">❌ Pipeline failed: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
        <span style="color: #008800; font-weight: bold">raise</span>

<span style="color: #008800; font-weight: bold">if</span> <span style="color: #996633">__name__</span> <span style="color: #333333">==</span> <span style="background-color: #fff0f0">"__main__"</span>:
    main()
</code></pre></div></td></tr></table></div>
<h3 id="smarttable-processing-with-file-mapping">SmartTable Processing with File Mapping</h3>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">  9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 13</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 14</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 15</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 16</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 17</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 18</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 19</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 20</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 21</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 22</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 23</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 24</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 25</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 26</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 27</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 28</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 29</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 30</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 31</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 32</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 33</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 34</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 35</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 36</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 37</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 38</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 39</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 40</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 41</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 42</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 43</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 44</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 45</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 46</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 47</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 48</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 49</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 50</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 51</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 52</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 53</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 54</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 55</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 56</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 57</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 58</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 59</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 60</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 61</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 62</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 63</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 64</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 65</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 66</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 67</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 68</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 69</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 70</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 71</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 72</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 73</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 74</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 75</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 76</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 77</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 78</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 79</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 80</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 81</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 82</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 83</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 84</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 85</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 86</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 87</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 88</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 89</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 90</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 91</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 92</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 93</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 94</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 95</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 96</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 97</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 98</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 99</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">100</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">101</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">102</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">103</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">104</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">105</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">106</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">107</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">108</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">109</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">110</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">111</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">112</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">113</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">114</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">115</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">116</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">117</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">118</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">119</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">120</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">121</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">122</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">123</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">124</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">125</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">126</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">127</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">128</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">129</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">130</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">131</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">132</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">133</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">134</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">135</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">136</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">137</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">138</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">139</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">140</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">141</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">142</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">143</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">144</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">145</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">146</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">147</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">148</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">149</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">150</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">151</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">152</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">153</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">154</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">155</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">156</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">157</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">158</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">159</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">160</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">161</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">162</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">163</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">164</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">165</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">166</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">167</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">168</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">169</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">170</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">171</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">172</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">173</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">174</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">175</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">176</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">177</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">178</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">179</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">180</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">181</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">182</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">183</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">184</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">185</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">186</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">187</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">188</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">189</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">190</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">191</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">192</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">193</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">194</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">195</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">196</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">197</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">198</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">199</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">200</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">201</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">202</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">203</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">204</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">205</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">206</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">207</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">208</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">209</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">210</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">211</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">212</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">213</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">214</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">215</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">216</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">217</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">218</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">219</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">220</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">221</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">222</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">223</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">224</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">225</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">226</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">227</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">228</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">229</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">230</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">231</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">232</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">233</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">234</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">235</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">236</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">237</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">238</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">239</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">240</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">241</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">242</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">243</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">244</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">245</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">246</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">247</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">248</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">249</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">250</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">251</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">252</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">253</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">254</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">255</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">256</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">257</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">258</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">259</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">260</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">261</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">262</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">263</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">264</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">265</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">266</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">267</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">268</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">269</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">270</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">271</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">272</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">273</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">274</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">275</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">276</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">277</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">278</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">279</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">280</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">281</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">282</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">283</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">284</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">285</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">286</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">287</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">288</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">289</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">290</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">291</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">292</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">293</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">294</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">295</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">296</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">297</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">298</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">299</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">300</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">301</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">302</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">303</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">304</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">305</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">306</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">307</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">308</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">309</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">310</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">311</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">312</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">313</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">314</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">315</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">316</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">317</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">318</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">319</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">320</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">321</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">322</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">323</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">324</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">325</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">326</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">327</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">328</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">329</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">330</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">331</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">332</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">333</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">334</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">335</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">336</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">337</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">338</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">339</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">340</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">rdetoolkit.invoicefile</span> <span style="color: #008800; font-weight: bold">import</span> SmartTableFile
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">pathlib</span> <span style="color: #008800; font-weight: bold">import</span> Path
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">pandas</span> <span style="color: #008800; font-weight: bold">as</span> <span style="color: #0e84b5; font-weight: bold">pd</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">zipfile</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">tempfile</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">shutil</span>
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">typing</span> <span style="color: #008800; font-weight: bold">import</span> List, Tuple, Dict, Any

<span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">SmartTableProcessor</span>:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Advanced SmartTable processing with file mapping capabilities."""</span>

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">__init__</span>(<span style="color: #007020">self</span>, working_dir: Path):
        <span style="color: #007020">self</span><span style="color: #333333">.</span>working_dir <span style="color: #333333">=</span> working_dir
        <span style="color: #007020">self</span><span style="color: #333333">.</span>temp_dir <span style="color: #333333">=</span> working_dir <span style="color: #333333">/</span> <span style="background-color: #fff0f0">"temp"</span>
        <span style="color: #007020">self</span><span style="color: #333333">.</span>output_dir <span style="color: #333333">=</span> working_dir <span style="color: #333333">/</span> <span style="background-color: #fff0f0">"output"</span>
        <span style="color: #007020">self</span><span style="color: #333333">.</span>processed_dir <span style="color: #333333">=</span> working_dir <span style="color: #333333">/</span> <span style="background-color: #fff0f0">"processed"</span>

        <span style="color: #888888"># Create directories</span>
        <span style="color: #008800; font-weight: bold">for</span> directory <span style="color: #000000; font-weight: bold">in</span> [<span style="color: #007020">self</span><span style="color: #333333">.</span>temp_dir, <span style="color: #007020">self</span><span style="color: #333333">.</span>output_dir, <span style="color: #007020">self</span><span style="color: #333333">.</span>processed_dir]:
            directory<span style="color: #333333">.</span>mkdir(parents<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">True</span>, exist_ok<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">True</span>)

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">extract_zip_file</span>(<span style="color: #007020">self</span>, zip_path: Path) <span style="color: #333333">-&gt;</span> List[Path]:
<span style="color: #bbbbbb">        </span><span style="color: #DD4422">"""Extract ZIP file and return list of extracted files."""</span>

        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Extracting ZIP file: </span><span style="background-color: #eeeeee">{</span>zip_path<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

        <span style="color: #008800; font-weight: bold">try</span>:
            extracted_files <span style="color: #333333">=</span> []

            <span style="color: #008800; font-weight: bold">with</span> zipfile<span style="color: #333333">.</span>ZipFile(zip_path, <span style="background-color: #fff0f0">'r'</span>) <span style="color: #008800; font-weight: bold">as</span> zip_file:
                <span style="color: #888888"># Extract all files</span>
                zip_file<span style="color: #333333">.</span>extractall(<span style="color: #007020">self</span><span style="color: #333333">.</span>temp_dir)

                <span style="color: #888888"># Get list of extracted files</span>
                <span style="color: #008800; font-weight: bold">for</span> file_info <span style="color: #000000; font-weight: bold">in</span> zip_file<span style="color: #333333">.</span>filelist:
                    <span style="color: #008800; font-weight: bold">if</span> <span style="color: #000000; font-weight: bold">not</span> file_info<span style="color: #333333">.</span>is_dir():
                        extracted_path <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>temp_dir <span style="color: #333333">/</span> file_info<span style="color: #333333">.</span>filename
                        <span style="color: #008800; font-weight: bold">if</span> extracted_path<span style="color: #333333">.</span>exists():
                            extracted_files<span style="color: #333333">.</span>append(extracted_path)

            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Extracted </span><span style="background-color: #eeeeee">{</span><span style="color: #007020">len</span>(extracted_files)<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0"> files"</span>)
            <span style="color: #008800; font-weight: bold">return</span> extracted_files

        <span style="color: #008800; font-weight: bold">except</span> <span style="color: #FF0000; font-weight: bold">Exception</span> <span style="color: #008800; font-weight: bold">as</span> e:
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"ZIP extraction failed: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
            <span style="color: #008800; font-weight: bold">raise</span>

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">process_smarttable_with_zip</span>(
        <span style="color: #007020">self</span>,
        smarttable_path: Path,
        zip_path: Path <span style="color: #333333">|</span> <span style="color: #008800; font-weight: bold">None</span> <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">None</span>
    ) <span style="color: #333333">-&gt;</span> Dict[<span style="color: #007020">str</span>, Any]:
<span style="color: #bbbbbb">        </span><span style="color: #DD4422">"""Process SmartTable with optional ZIP file containing data files."""</span>

        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Processing SmartTable: </span><span style="background-color: #eeeeee">{</span>smarttable_path<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

        <span style="color: #008800; font-weight: bold">try</span>:
            <span style="color: #888888"># Extract ZIP file if provided</span>
            extracted_files <span style="color: #333333">=</span> []
            <span style="color: #008800; font-weight: bold">if</span> zip_path <span style="color: #000000; font-weight: bold">and</span> zip_path<span style="color: #333333">.</span>exists():
                extracted_files <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>extract_zip_file(zip_path)

            <span style="color: #888888"># Create SmartTable processor</span>
            smarttable <span style="color: #333333">=</span> SmartTableFile(smarttable_path)

            <span style="color: #888888"># Read table data</span>
            table_data <span style="color: #333333">=</span> smarttable<span style="color: #333333">.</span>read_table()
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"SmartTable data: </span><span style="background-color: #eeeeee">{</span>table_data<span style="color: #333333">.</span>shape[<span style="color: #0000DD; font-weight: bold">0</span>]<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0"> rows, </span><span style="background-color: #eeeeee">{</span>table_data<span style="color: #333333">.</span>shape[<span style="color: #0000DD; font-weight: bold">1</span>]<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0"> columns"</span>)

            <span style="color: #888888"># Analyze mapping columns</span>
            mapping_analysis <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>_analyze_mapping_columns(table_data)
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Mapping analysis: </span><span style="background-color: #eeeeee">{</span>mapping_analysis<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

            <span style="color: #888888"># Generate CSV files with file mapping</span>
            csv_output_dir <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>processed_dir <span style="color: #333333">/</span> <span style="background-color: #fff0f0">"smarttable_csvs"</span>
            csv_mappings <span style="color: #333333">=</span> smarttable<span style="color: #333333">.</span>generate_row_csvs_with_file_mapping(
                output_dir<span style="color: #333333">=</span>csv_output_dir,
                extracted_files<span style="color: #333333">=</span>extracted_files
            )

            <span style="color: #888888"># Process each generated CSV</span>
            processing_results <span style="color: #333333">=</span> []
            <span style="color: #008800; font-weight: bold">for</span> csv_path, related_files <span style="color: #000000; font-weight: bold">in</span> csv_mappings:
                result <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>_process_single_csv(csv_path, related_files, table_data)
                processing_results<span style="color: #333333">.</span>append(result)

            <span style="color: #888888"># Create summary</span>
            summary <span style="color: #333333">=</span> {
                <span style="background-color: #fff0f0">"smarttable_file"</span>: <span style="color: #007020">str</span>(smarttable_path),
                <span style="background-color: #fff0f0">"zip_file"</span>: <span style="color: #007020">str</span>(zip_path) <span style="color: #008800; font-weight: bold">if</span> zip_path <span style="color: #008800; font-weight: bold">else</span> <span style="color: #008800; font-weight: bold">None</span>,
                <span style="background-color: #fff0f0">"total_rows"</span>: <span style="color: #007020">len</span>(table_data),
                <span style="background-color: #fff0f0">"total_csvs"</span>: <span style="color: #007020">len</span>(csv_mappings),
                <span style="background-color: #fff0f0">"extracted_files"</span>: <span style="color: #007020">len</span>(extracted_files),
                <span style="background-color: #fff0f0">"mapping_analysis"</span>: mapping_analysis,
                <span style="background-color: #fff0f0">"processing_results"</span>: processing_results,
                <span style="background-color: #fff0f0">"successful_processing"</span>: <span style="color: #007020">sum</span>(<span style="color: #0000DD; font-weight: bold">1</span> <span style="color: #008800; font-weight: bold">for</span> r <span style="color: #000000; font-weight: bold">in</span> processing_results <span style="color: #008800; font-weight: bold">if</span> r[<span style="background-color: #fff0f0">"status"</span>] <span style="color: #333333">==</span> <span style="background-color: #fff0f0">"success"</span>)
            }

            <span style="color: #888888"># Save summary</span>
            summary_path <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>output_dir <span style="color: #333333">/</span> <span style="background-color: #fff0f0">"smarttable_processing_summary.json"</span>
            <span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">json</span>
            <span style="color: #008800; font-weight: bold">with</span> <span style="color: #007020">open</span>(summary_path, <span style="background-color: #fff0f0">'w'</span>, encoding<span style="color: #333333">=</span><span style="background-color: #fff0f0">'utf-8'</span>) <span style="color: #008800; font-weight: bold">as</span> f:
                json<span style="color: #333333">.</span>dump(summary, f, indent<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">2</span>, default<span style="color: #333333">=</span><span style="color: #007020">str</span>, ensure_ascii<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">False</span>)

            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Processing completed: </span><span style="background-color: #eeeeee">{</span>summary[<span style="background-color: #fff0f0">'successful_processing'</span>]<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">/</span><span style="background-color: #eeeeee">{</span>summary[<span style="background-color: #fff0f0">'total_csvs'</span>]<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0"> successful"</span>)
            <span style="color: #008800; font-weight: bold">return</span> summary

        <span style="color: #008800; font-weight: bold">except</span> <span style="color: #FF0000; font-weight: bold">Exception</span> <span style="color: #008800; font-weight: bold">as</span> e:
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"SmartTable processing failed: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
            <span style="color: #008800; font-weight: bold">raise</span>

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">_analyze_mapping_columns</span>(<span style="color: #007020">self</span>, table_data: pd<span style="color: #333333">.</span>DataFrame) <span style="color: #333333">-&gt;</span> Dict[<span style="color: #007020">str</span>, Any]:
<span style="color: #bbbbbb">        </span><span style="color: #DD4422">"""Analyze mapping columns in SmartTable data."""</span>

        mapping_prefixes <span style="color: #333333">=</span> [<span style="background-color: #fff0f0">"basic/"</span>, <span style="background-color: #fff0f0">"custom/"</span>, <span style="background-color: #fff0f0">"sample/"</span>, <span style="background-color: #fff0f0">"meta/"</span>]
        inputdata_pattern <span style="color: #333333">=</span> <span style="background-color: #fff0f0">"inputdata"</span>

        analysis <span style="color: #333333">=</span> {
            <span style="background-color: #fff0f0">"total_columns"</span>: <span style="color: #007020">len</span>(table_data<span style="color: #333333">.</span>columns),
            <span style="background-color: #fff0f0">"mapping_columns"</span>: {},
            <span style="background-color: #fff0f0">"inputdata_columns"</span>: [],
            <span style="background-color: #fff0f0">"other_columns"</span>: []
        }

        <span style="color: #008800; font-weight: bold">for</span> column <span style="color: #000000; font-weight: bold">in</span> table_data<span style="color: #333333">.</span>columns:
            <span style="color: #888888"># Check for mapping columns</span>
            mapped <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">False</span>
            <span style="color: #008800; font-weight: bold">for</span> prefix <span style="color: #000000; font-weight: bold">in</span> mapping_prefixes:
                <span style="color: #008800; font-weight: bold">if</span> column<span style="color: #333333">.</span>startswith(prefix):
                    <span style="color: #008800; font-weight: bold">if</span> prefix <span style="color: #000000; font-weight: bold">not</span> <span style="color: #000000; font-weight: bold">in</span> analysis[<span style="background-color: #fff0f0">"mapping_columns"</span>]:
                        analysis[<span style="background-color: #fff0f0">"mapping_columns"</span>][prefix] <span style="color: #333333">=</span> []
                    analysis[<span style="background-color: #fff0f0">"mapping_columns"</span>][prefix]<span style="color: #333333">.</span>append(column)
                    mapped <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">True</span>
                    <span style="color: #008800; font-weight: bold">break</span>

            <span style="color: #888888"># Check for inputdata columns</span>
            <span style="color: #008800; font-weight: bold">if</span> inputdata_pattern <span style="color: #000000; font-weight: bold">in</span> column<span style="color: #333333">.</span>lower():
                analysis[<span style="background-color: #fff0f0">"inputdata_columns"</span>]<span style="color: #333333">.</span>append(column)
                mapped <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">True</span>

            <span style="color: #888888"># Other columns</span>
            <span style="color: #008800; font-weight: bold">if</span> <span style="color: #000000; font-weight: bold">not</span> mapped:
                analysis[<span style="background-color: #fff0f0">"other_columns"</span>]<span style="color: #333333">.</span>append(column)

        <span style="color: #008800; font-weight: bold">return</span> analysis

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">_process_single_csv</span>(
        <span style="color: #007020">self</span>,
        csv_path: Path,
        related_files: Tuple[Path, <span style="color: #333333">...</span>],
        original_table_data: pd<span style="color: #333333">.</span>DataFrame
    ) <span style="color: #333333">-&gt;</span> Dict[<span style="color: #007020">str</span>, Any]:
<span style="color: #bbbbbb">        </span><span style="color: #DD4422">"""Process a single CSV file generated from SmartTable row."""</span>

        <span style="color: #008800; font-weight: bold">try</span>:
            <span style="color: #888888"># Read CSV data</span>
            csv_data <span style="color: #333333">=</span> pd<span style="color: #333333">.</span>read_csv(csv_path)
            row_data <span style="color: #333333">=</span> csv_data<span style="color: #333333">.</span>iloc[<span style="color: #0000DD; font-weight: bold">0</span>] <span style="color: #008800; font-weight: bold">if</span> <span style="color: #007020">len</span>(csv_data) <span style="color: #333333">&gt;</span> <span style="color: #0000DD; font-weight: bold">0</span> <span style="color: #008800; font-weight: bold">else</span> <span style="color: #008800; font-weight: bold">None</span>

            <span style="color: #008800; font-weight: bold">if</span> row_data <span style="color: #000000; font-weight: bold">is</span> <span style="color: #008800; font-weight: bold">None</span>:
                <span style="color: #008800; font-weight: bold">return</span> {
                    <span style="background-color: #fff0f0">"csv_file"</span>: <span style="color: #007020">str</span>(csv_path),
                    <span style="background-color: #fff0f0">"status"</span>: <span style="background-color: #fff0f0">"failed"</span>,
                    <span style="background-color: #fff0f0">"error"</span>: <span style="background-color: #fff0f0">"Empty CSV data"</span>
                }

            <span style="color: #888888"># Extract metadata from row</span>
            metadata <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>_extract_metadata_from_row(row_data)

            <span style="color: #888888"># Process related files</span>
            file_processing_results <span style="color: #333333">=</span> []
            <span style="color: #008800; font-weight: bold">for</span> file_path <span style="color: #000000; font-weight: bold">in</span> related_files:
                file_result <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>_process_related_file(file_path, metadata)
                file_processing_results<span style="color: #333333">.</span>append(file_result)

            <span style="color: #888888"># Create output structure</span>
            output_data <span style="color: #333333">=</span> {
                <span style="background-color: #fff0f0">"metadata"</span>: metadata,
                <span style="background-color: #fff0f0">"related_files"</span>: [<span style="color: #007020">str</span>(f) <span style="color: #008800; font-weight: bold">for</span> f <span style="color: #000000; font-weight: bold">in</span> related_files],
                <span style="background-color: #fff0f0">"file_processing_results"</span>: file_processing_results
            }

            <span style="color: #888888"># Save individual result</span>
            output_filename <span style="color: #333333">=</span> <span style="background-color: #fff0f0">f"processed_</span><span style="background-color: #eeeeee">{</span>csv_path<span style="color: #333333">.</span>stem<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">.json"</span>
            output_path <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>output_dir <span style="color: #333333">/</span> output_filename

            <span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">json</span>
            <span style="color: #008800; font-weight: bold">with</span> <span style="color: #007020">open</span>(output_path, <span style="background-color: #fff0f0">'w'</span>, encoding<span style="color: #333333">=</span><span style="background-color: #fff0f0">'utf-8'</span>) <span style="color: #008800; font-weight: bold">as</span> f:
                json<span style="color: #333333">.</span>dump(output_data, f, indent<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">2</span>, default<span style="color: #333333">=</span><span style="color: #007020">str</span>, ensure_ascii<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">False</span>)

            <span style="color: #008800; font-weight: bold">return</span> {
                <span style="background-color: #fff0f0">"csv_file"</span>: <span style="color: #007020">str</span>(csv_path),
                <span style="background-color: #fff0f0">"output_file"</span>: <span style="color: #007020">str</span>(output_path),
                <span style="background-color: #fff0f0">"status"</span>: <span style="background-color: #fff0f0">"success"</span>,
                <span style="background-color: #fff0f0">"metadata_fields"</span>: <span style="color: #007020">len</span>(metadata),
                <span style="background-color: #fff0f0">"related_files_count"</span>: <span style="color: #007020">len</span>(related_files),
                <span style="background-color: #fff0f0">"processed_files"</span>: <span style="color: #007020">len</span>([r <span style="color: #008800; font-weight: bold">for</span> r <span style="color: #000000; font-weight: bold">in</span> file_processing_results <span style="color: #008800; font-weight: bold">if</span> r[<span style="background-color: #fff0f0">"status"</span>] <span style="color: #333333">==</span> <span style="background-color: #fff0f0">"success"</span>])
            }

        <span style="color: #008800; font-weight: bold">except</span> <span style="color: #FF0000; font-weight: bold">Exception</span> <span style="color: #008800; font-weight: bold">as</span> e:
            <span style="color: #008800; font-weight: bold">return</span> {
                <span style="background-color: #fff0f0">"csv_file"</span>: <span style="color: #007020">str</span>(csv_path),
                <span style="background-color: #fff0f0">"status"</span>: <span style="background-color: #fff0f0">"failed"</span>,
                <span style="background-color: #fff0f0">"error"</span>: <span style="color: #007020">str</span>(e)
            }

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">_extract_metadata_from_row</span>(<span style="color: #007020">self</span>, row_data: pd<span style="color: #333333">.</span>Series) <span style="color: #333333">-&gt;</span> Dict[<span style="color: #007020">str</span>, Any]:
<span style="color: #bbbbbb">        </span><span style="color: #DD4422">"""Extract metadata from SmartTable row."""</span>

        metadata <span style="color: #333333">=</span> {
            <span style="background-color: #fff0f0">"basic"</span>: {},
            <span style="background-color: #fff0f0">"custom"</span>: {},
            <span style="background-color: #fff0f0">"sample"</span>: {},
            <span style="background-color: #fff0f0">"meta"</span>: {}
        }

        <span style="color: #008800; font-weight: bold">for</span> column, value <span style="color: #000000; font-weight: bold">in</span> row_data<span style="color: #333333">.</span>items():
            <span style="color: #008800; font-weight: bold">if</span> pd<span style="color: #333333">.</span>isna(value) <span style="color: #000000; font-weight: bold">or</span> value <span style="color: #333333">==</span> <span style="background-color: #fff0f0">""</span>:
                <span style="color: #008800; font-weight: bold">continue</span>

            <span style="color: #888888"># Parse mapping columns</span>
            <span style="color: #008800; font-weight: bold">if</span> column<span style="color: #333333">.</span>startswith(<span style="background-color: #fff0f0">"basic/"</span>):
                key <span style="color: #333333">=</span> column<span style="color: #333333">.</span>replace(<span style="background-color: #fff0f0">"basic/"</span>, <span style="background-color: #fff0f0">""</span>)
                metadata[<span style="background-color: #fff0f0">"basic"</span>][key] <span style="color: #333333">=</span> value
            <span style="color: #008800; font-weight: bold">elif</span> column<span style="color: #333333">.</span>startswith(<span style="background-color: #fff0f0">"custom/"</span>):
                key <span style="color: #333333">=</span> column<span style="color: #333333">.</span>replace(<span style="background-color: #fff0f0">"custom/"</span>, <span style="background-color: #fff0f0">""</span>)
                metadata[<span style="background-color: #fff0f0">"custom"</span>][key] <span style="color: #333333">=</span> value
            <span style="color: #008800; font-weight: bold">elif</span> column<span style="color: #333333">.</span>startswith(<span style="background-color: #fff0f0">"sample/"</span>):
                key <span style="color: #333333">=</span> column<span style="color: #333333">.</span>replace(<span style="background-color: #fff0f0">"sample/"</span>, <span style="background-color: #fff0f0">""</span>)
                metadata[<span style="background-color: #fff0f0">"sample"</span>][key] <span style="color: #333333">=</span> value
            <span style="color: #008800; font-weight: bold">elif</span> column<span style="color: #333333">.</span>startswith(<span style="background-color: #fff0f0">"meta/"</span>):
                key <span style="color: #333333">=</span> column<span style="color: #333333">.</span>replace(<span style="background-color: #fff0f0">"meta/"</span>, <span style="background-color: #fff0f0">""</span>)
                metadata[<span style="background-color: #fff0f0">"meta"</span>][key] <span style="color: #333333">=</span> value

        <span style="color: #008800; font-weight: bold">return</span> metadata

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">_process_related_file</span>(<span style="color: #007020">self</span>, file_path: Path, metadata: Dict[<span style="color: #007020">str</span>, Any]) <span style="color: #333333">-&gt;</span> Dict[<span style="color: #007020">str</span>, Any]:
<span style="color: #bbbbbb">        </span><span style="color: #DD4422">"""Process a single related file."""</span>

        <span style="color: #008800; font-weight: bold">try</span>:
            file_info <span style="color: #333333">=</span> {
                <span style="background-color: #fff0f0">"file_path"</span>: <span style="color: #007020">str</span>(file_path),
                <span style="background-color: #fff0f0">"file_name"</span>: file_path<span style="color: #333333">.</span>name,
                <span style="background-color: #fff0f0">"file_size"</span>: file_path<span style="color: #333333">.</span>stat()<span style="color: #333333">.</span>st_size,
                <span style="background-color: #fff0f0">"file_extension"</span>: file_path<span style="color: #333333">.</span>suffix,
                <span style="background-color: #fff0f0">"status"</span>: <span style="background-color: #fff0f0">"success"</span>
            }

            <span style="color: #888888"># Add file-specific processing based on extension</span>
            <span style="color: #008800; font-weight: bold">if</span> file_path<span style="color: #333333">.</span>suffix<span style="color: #333333">.</span>lower() <span style="color: #333333">==</span> <span style="background-color: #fff0f0">'.csv'</span>:
                <span style="color: #888888"># Process CSV file</span>
                csv_data <span style="color: #333333">=</span> pd<span style="color: #333333">.</span>read_csv(file_path)
                file_info<span style="color: #333333">.</span>update({
                    <span style="background-color: #fff0f0">"csv_rows"</span>: <span style="color: #007020">len</span>(csv_data),
                    <span style="background-color: #fff0f0">"csv_columns"</span>: <span style="color: #007020">len</span>(csv_data<span style="color: #333333">.</span>columns),
                    <span style="background-color: #fff0f0">"csv_headers"</span>: <span style="color: #007020">list</span>(csv_data<span style="color: #333333">.</span>columns)
                })

            <span style="color: #008800; font-weight: bold">elif</span> file_path<span style="color: #333333">.</span>suffix<span style="color: #333333">.</span>lower() <span style="color: #000000; font-weight: bold">in</span> [<span style="background-color: #fff0f0">'.txt'</span>, <span style="background-color: #fff0f0">'.log'</span>]:
                <span style="color: #888888"># Process text file</span>
                content <span style="color: #333333">=</span> file_path<span style="color: #333333">.</span>read_text(encoding<span style="color: #333333">=</span><span style="background-color: #fff0f0">'utf-8'</span>)
                file_info<span style="color: #333333">.</span>update({
                    <span style="background-color: #fff0f0">"text_lines"</span>: <span style="color: #007020">len</span>(content<span style="color: #333333">.</span>splitlines()),
                    <span style="background-color: #fff0f0">"text_chars"</span>: <span style="color: #007020">len</span>(content)
                })

            <span style="color: #008800; font-weight: bold">elif</span> file_path<span style="color: #333333">.</span>suffix<span style="color: #333333">.</span>lower() <span style="color: #000000; font-weight: bold">in</span> [<span style="background-color: #fff0f0">'.json'</span>]:
                <span style="color: #888888"># Process JSON file</span>
                <span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">json</span>
                <span style="color: #008800; font-weight: bold">with</span> <span style="color: #007020">open</span>(file_path, <span style="background-color: #fff0f0">'r'</span>, encoding<span style="color: #333333">=</span><span style="background-color: #fff0f0">'utf-8'</span>) <span style="color: #008800; font-weight: bold">as</span> f:
                    json_data <span style="color: #333333">=</span> json<span style="color: #333333">.</span>load(f)
                file_info<span style="color: #333333">.</span>update({
                    <span style="background-color: #fff0f0">"json_keys"</span>: <span style="color: #007020">list</span>(json_data<span style="color: #333333">.</span>keys()) <span style="color: #008800; font-weight: bold">if</span> <span style="color: #007020">isinstance</span>(json_data, <span style="color: #007020">dict</span>) <span style="color: #008800; font-weight: bold">else</span> <span style="color: #008800; font-weight: bold">None</span>,
                    <span style="background-color: #fff0f0">"json_type"</span>: <span style="color: #007020">type</span>(json_data)<span style="color: #333333">.</span><span style="color: #996633">__name__</span>
                })

            <span style="color: #008800; font-weight: bold">return</span> file_info

        <span style="color: #008800; font-weight: bold">except</span> <span style="color: #FF0000; font-weight: bold">Exception</span> <span style="color: #008800; font-weight: bold">as</span> e:
            <span style="color: #008800; font-weight: bold">return</span> {
                <span style="background-color: #fff0f0">"file_path"</span>: <span style="color: #007020">str</span>(file_path),
                <span style="background-color: #fff0f0">"status"</span>: <span style="background-color: #fff0f0">"failed"</span>,
                <span style="background-color: #fff0f0">"error"</span>: <span style="color: #007020">str</span>(e)
            }

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">cleanup</span>(<span style="color: #007020">self</span>):
<span style="color: #bbbbbb">        </span><span style="color: #DD4422">"""Clean up temporary files."""</span>
        <span style="color: #008800; font-weight: bold">if</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>temp_dir<span style="color: #333333">.</span>exists():
            shutil<span style="color: #333333">.</span>rmtree(<span style="color: #007020">self</span><span style="color: #333333">.</span>temp_dir)
        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">"Cleanup completed"</span>)

<span style="color: #888888"># Usage example</span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">demonstrate_smarttable_processing</span>():
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Demonstrate SmartTable processing capabilities."""</span>

    <span style="color: #888888"># Setup processor</span>
    working_dir <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/smarttable_processing"</span>)
    processor <span style="color: #333333">=</span> SmartTableProcessor(working_dir)

    <span style="color: #008800; font-weight: bold">try</span>:
        <span style="color: #888888"># Example file paths</span>
        smarttable_path <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/input/smarttable_experiment.xlsx"</span>)
        zip_path <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/input/experiment_data.zip"</span>)

        <span style="color: #888888"># Process SmartTable with ZIP file</span>
        <span style="color: #008800; font-weight: bold">if</span> smarttable_path<span style="color: #333333">.</span>exists():
            summary <span style="color: #333333">=</span> processor<span style="color: #333333">.</span>process_smarttable_with_zip(
                smarttable_path<span style="color: #333333">=</span>smarttable_path,
                zip_path<span style="color: #333333">=</span>zip_path <span style="color: #008800; font-weight: bold">if</span> zip_path<span style="color: #333333">.</span>exists() <span style="color: #008800; font-weight: bold">else</span> <span style="color: #008800; font-weight: bold">None</span>
            )

            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"</span><span style="color: #666666; font-weight: bold; background-color: #fff0f0">\n</span><span style="background-color: #fff0f0">SmartTable Processing Summary:"</span>)
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"  Total rows processed: </span><span style="background-color: #eeeeee">{</span>summary[<span style="background-color: #fff0f0">'total_rows'</span>]<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"  Generated CSV files: </span><span style="background-color: #eeeeee">{</span>summary[<span style="background-color: #fff0f0">'total_csvs'</span>]<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"  Successful processing: </span><span style="background-color: #eeeeee">{</span>summary[<span style="background-color: #fff0f0">'successful_processing'</span>]<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"  Extracted files: </span><span style="background-color: #eeeeee">{</span>summary[<span style="background-color: #fff0f0">'extracted_files'</span>]<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

        <span style="color: #008800; font-weight: bold">else</span>:
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">"SmartTable file not found, creating example..."</span>)
            <span style="color: #888888"># Create example SmartTable for demonstration</span>
            example_data <span style="color: #333333">=</span> pd<span style="color: #333333">.</span>DataFrame({
                <span style="background-color: #fff0f0">"Display Name"</span>: [<span style="background-color: #fff0f0">"Sample A"</span>, <span style="background-color: #fff0f0">"Sample B"</span>],
                <span style="background-color: #fff0f0">"basic/dataName"</span>: [<span style="background-color: #fff0f0">"experiment_001"</span>, <span style="background-color: #fff0f0">"experiment_002"</span>],
                <span style="background-color: #fff0f0">"basic/description"</span>: [<span style="background-color: #fff0f0">"First experiment"</span>, <span style="background-color: #fff0f0">"Second experiment"</span>],
                <span style="background-color: #fff0f0">"custom/temperature"</span>: [<span style="background-color: #fff0f0">"25.5"</span>, <span style="background-color: #fff0f0">"26.1"</span>],
                <span style="background-color: #fff0f0">"sample/location"</span>: [<span style="background-color: #fff0f0">"Lab A"</span>, <span style="background-color: #fff0f0">"Lab B"</span>],
                <span style="background-color: #fff0f0">"inputdata1"</span>: [<span style="background-color: #fff0f0">"data/sample_a.csv"</span>, <span style="background-color: #fff0f0">"data/sample_b.csv"</span>],
                <span style="background-color: #fff0f0">"inputdata2"</span>: [<span style="background-color: #fff0f0">"data/metadata_a.json"</span>, <span style="background-color: #fff0f0">"data/metadata_b.json"</span>]
            })

            example_path <span style="color: #333333">=</span> working_dir <span style="color: #333333">/</span> <span style="background-color: #fff0f0">"example_smarttable.xlsx"</span>
            example_data<span style="color: #333333">.</span>to_excel(example_path, index<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">False</span>)
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Created example SmartTable: </span><span style="background-color: #eeeeee">{</span>example_path<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

    <span style="color: #008800; font-weight: bold">finally</span>:
        <span style="color: #888888"># Cleanup</span>
        processor<span style="color: #333333">.</span>cleanup()

<span style="color: #008800; font-weight: bold">if</span> <span style="color: #996633">__name__</span> <span style="color: #333333">==</span> <span style="background-color: #fff0f0">"__main__"</span>:
    demonstrate_smarttable_processing()
</code></pre></div></td></tr></table></div>
<h2 id="error-handling">Error Handling</h2>
<h3 id="exception-types">Exception Types</h3>
<p>The invoicefile module raises <code>StructuredError</code> for various error conditions:</p>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">14</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">rdetoolkit.exceptions</span> <span style="color: #008800; font-weight: bold">import</span> StructuredError
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">rdetoolkit.invoicefile</span> <span style="color: #008800; font-weight: bold">import</span> InvoiceFile, ExcelInvoiceFile

<span style="color: #888888"># Handle invoice file errors</span>
<span style="color: #008800; font-weight: bold">try</span>:
    invoice <span style="color: #333333">=</span> InvoiceFile(<span style="background-color: #fff0f0">"nonexistent.json"</span>)
<span style="color: #008800; font-weight: bold">except</span> StructuredError <span style="color: #008800; font-weight: bold">as</span> e:
    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Invoice file error: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)

<span style="color: #888888"># Handle Excel invoice errors</span>
<span style="color: #008800; font-weight: bold">try</span>:
    excel_invoice <span style="color: #333333">=</span> ExcelInvoiceFile(<span style="background-color: #fff0f0">"invalid.xlsx"</span>)
<span style="color: #008800; font-weight: bold">except</span> StructuredError <span style="color: #008800; font-weight: bold">as</span> e:
    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Excel invoice error: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
</code></pre></div></td></tr></table></div>
<h3 id="best-practices-for-error-handling">Best Practices for Error Handling</h3>
<ol>
<li>
<p><strong>Validate Files Before Processing</strong>:
   <div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">safe_invoice_processing</span>(invoice_path: Path) <span style="color: #333333">-&gt;</span> <span style="color: #007020">bool</span>:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Safely process invoice with validation."""</span>
    <span style="color: #008800; font-weight: bold">if</span> <span style="color: #000000; font-weight: bold">not</span> invoice_path<span style="color: #333333">.</span>exists():
        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Invoice file not found: </span><span style="background-color: #eeeeee">{</span>invoice_path<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">False</span>

    <span style="color: #008800; font-weight: bold">try</span>:
        invoice <span style="color: #333333">=</span> InvoiceFile(invoice_path)
        <span style="color: #888888"># Process invoice...</span>
        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">True</span>
    <span style="color: #008800; font-weight: bold">except</span> StructuredError <span style="color: #008800; font-weight: bold">as</span> e:
        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Invoice processing failed: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">False</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Handle Template Generation Errors</strong>:
   <div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">7</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">safe_template_generation</span>(schema_path: Path, output_path: Path):
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Generate template with error handling."""</span>
    <span style="color: #008800; font-weight: bold">try</span>:
        <span style="color: #008800; font-weight: bold">return</span> ExcelInvoiceFile<span style="color: #333333">.</span>generate_template(schema_path, output_path)
    <span style="color: #008800; font-weight: bold">except</span> StructuredError <span style="color: #008800; font-weight: bold">as</span> e:
        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Template generation failed: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">None</span>, <span style="color: #008800; font-weight: bold">None</span>, <span style="color: #008800; font-weight: bold">None</span>
</code></pre></div></td></tr></table></div></p>
</li>
</ol>
<h2 id="performance-notes">Performance Notes</h2>
<h3 id="optimization-strategies">Optimization Strategies</h3>
<ol>
<li><strong>Batch Processing</strong>: Process multiple invoice files efficiently</li>
<li><strong>Memory Management</strong>: Use DataFrames efficiently for large Excel files</li>
<li><strong>File I/O Optimization</strong>: Minimize repeated file reading operations</li>
<li><strong>Template Caching</strong>: Cache generated templates for reuse</li>
</ol>
<h3 id="performance-best-practices">Performance Best Practices</h3>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #888888"># Efficient batch processing</span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">process_invoices_efficiently</span>(invoice_paths: List[Path]):
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Process multiple invoices efficiently."""</span>

    <span style="color: #888888"># Load schema once</span>
    schema_path <span style="color: #333333">=</span> Path(<span style="background-color: #fff0f0">"data/tasksupport/invoice.schema.json"</span>)

    <span style="color: #008800; font-weight: bold">for</span> invoice_path <span style="color: #000000; font-weight: bold">in</span> invoice_paths:
        <span style="color: #008800; font-weight: bold">try</span>:
            invoice <span style="color: #333333">=</span> InvoiceFile(invoice_path)
            <span style="color: #888888"># Process with shared schema...</span>
        <span style="color: #008800; font-weight: bold">except</span> <span style="color: #FF0000; font-weight: bold">Exception</span> <span style="color: #008800; font-weight: bold">as</span> e:
            <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">f"Skipping </span><span style="background-color: #eeeeee">{</span>invoice_path<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">: </span><span style="background-color: #eeeeee">{</span>e<span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>)
</code></pre></div></td></tr></table></div>
<h2 id="see-also">See Also</h2>
<ul>
<li><a href="../core/">Core Module</a> - For directory operations and file handling</li>
<li><a href="../fileops/">File Operations</a> - For JSON file reading and writing utilities</li>
<li><a href="../models/invoice/">Models - Invoice</a> - For invoice data structure definitions</li>
<li><a href="../models/invoice_schema/">Models - Invoice Schema</a> - For invoice schema definitions</li>
<li><a href="../validation/">Validation</a> - For invoice validation functionality</li>
<li><a href="../rde2util/">RDE2 Utilities</a> - For metadata processing utilities</li>
<li><a href="../exceptions/">Exceptions</a> - For StructuredError and other exception types</li>
<li><a href="../../usage/cli/">Usage - CLI</a> - For command-line invoice processing</li>
<li><a href="../../usage/structured_process/structured/">Usage - Structured Process</a> - For invoice processing in workflows</li>
</ul>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://github.com/nims-dpfc/rdetoolkit" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<div class="md-consent" data-md-component="consent" hidden="" id="__consent">
<div class="md-consent__overlay"></div>
<aside class="md-consent__inner">
<form class="md-consent__form md-grid md-typeset" name="consent">
<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" id="__settings" type="checkbox"/>
<div class="md-consent__settings">
<ul class="task-list">
<li class="task-list-item">
<label class="task-list-control">
<input checked="" name="github" type="checkbox"/>
<span class="task-list-indicator"></span>
          GitHub
        </label>
</li>
</ul>
</div>
<div class="md-consent__controls">
<button class="md-button md-button--primary">Accept</button>
<label class="md-button" for="__settings">Manage settings</label>
</div>
</form>
</aside>
</div>
<script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
<script id="__config" type="application/json">{"base": "../..", "features": ["navigation.top", "navigation.tabs", "navigation.tabs.sticky"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../assets/javascripts/bundle.d6f25eb3.min.js"></script>
<script src="https://unpkg.com/mermaid@10.9.0/dist/mermaid.min.js"></script>
</body>
</html>